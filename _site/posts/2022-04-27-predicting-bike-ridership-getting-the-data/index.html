<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taylor Dunn">
<meta name="dcterms.date" content="2022-04-27">
<meta name="description" content="Part 1 of predicting bike ridership in Halifax, Nova Scotia. In this post, I retrieve and explore data from two open APIs.">

<title>Predicting bike ridership: getting the data – tdunn</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/td.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-fff488a1491511c3c22c1721082157b7.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9f733bb3753f8475453fa3d72df20be0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-196523553-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<meta property="og:title" content="Predicting bike ridership: getting the data – tdunn">
<meta property="og:description" content="Part 1 of predicting bike ridership in Halifax, Nova Scotia. In this post, I retrieve and explore data from two open APIs.">
<meta property="og:image" content="https://tdunn.ca/posts/2022-04-27-predicting-bike-ridership-getting-the-data/preview.png">
<meta property="og:site_name" content="tdunn">
<meta property="og:image:height" content="1500">
<meta property="og:image:width" content="1800">
<meta name="twitter:title" content="Predicting bike ridership: getting the data – tdunn">
<meta name="twitter:description" content="Part 1 of predicting bike ridership in Halifax, Nova Scotia. In this post, I retrieve and explore data from two open APIs.">
<meta name="twitter:image" content="https://tdunn.ca/posts/2022-04-27-predicting-bike-ridership-getting-the-data/preview.png">
<meta name="twitter:creator" content="@TDunn12">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="1500">
<meta name="twitter:image-width" content="1800">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tdunn</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/taylordunn"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/TDunn12"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/dunn-taylor/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Predicting bike ridership: getting the data</h1>
                  <div>
        <div class="description">
          <p>Part 1 of predicting bike ridership in Halifax, Nova Scotia. In this post, I retrieve and explore data from two open APIs.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">API</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://tdunn.ca">Taylor Dunn</a> <a href="https://orcid.org/0000-0001-8042-1611" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 27, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#getting-bicycle-count-data" id="toc-getting-bicycle-count-data" class="nav-link" data-scroll-target="#getting-bicycle-count-data">Getting bicycle count data</a>
  <ul class="collapse">
  <li><a href="#eda-and-cleaning" id="toc-eda-and-cleaning" class="nav-link" data-scroll-target="#eda-and-cleaning">EDA and cleaning</a></li>
  </ul></li>
  <li><a href="#getting-weather-data" id="toc-getting-weather-data" class="nav-link" data-scroll-target="#getting-weather-data">Getting weather data</a>
  <ul class="collapse">
  <li><a href="#eda-and-cleaning-1" id="toc-eda-and-cleaning-1" class="nav-link" data-scroll-target="#eda-and-cleaning-1">EDA and cleaning</a></li>
  </ul></li>
  <li><a href="#combining-the-data" id="toc-combining-the-data" class="nav-link" data-scroll-target="#combining-the-data">Combining the data</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/taylordunn/tdunn-quarto/edit/main/posts/2022-04-27-predicting-bike-ridership-getting-the-data/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/taylordunn/tdunn-quarto/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="cell">
<details class="code-fold">
<summary>R setup</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunnr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"win"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_td</span>())</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set_geom_fonts</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set_palette</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In 2016, the city of Halifax <a href="https://www.cbc.ca/news/canada/nova-scotia/data-tracker-eco-counter-cycling-bike-agricola-street-halifax-cycling-coalition-1.3812404">installed its first cyclist tracker on Agricola Street</a>. Last year, the city made bike counter data available on their <a href="https://catalogue-hrm.opendata.arcgis.com/datasets/45d4ecb0cb48469186e683ebc54eb188_0/about">open data platform</a>. As a cyclist and Haligonian, this is of course interesting to me personally. As a data scientist, this seems like a nice opportunity to work through a machine learning project end-to-end: from retrieving, exploring, and processing the data, to building and evaluating models, to producing an end product. (A REST API? A Shiny app? TBD.)</p>
<p>In this post, I get and explore data from two sources: (1) the aforementioned bike counter data from city of Halifax, and (2) historical weather data from the government of Canada.</p>
</section>
<section id="getting-bicycle-count-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-bicycle-count-data">Getting bicycle count data</h2>
<p>The bicycle counts were easy enough to find on Halifax’s platform: (https://catalogue-hrm.opendata.arcgis.com/datasets/45d4ecb0cb48469186e683ebc54eb188_0/explore?showTable=true). Each data set comes with a nice <a href="https://catalogue-hrm.opendata.arcgis.com/datasets/45d4ecb0cb48469186e683ebc54eb188_0/api">API explorer</a> for constructing queries. I’ll use <code>httr</code> to GET the data with the basic query provided there:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>query_url <span class="ot">&lt;-</span> <span class="st">"https://services2.arcgis.com/11XBiaBYA9Ep0yNJ/arcgis/rest/services/Bicycle_Counts/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;outSR=4326&amp;f=json"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(query_url)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>resp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://services2.arcgis.com/11XBiaBYA9Ep0yNJ/arcgis/rest/services/Bicycle_Counts/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;outSR=4326&amp;f=json]
  Date: 2022-04-27 03:26
  Status: 200
  Content-Type: application/json; charset=utf-8
  Size: 579 kB</code></pre>
</div>
</div>
<p>The response code (200) indicates a successful connection. The data comes in JSON format, which I can parse to an R list with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>parsed_content <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(parsed_content, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ objectIdFieldName    : chr "ObjectId"
 $ uniqueIdField        :List of 2
 $ globalIdFieldName    : chr ""
 $ fields               :List of 11
 $ exceededTransferLimit: logi TRUE
 $ features             :List of 2000</code></pre>
</div>
</div>
<p>This returned a list of 6 items. The <code>fields</code> item is a list of variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fields <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  parsed_content<span class="sc">$</span>fields,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop NULL elements so I can convert to a tibble</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">discard</span>(.x, is.null) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(fields)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="imavhobfbt" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#imavhobfbt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#imavhobfbt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#imavhobfbt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#imavhobfbt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#imavhobfbt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#imavhobfbt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#imavhobfbt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#imavhobfbt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#imavhobfbt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#imavhobfbt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#imavhobfbt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#imavhobfbt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#imavhobfbt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#imavhobfbt .gt_from_md > :first-child {
  margin-top: 0;
}

#imavhobfbt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#imavhobfbt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#imavhobfbt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#imavhobfbt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#imavhobfbt .gt_row_group_first td {
  border-top-width: 2px;
}

#imavhobfbt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#imavhobfbt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#imavhobfbt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#imavhobfbt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#imavhobfbt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#imavhobfbt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#imavhobfbt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#imavhobfbt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#imavhobfbt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#imavhobfbt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#imavhobfbt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#imavhobfbt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#imavhobfbt .gt_left {
  text-align: left;
}

#imavhobfbt .gt_center {
  text-align: center;
}

#imavhobfbt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#imavhobfbt .gt_font_normal {
  font-weight: normal;
}

#imavhobfbt .gt_font_bold {
  font-weight: bold;
}

#imavhobfbt .gt_font_italic {
  font-style: italic;
}

#imavhobfbt .gt_super {
  font-size: 65%;
}

#imavhobfbt .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#imavhobfbt .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#imavhobfbt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#imavhobfbt .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#imavhobfbt .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#imavhobfbt .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">name</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">type</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">alias</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">sqlType</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th">length</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">CHANNEL_ID</td>
<td class="gt_row gt_left">esriFieldTypeString</td>
<td class="gt_row gt_left">CHANNEL_ID</td>
<td class="gt_row gt_left">sqlTypeNVarchar</td>
<td class="gt_row gt_right">256</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">CHANNEL_NAME</td>
<td class="gt_row gt_left">esriFieldTypeString</td>
<td class="gt_row gt_left">CHANNEL_NAME</td>
<td class="gt_row gt_left">sqlTypeNVarchar</td>
<td class="gt_row gt_right">4000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">SERIAL_NUMBER</td>
<td class="gt_row gt_left">esriFieldTypeString</td>
<td class="gt_row gt_left">SERIAL_NUMBER</td>
<td class="gt_row gt_left">sqlTypeNVarchar</td>
<td class="gt_row gt_right">4000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">SITE_NAME</td>
<td class="gt_row gt_left">esriFieldTypeString</td>
<td class="gt_row gt_left">SITE_NAME</td>
<td class="gt_row gt_left">sqlTypeNVarchar</td>
<td class="gt_row gt_right">4000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">LATITUDE</td>
<td class="gt_row gt_left">esriFieldTypeDouble</td>
<td class="gt_row gt_left">LATITUDE</td>
<td class="gt_row gt_left">sqlTypeFloat</td>
<td class="gt_row gt_right">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">LONGITUDE</td>
<td class="gt_row gt_left">esriFieldTypeDouble</td>
<td class="gt_row gt_left">LONGITUDE</td>
<td class="gt_row gt_left">sqlTypeFloat</td>
<td class="gt_row gt_right">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">INSTALLATION_DATE</td>
<td class="gt_row gt_left">esriFieldTypeDate</td>
<td class="gt_row gt_left">INSTALLATION_DATE</td>
<td class="gt_row gt_left">sqlTypeTimestamp2</td>
<td class="gt_row gt_right">8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">COUNT_DATETIME</td>
<td class="gt_row gt_left">esriFieldTypeDate</td>
<td class="gt_row gt_left">COUNT_DATETIME</td>
<td class="gt_row gt_left">sqlTypeTimestamp2</td>
<td class="gt_row gt_right">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">COUNTER_TYPE</td>
<td class="gt_row gt_left">esriFieldTypeString</td>
<td class="gt_row gt_left">COUNTER_TYPE</td>
<td class="gt_row gt_left">sqlTypeNVarchar</td>
<td class="gt_row gt_right">4000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">COUNTER_VALUE</td>
<td class="gt_row gt_left">esriFieldTypeInteger</td>
<td class="gt_row gt_left">COUNTER_VALUE</td>
<td class="gt_row gt_left">sqlTypeInteger</td>
<td class="gt_row gt_right">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">ObjectId</td>
<td class="gt_row gt_left">esriFieldTypeOID</td>
<td class="gt_row gt_left">ObjectId</td>
<td class="gt_row gt_left">sqlTypeInteger</td>
<td class="gt_row gt_right">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The data is the <code>features</code> item, which itself is a list of length 2000. Here is the first element:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>parsed_content<span class="sc">$</span>features[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$attributes
$attributes$CHANNEL_ID
[1] "100059339"

$attributes$CHANNEL_NAME
[1] "Hollis St"

$attributes$SERIAL_NUMBER
[1] "X2H20032465"

$attributes$SITE_NAME
[1] "Hollis St"

$attributes$LATITUDE
[1] 44.64799

$attributes$LONGITUDE
[1] -63.57352

$attributes$INSTALLATION_DATE
[1] 1.594166e+12

$attributes$COUNT_DATETIME
[1] 1.595966e+12

$attributes$COUNTER_TYPE
[1] "Bicycle"

$attributes$COUNTER_VALUE
[1] 2

$attributes$ObjectId
[1] 1</code></pre>
</div>
</div>
<p>Looks like there is another level of nesting with <code>attributes</code>. Compile all of these elements into a single data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bike_counts <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  parsed_content<span class="sc">$</span>features,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">as_tibble</span>(.x<span class="sc">$</span>attributes)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,000
Columns: 11
$ CHANNEL_ID        &lt;chr&gt; "100059339", "100059339", "100059339", "100059339", …
$ CHANNEL_NAME      &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ SERIAL_NUMBER     &lt;chr&gt; "X2H20032465", "X2H20032465", "X2H20032465", "X2H200…
$ SITE_NAME         &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ LATITUDE          &lt;dbl&gt; 44.64799, 44.64799, 44.64799, 44.64799, 44.64799, 44…
$ LONGITUDE         &lt;dbl&gt; -63.57352, -63.57352, -63.57352, -63.57352, -63.5735…
$ INSTALLATION_DATE &lt;dbl&gt; 1.594166e+12, 1.594166e+12, 1.594166e+12, 1.594166e+…
$ COUNT_DATETIME    &lt;dbl&gt; 1.595966e+12, 1.595970e+12, 1.595974e+12, 1.595977e+…
$ COUNTER_TYPE      &lt;chr&gt; "Bicycle", "Bicycle", "Bicycle", "Bicycle", "Bicycle…
$ COUNTER_VALUE     &lt;int&gt; 2, 1, 2, 2, 0, 0, 0, 0, 0, 0, 6, 4, 13, 8, 5, 6, 8, …
$ ObjectId          &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…</code></pre>
</div>
</div>
<p>Note that just 2000 records were returned. The <code>exceededTransferLimit = TRUE</code> value tells us that this is the limit of the API. I can get the total count of records by altering the original query slightly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n_records <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="fu">paste0</span>(query_url, <span class="st">"&amp;returnCountOnly=true"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">content</span>(<span class="at">as =</span> <span class="st">"parsed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(<span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>n_records</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124356</code></pre>
</div>
</div>
<p>So to get all of the data at 2000 records per request, I’ll have to make a minimum of 63 calls to the API. The API offers a “resultOffset” argument to get records in sequence. Make a function to get 2000 records for a given offset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>get_bike_data <span class="ot">&lt;-</span> <span class="cf">function</span>(offset) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Need to prevent scientific notation, e.g. "1e+05" instead of "100000"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  offset <span class="ot">&lt;-</span> <span class="fu">format</span>(offset, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  parsed_content <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="fu">paste0</span>(query_url, <span class="st">"&amp;resultOffset="</span>, offset)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">content</span>(<span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    parsed_content<span class="sc">$</span>features,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">as_tibble</span>(.x<span class="sc">$</span>attributes)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And combine it all into a single data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>(n_records <span class="sc">/</span> <span class="dv">2000</span>)),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">get_bike_data</span>(<span class="at">offset =</span> .x <span class="sc">*</span> <span class="dv">2000</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 124,356
Columns: 11
$ CHANNEL_ID        &lt;chr&gt; "100059339", "100059339", "100059339", "100059339", …
$ CHANNEL_NAME      &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ SERIAL_NUMBER     &lt;chr&gt; "X2H20032465", "X2H20032465", "X2H20032465", "X2H200…
$ SITE_NAME         &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ LATITUDE          &lt;dbl&gt; 44.64799, 44.64799, 44.64799, 44.64799, 44.64799, 44…
$ LONGITUDE         &lt;dbl&gt; -63.57352, -63.57352, -63.57352, -63.57352, -63.5735…
$ INSTALLATION_DATE &lt;dbl&gt; 1.594166e+12, 1.594166e+12, 1.594166e+12, 1.594166e+…
$ COUNT_DATETIME    &lt;dbl&gt; 1.595966e+12, 1.595970e+12, 1.595974e+12, 1.595977e+…
$ COUNTER_TYPE      &lt;chr&gt; "Bicycle", "Bicycle", "Bicycle", "Bicycle", "Bicycle…
$ COUNTER_VALUE     &lt;int&gt; 2, 1, 2, 2, 0, 0, 0, 0, 0, 0, 6, 4, 13, 8, 5, 6, 8, …
$ ObjectId          &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…</code></pre>
</div>
</div>
<p>This returned 124356 records, as expected. The <code>ObjectId</code> should be a unique sequential identifier from 1 to 124356, which I’ll check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(bike_data<span class="sc">$</span>ObjectId); <span class="fu">n_distinct</span>(bike_data<span class="sc">$</span>ObjectId)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]      1 124356</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124356</code></pre>
</div>
</div>
<section id="eda-and-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="eda-and-cleaning">EDA and cleaning</h3>
<p>First thing I usually do with a new data set is clean the column names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>(bike_data)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 124,356
Columns: 11
$ channel_id        &lt;chr&gt; "100059339", "100059339", "100059339", "100059339", …
$ channel_name      &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ serial_number     &lt;chr&gt; "X2H20032465", "X2H20032465", "X2H20032465", "X2H200…
$ site_name         &lt;chr&gt; "Hollis St", "Hollis St", "Hollis St", "Hollis St", …
$ latitude          &lt;dbl&gt; 44.64799, 44.64799, 44.64799, 44.64799, 44.64799, 44…
$ longitude         &lt;dbl&gt; -63.57352, -63.57352, -63.57352, -63.57352, -63.5735…
$ installation_date &lt;dbl&gt; 1.594166e+12, 1.594166e+12, 1.594166e+12, 1.594166e+…
$ count_datetime    &lt;dbl&gt; 1.595966e+12, 1.595970e+12, 1.595974e+12, 1.595977e+…
$ counter_type      &lt;chr&gt; "Bicycle", "Bicycle", "Bicycle", "Bicycle", "Bicycle…
$ counter_value     &lt;int&gt; 2, 1, 2, 2, 0, 0, 0, 0, 0, 0, 6, 4, 13, 8, 5, 6, 8, …
$ object_id         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…</code></pre>
</div>
</div>
<p>Next I want to deal with the <code>installation_date</code> and <code>count_datetime</code> variables, which are very large integers. From <code>fields</code> above, the data type for these variables is <code>esriFieldTypeDate</code>. After some digging on Google, turns out this is Unix time (the number of milliseconds since January 1, 1970; also called epoch time). With <code>as.POSIXct()</code>, I can supply the number of seconds and set <code>origin = "1970-01-01"</code> to get back the correct datetime objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> bike_data <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(installation_date, count_datetime),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span> <span class="fu">as.POSIXct</span>(.x <span class="sc">/</span> <span class="dv">1000</span>, <span class="at">tz =</span> <span class="st">"UTC"</span>, <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># These are just dates, the time of day doesn't matter</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">installation_date =</span> <span class="fu">as.Date</span>(installation_date),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I'll also want the date without time of day</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">count_date =</span> <span class="fu">as.Date</span>(count_datetime)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These variables are unique to the sites:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(site_name, latitude, longitude, serial_number, installation_date,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        counter_type, <span class="at">name =</span> <span class="st">"n_records"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ualqxnpfnh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ualqxnpfnh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ualqxnpfnh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ualqxnpfnh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ualqxnpfnh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ualqxnpfnh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualqxnpfnh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ualqxnpfnh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ualqxnpfnh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ualqxnpfnh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ualqxnpfnh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ualqxnpfnh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ualqxnpfnh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ualqxnpfnh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ualqxnpfnh .gt_from_md > :first-child {
  margin-top: 0;
}

#ualqxnpfnh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ualqxnpfnh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ualqxnpfnh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ualqxnpfnh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ualqxnpfnh .gt_row_group_first td {
  border-top-width: 2px;
}

#ualqxnpfnh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualqxnpfnh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ualqxnpfnh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ualqxnpfnh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualqxnpfnh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualqxnpfnh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ualqxnpfnh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ualqxnpfnh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualqxnpfnh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ualqxnpfnh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualqxnpfnh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ualqxnpfnh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualqxnpfnh .gt_left {
  text-align: left;
}

#ualqxnpfnh .gt_center {
  text-align: center;
}

#ualqxnpfnh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ualqxnpfnh .gt_font_normal {
  font-weight: normal;
}

#ualqxnpfnh .gt_font_bold {
  font-weight: bold;
}

#ualqxnpfnh .gt_font_italic {
  font-style: italic;
}

#ualqxnpfnh .gt_super {
  font-size: 65%;
}

#ualqxnpfnh .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ualqxnpfnh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ualqxnpfnh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ualqxnpfnh .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ualqxnpfnh .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ualqxnpfnh .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">site_name</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th">latitude</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th">longitude</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">serial_number</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">installation_date</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">counter_type</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th">n_records</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_right">44.66436</td>
<td class="gt_row gt_right">-63.55736</td>
<td class="gt_row gt_left">X2H20114473</td>
<td class="gt_row gt_left">2021-07-08</td>
<td class="gt_row gt_left">Bicycle</td>
<td class="gt_row gt_right">13976</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_right">44.64799</td>
<td class="gt_row gt_right">-63.57352</td>
<td class="gt_row gt_left">X2H20032465</td>
<td class="gt_row gt_left">2020-07-08</td>
<td class="gt_row gt_left">Bicycle</td>
<td class="gt_row gt_right">15748</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_right">44.64194</td>
<td class="gt_row gt_right">-63.57972</td>
<td class="gt_row gt_left">X2H19070467</td>
<td class="gt_row gt_left">2019-09-01</td>
<td class="gt_row gt_left">Bicycle</td>
<td class="gt_row gt_right">46424</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_right">44.64292</td>
<td class="gt_row gt_right">-63.59154</td>
<td class="gt_row gt_left">X2H20114470</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">Bicycle</td>
<td class="gt_row gt_right">24104</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_right">44.65466</td>
<td class="gt_row gt_right">-63.60368</td>
<td class="gt_row gt_left">X2H20114472</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">Bicycle</td>
<td class="gt_row gt_right">24104</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Drop <code>serial_number</code> and <code>counter_type</code>, which aren’t useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="ot">&lt;-</span> bike_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>serial_number, <span class="sc">-</span>counter_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sites can have multiple channels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(site_name, channel_name, channel_id, <span class="at">name =</span> <span class="st">"n_records"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="mswzsxvhjx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#mswzsxvhjx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mswzsxvhjx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mswzsxvhjx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mswzsxvhjx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mswzsxvhjx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mswzsxvhjx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mswzsxvhjx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mswzsxvhjx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mswzsxvhjx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mswzsxvhjx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mswzsxvhjx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mswzsxvhjx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#mswzsxvhjx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mswzsxvhjx .gt_from_md > :first-child {
  margin-top: 0;
}

#mswzsxvhjx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mswzsxvhjx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mswzsxvhjx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mswzsxvhjx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mswzsxvhjx .gt_row_group_first td {
  border-top-width: 2px;
}

#mswzsxvhjx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mswzsxvhjx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mswzsxvhjx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mswzsxvhjx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mswzsxvhjx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mswzsxvhjx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mswzsxvhjx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mswzsxvhjx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mswzsxvhjx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mswzsxvhjx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mswzsxvhjx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mswzsxvhjx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mswzsxvhjx .gt_left {
  text-align: left;
}

#mswzsxvhjx .gt_center {
  text-align: center;
}

#mswzsxvhjx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mswzsxvhjx .gt_font_normal {
  font-weight: normal;
}

#mswzsxvhjx .gt_font_bold {
  font-weight: bold;
}

#mswzsxvhjx .gt_font_italic {
  font-style: italic;
}

#mswzsxvhjx .gt_super {
  font-size: 65%;
}

#mswzsxvhjx .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#mswzsxvhjx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#mswzsxvhjx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mswzsxvhjx .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#mswzsxvhjx .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#mswzsxvhjx .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">site_name</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">channel_name</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">channel_id</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th">n_records</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway Northbound</td>
<td class="gt_row gt_left">353280085</td>
<td class="gt_row gt_right">6988</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway Southbound</td>
<td class="gt_row gt_left">353280086</td>
<td class="gt_row gt_right">6988</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_left">100059339</td>
<td class="gt_row gt_right">15748</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_left">South Park St Northbound</td>
<td class="gt_row gt_left">101054257</td>
<td class="gt_row gt_right">23212</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_left">South Park St Southbound</td>
<td class="gt_row gt_left">102054257</td>
<td class="gt_row gt_right">23212</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_left">Vernon St Northbound</td>
<td class="gt_row gt_left">353252897</td>
<td class="gt_row gt_right">12052</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_left">Vernon St Southbound</td>
<td class="gt_row gt_left">353252898</td>
<td class="gt_row gt_right">12052</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_left">Windsor St Northbound</td>
<td class="gt_row gt_left">353252910</td>
<td class="gt_row gt_right">12052</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_left">Windsor St Southbound</td>
<td class="gt_row gt_left">353252909</td>
<td class="gt_row gt_right">12052</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>All but the Hollis St site has separate northbound and southbound channels.</p>
<p>For each site, check the <code>installation_date</code> relative to the range of <code>count_date</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name, installation_date) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min_count_date =</span> <span class="fu">min</span>(count_date), <span class="at">max_count_date =</span> <span class="fu">max</span>(count_date),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="wgsxslnsdl" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wgsxslnsdl .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wgsxslnsdl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgsxslnsdl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wgsxslnsdl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wgsxslnsdl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsxslnsdl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgsxslnsdl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wgsxslnsdl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wgsxslnsdl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wgsxslnsdl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wgsxslnsdl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wgsxslnsdl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wgsxslnsdl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wgsxslnsdl .gt_from_md > :first-child {
  margin-top: 0;
}

#wgsxslnsdl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wgsxslnsdl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wgsxslnsdl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsxslnsdl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wgsxslnsdl .gt_row_group_first td {
  border-top-width: 2px;
}

#wgsxslnsdl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsxslnsdl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wgsxslnsdl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wgsxslnsdl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsxslnsdl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsxslnsdl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wgsxslnsdl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wgsxslnsdl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsxslnsdl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgsxslnsdl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsxslnsdl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgsxslnsdl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsxslnsdl .gt_left {
  text-align: left;
}

#wgsxslnsdl .gt_center {
  text-align: center;
}

#wgsxslnsdl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wgsxslnsdl .gt_font_normal {
  font-weight: normal;
}

#wgsxslnsdl .gt_font_bold {
  font-weight: bold;
}

#wgsxslnsdl .gt_font_italic {
  font-style: italic;
}

#wgsxslnsdl .gt_super {
  font-size: 65%;
}

#wgsxslnsdl .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#wgsxslnsdl .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#wgsxslnsdl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wgsxslnsdl .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#wgsxslnsdl .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#wgsxslnsdl .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">site_name</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">installation_date</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">min_count_date</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th">max_count_date</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_left">2021-07-08</td>
<td class="gt_row gt_left">2021-07-08</td>
<td class="gt_row gt_left">2022-04-25</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_left">2020-07-08</td>
<td class="gt_row gt_left">2020-07-08</td>
<td class="gt_row gt_left">2022-04-25</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_left">2019-09-01</td>
<td class="gt_row gt_left">2019-09-01</td>
<td class="gt_row gt_left">2022-04-25</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">2022-04-25</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">2020-12-09</td>
<td class="gt_row gt_left">2022-04-25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Everything is nicely aligned: the first data corresponds to the installation date, and the last data corresponds to the date the data were retrieved.</p>
<p>Plot the position of each of the counters using the given <code>latitude</code> and <code>longitude</code>, overlaid on a map of Halifax with the <code>ggmap</code> package:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>site_locs <span class="ot">&lt;-</span> bike_data <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(site_name, <span class="at">lat =</span> latitude, <span class="at">lon =</span> longitude)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>mean_lat <span class="ot">&lt;-</span> <span class="fu">mean</span>(site_locs<span class="sc">$</span>lat)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>mean_lon <span class="ot">&lt;-</span> <span class="fu">mean</span>(site_locs<span class="sc">$</span>lon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>halifax_map <span class="ot">&lt;-</span> <span class="fu">get_googlemap</span>(<span class="fu">c</span>(mean_lon, mean_lat),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">zoom =</span> <span class="dv">14</span>, <span class="at">maptype =</span> <span class="st">"satellite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(halifax_map) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> site_locs, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> site_name), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> site_locs,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> site_name, <span class="at">label =</span> <span class="fu">str_trunc</span>(site_name, <span class="at">width =</span> <span class="dv">25</span>)),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">1.0</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For each site and channel, get the time of day from <code>count_datetime</code> to determine the frequency of collection:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_of_day =</span> <span class="fu">format</span>(count_datetime, <span class="st">"%H:%M:%S"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(site_name, time_of_day, <span class="at">name =</span> <span class="st">"n_records"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> time_of_day, <span class="at">x =</span> n_records)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">str_trunc</span>(site_name, <span class="dv">15</span>), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">1500</span>)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Each counter reports observations at the hour mark (+1 second). There are some slight difference in the number of records due to the time of day I retrieved the data.</p>
<p>I made an assumption that the <code>count_datetime</code> variable was in UTC timezone. I can check this assumption by looking at average counts (over the entire data set).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bike_data_tod <span class="ot">&lt;-</span> bike_data <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> <span class="fu">format</span>(count_datetime, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a dummy variable with arbitrary date so I can plot time of day</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_of_day =</span> lubridate<span class="sc">::</span><span class="fu">ymd_hms</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"2022-04-22 "</span>, time_of_day)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>bike_data_tod <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name, time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean_count =</span> <span class="fu">mean</span>(counter_value),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_of_day, <span class="at">y =</span> mean_count)) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>mellow_yellow, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_datetime</span>(<span class="at">date_breaks =</span> <span class="st">"2 hours"</span>, <span class="at">date_labels =</span> <span class="st">"%H"</span>) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These peaks at around 8AM and 5PM tell me that the data is actually recorded in the local time zone (Atlantic), not UTC like I assumed. If they were in UTC time, the peaks would correspond to 11AM and 8PM locally, which would be odd times for peak cyclists.</p>
<p>Any interesting trends in different channels?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bike_data_tod <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove Hollis St, which does not have different channels</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site_name <span class="sc">!=</span> <span class="st">"Hollis St"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">channel_direction =</span> <span class="fu">str_extract</span>(channel_name, <span class="st">"(North|South)bound"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name, channel_direction, time_of_day) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_count =</span> <span class="fu">mean</span>(counter_value), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_of_day, <span class="at">y =</span> mean_count, <span class="at">color =</span> channel_direction)) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_datetime</span>(<span class="at">date_breaks =</span> <span class="st">"2 hours"</span>, <span class="at">date_labels =</span> <span class="st">"%H"</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vernon St and Windsor St counters have higher traffic Southbound (heading downtown) at the start of the typical workday, and higher traffic Northbound (leaving downtown) at the end of the typical workday.</p>
<p>I am less interested in counts over the course of a day or by channel, and more interested in daily counts. Now that I know the <code>count_date</code> is correctly converted with the local time, get the sum at each site and each 24 hour day:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="ot">&lt;-</span> bike_data <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name, installation_date, count_date) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_records =</span> <span class="fu">n</span>(), <span class="at">n_bikes =</span> <span class="fu">sum</span>(counter_value), <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now plot counts per day at each site:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> n_bikes)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The seasonal trends are very obvious from this plot. One thing that stood out to me is the big increase from 2020 to 2021 on South Park St. It may be representative of the start of the COVID pandemic, but I think it also has to do with the addition of <a href="https://www.halifax.ca/transportation/cycling-walking/expanding-network/south-park-protected-bicycle-lanes">protected bike lanes in December 2020</a>. Before 2020, there appears to be a series of 0 counts on South Park St which may be artifacts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site_name <span class="sc">==</span> <span class="st">"South Park St"</span>, count_date <span class="sc">&lt;</span> <span class="st">"2020-01-01"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> n_bikes)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>I’m almost certain this series of zeroes is not real, so I’ll remove it from the data. Find the date of the first non-zero <code>n_bikes</code> at this site, and filter out data before then:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>south_park_min_date <span class="ot">&lt;-</span> bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site_name <span class="sc">==</span> <span class="st">"South Park St"</span>, n_bikes <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(count_date) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>south_park_min_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2019-11-23"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="ot">&lt;-</span> bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>((site_name <span class="sc">==</span> <span class="st">"South Park St"</span>) <span class="sc">&amp;</span> (count_date <span class="sc">&lt;</span> south_park_min_date)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Overlay counts by year for each site:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_year =</span> <span class="fu">year</span>(count_date),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Replace year with 1970 so I can plot on the same scale</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">count_date =</span> <span class="fu">as.Date</span>(<span class="fu">yday</span>(count_date), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> n_bikes, <span class="at">color =</span> <span class="fu">factor</span>(count_year))) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%B"</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I’m interested in day of the week effects as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_of_week =</span> <span class="fu">wday</span>(count_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> day_of_week, <span class="at">x =</span> n_bikes)) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Less activity on the weekends.</p>
</section>
</section>
<section id="getting-weather-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-weather-data">Getting weather data</h2>
<p>Temporal data are probably the most important predictors of ridership, but I’m sure a close second is the day’s weather. I’ll get this with <a href="https://api.weather.gc.ca/">the API provided by the Meteorological Service of Canada</a>. I can get a list of available data sets (which they call collections) as follows:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://api.weather.gc.ca/"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="fu">paste0</span>(base_url, <span class="st">"collections?f=json"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>content_parsed <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(content_parsed, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ collections:List of 70
 $ links      :List of 3</code></pre>
</div>
</div>
<p>The first element of <code>collections</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>collections <span class="ot">&lt;-</span> content_parsed<span class="sc">$</span>collections</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(collections[[<span class="dv">1</span>]], <span class="at">max.level =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 7
 $ id         : chr "hydrometric-stations"
 $ title      : chr "Hydrometric Monitoring Stations"
 $ description: chr "A station is a site on a river or lake where water quantity (water level and flow) are collected and recorded."
 $ keywords   :List of 2
  ..$ : chr "station"
  ..$ : chr "hydrometric station"
 $ links      :List of 13
  ..$ :List of 5
  ..$ :List of 5
  ..$ :List of 5
  ..$ :List of 5
  ..$ :List of 5
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
  ..$ :List of 4
 $ extent     :List of 2
  ..$ spatial :List of 2
  ..$ temporal:List of 1
 $ itemType   : chr "feature"</code></pre>
</div>
</div>
<p>Unlike the bicycle counts data, this nested format doesn’t lend itself well to direct conversion to a <code>tibble</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(collections[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error:
! Tibble columns must have compatible sizes.
• Size 2: Columns `keywords` and `extent`.
• Size 13: Column `links`.
ℹ Only values of size one are recycled.</code></pre>
</div>
</div>
<p>Instead, I can use <code>enframe()</code> to get a two-column data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">enframe</span>(collections[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  name        value           
  &lt;chr&gt;       &lt;list&gt;          
1 id          &lt;chr [1]&gt;       
2 title       &lt;chr [1]&gt;       
3 description &lt;chr [1]&gt;       
4 keywords    &lt;list [2]&gt;      
5 links       &lt;list [13]&gt;     
6 extent      &lt;named list [2]&gt;
7 itemType    &lt;chr [1]&gt;       </code></pre>
</div>
</div>
<p>Assuming every item in the <code>collections</code> list has the same structure, I’ll just extract the <code>id</code>, <code>title</code>, and <code>description</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>collections_df <span class="ot">&lt;-</span>  <span class="fu">map_dfr</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  collections,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">enframe</span>(.x) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"title"</span>, <span class="st">"description"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(collections_df) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">container.height =</span> <span class="dv">300</span>, <span class="at">container.overflow.y =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ldbdurrilw" style="overflow-x:auto;overflow-y:auto;width:auto;height:300px;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ldbdurrilw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ldbdurrilw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldbdurrilw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ldbdurrilw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ldbdurrilw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldbdurrilw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldbdurrilw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ldbdurrilw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ldbdurrilw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ldbdurrilw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ldbdurrilw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ldbdurrilw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ldbdurrilw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ldbdurrilw .gt_from_md > :first-child {
  margin-top: 0;
}

#ldbdurrilw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ldbdurrilw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ldbdurrilw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ldbdurrilw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ldbdurrilw .gt_row_group_first td {
  border-top-width: 2px;
}

#ldbdurrilw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldbdurrilw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ldbdurrilw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ldbdurrilw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldbdurrilw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldbdurrilw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ldbdurrilw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ldbdurrilw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldbdurrilw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldbdurrilw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldbdurrilw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldbdurrilw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldbdurrilw .gt_left {
  text-align: left;
}

#ldbdurrilw .gt_center {
  text-align: center;
}

#ldbdurrilw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ldbdurrilw .gt_font_normal {
  font-weight: normal;
}

#ldbdurrilw .gt_font_bold {
  font-weight: bold;
}

#ldbdurrilw .gt_font_italic {
  font-style: italic;
}

#ldbdurrilw .gt_super {
  font-size: 65%;
}

#ldbdurrilw .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ldbdurrilw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ldbdurrilw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ldbdurrilw .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ldbdurrilw .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ldbdurrilw .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th">id</th>
<th class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th">title</th>
<th class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th">description</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center">hydrometric-stations</td>
<td class="gt_row gt_center">Hydrometric Monitoring Stations</td>
<td class="gt_row gt_center">A station is a site on a river or lake where water quantity (water level and flow) are collected and recorded.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">hydrometric-daily-mean</td>
<td class="gt_row gt_center">Daily Mean of Water Level or Flow</td>
<td class="gt_row gt_center">The daily mean is the average of all unit values for a given day.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">hydrometric-monthly-mean</td>
<td class="gt_row gt_center">Monthly Mean of Water Level or Flow</td>
<td class="gt_row gt_center">The monthly mean is the average of daily mean values for a given month.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">hydrometric-annual-statistics</td>
<td class="gt_row gt_center">Annual Maximum and Minimum Daily Water Level or Flow</td>
<td class="gt_row gt_center">The annual maximum and minimum daily data are the maximum and minimum daily mean values for a given year.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">hydrometric-annual-peaks</td>
<td class="gt_row gt_center">Annual Maximum and Minimum Instantaneous Water Level or Flow</td>
<td class="gt_row gt_center">The annual maximum and minimum instantaneous data are the maximum and minimum instantaneous values for a given year.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">hydrometric-realtime</td>
<td class="gt_row gt_center">Real-time hydrometric data</td>
<td class="gt_row gt_center">Real-time water level and flow (discharge) data collected at over 2100 hydrometric stations across Canada (last 30 days).</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate-normals</td>
<td class="gt_row gt_center">1981-2010 Climate Normals</td>
<td class="gt_row gt_center">Climate Normals are used to summarize or describe the average climatic conditions of a particular location. At the completion of each decade, Environment and Climate Change Canada updates its climate normals for as many locations and as many climatic characteristics as possible. The climate normals offered here are based on Canadian climate stations with at least 15 years of data between 1981 to 2010.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate-stations</td>
<td class="gt_row gt_center">Climate Stations</td>
<td class="gt_row gt_center">Climate observations are derived from two sources of data. The first are Daily Climate Stations producing one or two observations per day of temperature, precipitation. The second are hourly stations that typically produce more weather elements e.g. wind or snow on ground.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate-monthly</td>
<td class="gt_row gt_center">Monthly Climate Observation Summaries</td>
<td class="gt_row gt_center">A cross-country summary of the averages and extremes for the month, including precipitation totals, max-min temperatures, and degree days. This data is available from stations that produce daily data.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate-daily</td>
<td class="gt_row gt_center">Daily Climate Observations</td>
<td class="gt_row gt_center">Daily climate observations are derived from two sources of data. The first are Daily Climate Stations producing one or two observations per day of temperature, precipitation. The second are hourly stations that typically produce more weather elements e.g. wind or snow on ground. Only a subset of the total stations is shown due to size limitations. The criteria for station selection are listed as below. The priorities for inclusion are as follows: (1) Station is currently operational, (2) Stations with long periods of record, (3) Stations that are co-located with the categories above and supplement the period of record</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate-hourly</td>
<td class="gt_row gt_center">Hourly Climate Observations</td>
<td class="gt_row gt_center">Hourly climate observations are derived from the data source HLY01. These are stations that produce hourly meteorological observations, taken each hour of the day for the hours 00h-23h, for both daily (temperature, precipitation) and non-daily elements (station pressure, relative humidity, visibility). Only a subset of the total stations are shown due to size limitations. The stations were selected based on the following criteria: (1) Stations near cities with populations greater than 10,000, (2) Stations with long periods of record of at least 30 years of data, (3) Stations selected for the 1991-2020 WMO Normals, (4) Stations with RBCN designation not selected for 1991-2020 WMO Normals, and/or (5) Stations whose sum when joined with co-located/successor stations equates to a period of record of 30 years or greater.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">ahccd-stations</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) Stations</td>
<td class="gt_row gt_center">Climate station datasets that incorporate adjustments (derived from statistical procedures) to the original historical station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">ahccd-annual</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) Annual</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) are climate station datasets that incorporate adjustments (derived from statistical procedures) to the original historical station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. Data are provided for temperature, precipitation, pressure and wind speed. Station trend data are provided when available. Trends are calculated using the Theil-Sen method using the station's full period of available data. The availability of trends will vary by station; if more than 5 consecutive years are missing data or more than 10% of the data within the time series is missing, a trend was not calculated.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">ahccd-seasonal</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) Seasonal</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) are climate station datasets that incorporate adjustments (derived from statistical procedures) to the original historical station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. Data are provided for temperature, precipitation, pressure and wind speed. Station trend data are provided when available. Trends are calculated using the Theil-Sen method using the station's full period of available data. The availability of trends will vary by station; if more than 5 consecutive years are missing data or more than 10% of the data within the time series is missing, a trend was not calculated.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">ahccd-monthly</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) Monthly</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) are climate station datasets that incorporate adjustments (derived from statistical procedures) to the original historical station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. Data are provided for temperature, precipitation, pressure and wind speed. Station trend data are provided when available. Trends are calculated using the Theil-Sen method using the station's full period of available data. The availability of trends will vary by station; if more than 5 consecutive years are missing data or more than 10% of the data within the time series is missing, a trend was not calculated.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">ahccd-trends</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) Trends</td>
<td class="gt_row gt_center">Adjusted and Homogenized Canadian Climate Data (AHCCD) are climate station datasets that incorporate adjustments (derived from statistical procedures) to the original historical station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. Data are provided for temperature, precipitation, pressure and wind speed. Station trend data are provided when available. Trends are calculated using the Theil-Sen method using the station's full period of available data. The availability of trends will vary by station; if more than 5 consecutive years are missing data or more than 10% of the data within the time series is missing, a trend was not calculated.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">swob-realtime</td>
<td class="gt_row gt_center">Surface Weather Observations</td>
<td class="gt_row gt_center">Surface Observations measured at the automatic and manual stations of the Environment and Climate Change Canada and partners networks, either for a single station, or for the stations of specific provinces and territories (last 30 days)</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">ltce-stations</td>
<td class="gt_row gt_center">Virtual Climate Stations (LTCE)</td>
<td class="gt_row gt_center">A Virtual Climate station is the result of threading together climate data from proximate current and historical stations to construct a long term threaded data set. For the purpose of identifying and tabulating daily extremes of record for temperature, precipitation and snowfall, the Meteorological Service of Canada has threaded or put together data from closely related stations to compile a long time series of data for about 750 locations in Canada to monitor for record-breaking weather. The length of the time series of virtual stations is often greater than 100 years. A Virtual Climate station is always named for an “Area” rather than a point, e.g. Winnipeg Area, to indicate that the data are drawn from that area(within a 20km radius from the urban center) rather than a single precise location.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">ltce-temperature</td>
<td class="gt_row gt_center">Daily Extremes of Records (LTCE) – Temperature</td>
<td class="gt_row gt_center">Anomalous weather resulting in Temperature and Precipitation extremes occurs almost every day somewhere in Canada. For the purpose of identifying and tabulating daily extremes of record for temperature, precipitation and snowfall, the Meteorological Service of Canada has threaded or put together data from closely related stations to compile a long time series of data for about 750 locations in Canada to monitor for record-breaking weather. Virtual Climate stations correspond with the city pages of weather.gc.ca. This data provides the daily extremes of record for Temperature for each day of the year. Daily elements include: High Maximum, Low Maximum, High Minimum, Low Minimum.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">ltce-precipitation</td>
<td class="gt_row gt_center">Daily Extremes of Records (LTCE) – Precipitation</td>
<td class="gt_row gt_center">Anomalous weather resulting in Temperature and Precipitation extremes occurs almost every day somewhere in Canada. For the purpose of identifying and tabulating daily extremes of record for temperature, precipitation and snowfall, the Meteorological Service of Canada has threaded or put together data from closely related stations to compile a long time series of data for about 750 locations in Canada to monitor for record-breaking weather. Virtual Climate stations correspond with the city pages of weather.gc.ca. This data provides the daily extremes of record for Precipitation for each day of the year. Daily elements include: Greatest Precipitation.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">ltce-snowfall</td>
<td class="gt_row gt_center">Daily Extremes of Records (LTCE) – Snowfall</td>
<td class="gt_row gt_center">Anomalous weather resulting in Temperature and Precipitation extremes occurs almost every day somewhere in Canada. For the purpose of identifying and tabulating daily extremes of record for temperature, precipitation and snowfall, the Meteorological Service of Canada has threaded or put together data from closely related stations to compile a long time series of data for about 750 locations in Canada to monitor for record-breaking weather. Virtual Climate stations correspond with the city pages of weather.gc.ca. This data provides the daily extremes of record for Snowfall for each day of the year. Daily elements include: Greatest Snowfall.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">aqhi-forecasts-realtime</td>
<td class="gt_row gt_center">Air Quality Health Index – Forecasts</td>
<td class="gt_row gt_center">The Air Quality Health Index (AQHI) is a scale designed to help quantify the quality of the air in a certain region on a scale from 1 to 10. When the amount of air pollution is very high, the number is reported as 10+. It also includes a category that describes the health risk associated with the index reading (e.g. Low, Moderate, High, or Very High Health Risk). The AQHI is calculated based on the relative risks of a combination of common air pollutants that are known to harm human health, including ground-level ozone, particulate matter, and nitrogen dioxide. The AQHI formulation captures only the short term or acute health risk (exposure of hour or days at a maximum). The formulation of the AQHI may change over time to reflect new understanding associated with air pollution health effects. The AQHI is calculated from data observed in real time, without being verified (quality control).</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">aqhi-observations-realtime</td>
<td class="gt_row gt_center">Air Quality Health Index – Observations</td>
<td class="gt_row gt_center">The Air Quality Health Index (AQHI) is a scale designed to help quantify the quality of the air in a certain region on a scale from 1 to 10. When the amount of air pollution is very high, the number is reported as 10+. It also includes a category that describes the health risk associated with the index reading (e.g. Low, Moderate, High, or Very High Health Risk). The AQHI is calculated based on the relative risks of a combination of common air pollutants that are known to harm human health, including ground-level ozone, particulate matter, and nitrogen dioxide. The AQHI formulation captures only the short term or acute health risk (exposure of hour or days at a maximum). The formulation of the AQHI may change over time to reflect new understanding associated with air pollution health effects. The AQHI is calculated from data observed in real time, without being verified (quality control).</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">bulletins-realtime</td>
<td class="gt_row gt_center">Real-time meteorological bulletins</td>
<td class="gt_row gt_center">Real-time meteorological bulletins (last 140 days)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:projected:annual:anomaly</td>
<td class="gt_row gt_center">Projected annual anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:projected:seasonal:anomaly</td>
<td class="gt_row gt_center">Projected seasonal anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:projected:monthly:anomaly</td>
<td class="gt_row gt_center">Projected monthly anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:projected:annual:absolute</td>
<td class="gt_row gt_center">Projected annual CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:projected:seasonal:absolute</td>
<td class="gt_row gt_center">Projected seasonal CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:projected:monthly:absolute</td>
<td class="gt_row gt_center">Projected monthly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:projected:annual:P20Y-Avg</td>
<td class="gt_row gt_center">Projected annual anomaly for 20 years average CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:projected:seasonal:P20Y-Avg</td>
<td class="gt_row gt_center">Projected seasonal anomaly for 20 years average CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:historical:annual:absolute</td>
<td class="gt_row gt_center">Historical annual CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:historical:annual:anomaly</td>
<td class="gt_row gt_center">Historical annual anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:historical:seasonal:absolute</td>
<td class="gt_row gt_center">Historical seasonal CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:historical:seasonal:anomaly</td>
<td class="gt_row gt_center">Historical seasonal anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cmip5:historical:monthly:absolute</td>
<td class="gt_row gt_center">Historical monthly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cmip5:historical:monthly:anomaly</td>
<td class="gt_row gt_center">Historical monthly anomaly CMIP5</td>
<td class="gt_row gt_center">The Global climate model scenarios dataset is based on an ensemble of global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). Multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios at a 1x1 degree grid resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. A range of percentiles across the multi-model ensembles are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:projected:annual:anomaly</td>
<td class="gt_row gt_center">Projected annual anomaly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:projected:seasonal:anomaly</td>
<td class="gt_row gt_center">Projected seasonal anomaly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:projected:annual:absolute</td>
<td class="gt_row gt_center">Projected annual DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:projected:seasonal:absolute</td>
<td class="gt_row gt_center">Projected seasonal DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:projected:monthly:absolute</td>
<td class="gt_row gt_center">Projected monthly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:projected:annual:P20Y-Avg</td>
<td class="gt_row gt_center">Projected annual anomaly for 20 years average DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:projected:seasonal:P20Y-Avg</td>
<td class="gt_row gt_center">Projected seasonal anomaly for 20 years average DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:historical:annual:absolute</td>
<td class="gt_row gt_center">Historical annual DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:historical:annual:anomaly</td>
<td class="gt_row gt_center">Historical annual anomaly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:historical:seasonal:absolute</td>
<td class="gt_row gt_center">Historical seasonal DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:dcs:historical:seasonal:anomaly</td>
<td class="gt_row gt_center">Historical seasonal anomaly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:dcs:historical:monthly:absolute</td>
<td class="gt_row gt_center">Historical monthly DCS</td>
<td class="gt_row gt_center">The statistically downscaled climate scenarios dataset provides multi-model ensembles of modelled output (actual value) and projected change (anomaly) are available for historical simulations and three emission scenarios, RCP2.6, RCP4.5, RCP8.5, at a 10km resolution. Projected changes are expressed as anomalies with respect to the reference period of 1986-2005. Downscaled data are based on global climate model projections from the Coupled Model Intercomparison Project Phase 5 (CMIP5). A range of percentiles across the multi-model ensemble are available for download.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:indices:historical</td>
<td class="gt_row gt_center">Historical indices</td>
<td class="gt_row gt_center">High-resolution statistically downscaled climate indices relevant to climate change impacts in Canada are available at a 10 km spatial resolution and an annual temporal resolution for 1951-2100. The climate indices are based on model projections from 24 global climate models (GCMs) that participated in the Coupled Model Intercomparison Project Phase 5 (CMIP5).</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:indices:projected</td>
<td class="gt_row gt_center">Projected indices</td>
<td class="gt_row gt_center">High-resolution statistically downscaled climate indices relevant to climate change impacts in Canada are available at a 10 km spatial resolution and an annual temporal resolution for 1951-2100. The climate indices are based on model projections from 24 global climate models (GCMs) that participated in the Coupled Model Intercomparison Project Phase 5 (CMIP5).</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:spei-1:historical</td>
<td class="gt_row gt_center">Historical SPEI-1</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:spei-3:historical</td>
<td class="gt_row gt_center">Historical SPEI-3</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:spei-12:historical</td>
<td class="gt_row gt_center">Historical SPEI-12</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:spei-1:projected</td>
<td class="gt_row gt_center">Projected SPEI-1</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:spei-3:projected</td>
<td class="gt_row gt_center">Projected SPEI-3</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:spei-12:projected</td>
<td class="gt_row gt_center">Projected SPEI-12</td>
<td class="gt_row gt_center">The Standardized Precipitation Evapotranspiration Index (SPEI) is computed similarly to the SPI. The main difference is that SPI assesses precipitation variance, while SPEI also considers demand from evapotranspiration which is subtracted from any precipitation accumulation prior to assessment. Unlike the SPI, the SPEI captures the main impact of increased temperatures on water demand.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cangrd:historical:annual:trend</td>
<td class="gt_row gt_center">CanGRD historical annual trend</td>
<td class="gt_row gt_center">CANGRD data are interpolated from adjusted and homogenized climate station data (i.e., AHCCD datasets). Homogenized climate data incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. Annual trends of relative total precipitation change (%) for 1948-2012 based on Canadian gridded data (CANGRD) are available, at a 50km resolution across Canada. The relative trends reflect the percent change in total precipitation over a period from the baseline value (defined as the average over 1961-1990 as the reference period). Annual trends of mean surface air temperature change (degrees Celsius) for 1948-2016 based on Canadian gridded data (CANGRD) are available at a 50km resolution across Canada. Temperature trends represent the departure from a mean reference period (1961-1990).</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cangrd:historical:annual:anomaly</td>
<td class="gt_row gt_center">CanGRD historical annual anomaly</td>
<td class="gt_row gt_center">Gridded annual mean temperature anomalies derived from daily minimum, maximum and mean surface air temperatures (degrees Celsius) and anomalies derived from daily total precipitation is available at a 50km resolution across Canada. The Canadian gridded data (CANGRD) are interpolated from homogenized temperature (i.e., AHCCD datasets). Homogenized temperatures incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the difference between the temperature for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal temperature anomalies were computed for the years 1948 to 2017. The data will continue to be updated every year. For precipitation, the Canadian gridded data (CANGRD) are interpolated from adjusted precipitation (i.e., AHCCD datasets). Adjusted precipitation data incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the percentage difference between the value for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal relative precipitation anomalies were computed for the years 1948 to 2014. The data will be updated as time permits.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cangrd:historical:monthly:anomaly</td>
<td class="gt_row gt_center">CanGRD historical monthly anomaly</td>
<td class="gt_row gt_center">Gridded monthly mean temperature anomalies derived from daily minimum, maximum and mean surface air temperatures (degrees Celsius) and anomalies derived from daily total precipitation is available at a 50km resolution across Canada. The Canadian gridded data (CANGRD) are interpolated from homogenized temperature (i.e., AHCCD datasets). Homogenized temperatures incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the difference between the temperature for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal temperature anomalies were computed for the years 1948 to 2017. The data will continue to be updated every year. For precipitation, the Canadian gridded data (CANGRD) are interpolated from adjusted precipitation (i.e., AHCCD datasets). Adjusted precipitation data incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the percentage difference between the value for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal relative precipitation anomalies were computed for the years 1948 to 2014. The data will be updated as time permits.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">climate:cangrd:historical:seasonal:trend</td>
<td class="gt_row gt_center">CanGRD historical seasonal trend</td>
<td class="gt_row gt_center">CANGRD data are interpolated from adjusted and homogenized climate station data (i.e., AHCCD datasets). Homogenized climate data incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation.Seasonal trends of relative total precipitation change (%) for 1948-2012 based on Canadian gridded data (CANGRD) are available, at a 50km resolution across Canada. The relative trends reflect the percent change in total precipitation over a period from the baseline value (defined as the average over 1961-1990 as the reference period). Seasonal trends of mean surface air temperature change (degrees Celsius) for 1948-2016 based on Canadian gridded data (CANGRD) are available at a 50km resolution across Canada. Temperature trends represent the departure from a mean reference period (1961-1990).</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">climate:cangrd:historical:seasonal:anomaly</td>
<td class="gt_row gt_center">CanGRD historical seasonal anomaly</td>
<td class="gt_row gt_center">Gridded seasonal mean temperature anomalies derived from daily minimum, maximum and mean surface air temperatures (degrees Celsius) and anomalies derived from daily total precipitation is available at a 50km resolution across Canada. The Canadian gridded data (CANGRD) are interpolated from homogenized temperature (i.e., AHCCD datasets). Homogenized temperatures incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the difference between the temperature for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal temperature anomalies were computed for the years 1948 to 2017. The data will continue to be updated every year. For precipitation, the Canadian gridded data (CANGRD) are interpolated from adjusted precipitation (i.e., AHCCD datasets). Adjusted precipitation data incorporate adjustments to the original station data to account for discontinuities from non-climatic factors, such as instrument changes or station relocation. The anomalies are the percentage difference between the value for a given year or season and a baseline value (defined as the average over 1961-1990 as the reference period). The yearly and seasonal relative precipitation anomalies were computed for the years 1948 to 2014. The data will be updated as time permits.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">weather:rdpa:15km:24f</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 24 hours accumulation at 15km</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 24 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 15 km. Data is only available for the surface level. Analysis data is made available once a day for the 24h intervals. A preliminary estimate is available approximately 1h after the end of the accumulation period, and revised 6h after in order to assimilate gauge data arriving later.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">weather:rdpa:15km:6f</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 6 hours accumulation at 15 km</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 6 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 15 km. Data is only available for the surface level. Analysis data is made available four times a day for the 6h intervals. A preliminary estimate is available approximately 1h after the end of the accumulation period, and revised 6h after in order to assimilate gauge data arriving later.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">weather:rdpa:10km:24f</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 24 hours accumulation</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 24 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 10 km. Data is only available for the surface level. Analysis data is made available once a day for the 24h intervals. A preliminary estimate is available approximately 1h after the end of the accumulation period, and revised 6h after in order to assimilate gauge data arriving later.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">weather:rdpa:10km:6f</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 6 hours accumulation</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 6 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 10 km. Data is only available for the surface level. Analysis data is made available four times a day for the 6h intervals. A preliminary estimate is available approximately 1h after the end of the accumulation period, and revised 6h after in order to assimilate gauge data arriving later.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">weather:rdpa:10km:24p</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 24 hours accumulation (preliminary)</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 24 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 10 km. Data is only available for the surface level. Analysis data is made available once a day for the 24h intervals. The preliminary estimate is available approximately 1h after the end of the accumulation period.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center">weather:rdpa:10km:6p</td>
<td class="gt_row gt_center">Regional Deterministic Precipitation Analysis (RDPA) 6 hours accumulation (preliminary)</td>
<td class="gt_row gt_center">The Regional Deterministic Precipitation Analysis (RDPA) produces a best estimate of the amount of precipitation that occurred over recent past periods of 6 hours. The estimate integrates data from in situ precipitation gauge measurements, weather radar and numerical weather prediction models. Geographic coverage is North America (Canada, United States and Mexico). Data is available at horizontal resolution of 10 km. Data is only available for the surface level. Analysis data is made available four times a day for 6h intervals. The preliminary estimate is available approximately 1h after the end of the accumulation period.</td>
</tr>
<tr class="even">
<td class="gt_row gt_center">weather:cansips:250km:forecast:members</td>
<td class="gt_row gt_center">Canadian Seasonal to Inter-annual Prediction System</td>
<td class="gt_row gt_center">The Canadian Seasonal to Inter-annual Prediction System (CanSIPS) carries out physics calculations to arrive at probabilistic predictions of atmospheric elements from the beginning of a month out to up to 12 months into the future. Atmospheric elements include temperature, precipitation, wind speed and direction and others. This product contains raw numerical results of these calculations. Geographical coverage is global. Data is available on a grid at a horizontal resolution of 2.5 degrees and for a few selected vertical levels. Predictions and corresponding hindcast are made available monthly.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The collections I want for this project are <code>climate-stations</code> (to find the appropriate Halifax station) and <code>climate-daily</code> to get daily measurements at that station. Get <code>climate-stations</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="fu">paste0</span>(base_url, <span class="st">"collections/climate-stations/items?f=json"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>content_parsed <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(content_parsed, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ type          : chr "FeatureCollection"
 $ features      :List of 500
 $ numberMatched : int 8552
 $ numberReturned: int 500
 $ links         :List of 5
 $ timeStamp     : chr "2022-04-27T03:27:26.475648Z"</code></pre>
</div>
</div>
<p>Before looking closer at the data, I can already tell I’ll want to increase the limit of returned entries. From the API documentation, the maximum number is 10000, so I can get all 8552 records in one API call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="fu">paste0</span>(base_url,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"collections/climate-stations/items?f=json&amp;limit=10000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>content_parsed <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(content_parsed, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ type          : chr "FeatureCollection"
 $ features      :List of 8552
 $ numberMatched : int 8552
 $ numberReturned: int 8552
 $ links         :List of 4
 $ timeStamp     : chr "2022-04-27T03:27:27.265491Z"</code></pre>
</div>
</div>
<p>The data is contained in the <code>features</code> list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>climate_stations <span class="ot">&lt;-</span> content_parsed<span class="sc">$</span>features</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(climate_stations[[<span class="dv">1</span>]], <span class="at">max.level =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ type      : chr "Feature"
 $ properties:List of 32
  ..$ STN_ID                  : int 8496
  ..$ STATION_NAME            : chr "CARLETON SUR MER"
  ..$ PROV_STATE_TERR_CODE    : chr "QC"
  ..$ ENG_PROV_NAME           : chr "QUEBEC"
  ..$ FRE_PROV_NAME           : chr "QUÉBEC"
  ..$ COUNTRY                 : chr "CAN"
  ..$ LATITUDE                : int 480800000
  ..$ LONGITUDE               : int -660700000
  ..$ TIMEZONE                : chr "EST"
  ..$ ELEVATION               : chr "541.00"
  ..$ CLIMATE_IDENTIFIER      : chr "705AA86"
  ..$ TC_IDENTIFIER           : NULL
  ..$ WMO_IDENTIFIER          : NULL
  ..$ STATION_TYPE            : chr "N/A"
  ..$ NORMAL_CODE             : NULL
  ..$ PUBLICATION_CODE        : int 1
  ..$ DISPLAY_CODE            : int 9
  ..$ ENG_STN_OPERATOR_ACRONYM: NULL
  ..$ FRE_STN_OPERATOR_ACRONYM: NULL
  ..$ ENG_STN_OPERATOR_NAME   : NULL
  ..$ FRE_STN_OPERATOR_NAME   : NULL
  ..$ FIRST_DATE              : chr "1968-10-01 00:00:00"
  ..$ LAST_DATE               : chr "1968-10-31 00:00:00"
  ..$ HLY_FIRST_DATE          : NULL
  ..$ HLY_LAST_DATE           : NULL
  ..$ DLY_FIRST_DATE          : chr "1968-10-01 00:00:00"
  ..$ DLY_LAST_DATE           : chr "1968-10-31 00:00:00"
  ..$ MLY_FIRST_DATE          : NULL
  ..$ MLY_LAST_DATE           : NULL
  ..$ HAS_MONTHLY_SUMMARY     : chr "Y"
  ..$ HAS_NORMALS_DATA        : chr "N"
  ..$ HAS_HOURLY_DATA         : chr "N"
 $ geometry  :List of 2
  ..$ type       : chr "Point"
  ..$ coordinates:List of 2
  .. ..$ : num -66.1
  .. ..$ : num 48.1
 $ id        : chr "705AA86"</code></pre>
</div>
</div>
<p>After some frustration, I found that the <code>geometry$coordinates</code> are the correct latitude/longitude – those in the <code>properties</code> list are slightly off for some reason. Extract the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>climate_stations <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  climate_stations,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">discard</span>(.x<span class="sc">$</span>properties, is.null) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lat =</span> .x<span class="sc">$</span>geometry<span class="sc">$</span>coordinates[[<span class="dv">2</span>]],</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">lon =</span> .x<span class="sc">$</span>geometry<span class="sc">$</span>coordinates[[<span class="dv">1</span>]])</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop the incorrect latitude and longitude</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>latitude, <span class="sc">-</span>longitude)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(climate_stations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8,552
Columns: 32
$ stn_id                   &lt;int&gt; 8496, 9005, 10205, 6149, 6154, 6174, 6177, 61…
$ station_name             &lt;chr&gt; "CARLETON SUR MER", "PORT COLBORNE (AUT)", "K…
$ prov_state_terr_code     &lt;chr&gt; "QC", "ON", "QC", "NB", "NB", "NB", "NB", "NB…
$ eng_prov_name            &lt;chr&gt; "QUEBEC", "ONTARIO", "QUEBEC", "NEW BRUNSWICK…
$ fre_prov_name            &lt;chr&gt; "QUÉBEC", "ONTARIO", "QUÉBEC", "NOUVEAU-BRUNS…
$ country                  &lt;chr&gt; "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CA…
$ timezone                 &lt;chr&gt; "EST", "EST", "EST", "AST", "AST", "AST", "AS…
$ elevation                &lt;chr&gt; "541.00", "183.50", "123.80", "152.40", "173.…
$ climate_identifier       &lt;chr&gt; "705AA86", "613F606", "7113382", "8101178", "…
$ station_type             &lt;chr&gt; "N/A", "Climate-Auto", "N/A", "N/A", "N/A", "…
$ publication_code         &lt;int&gt; 1, NA, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ display_code             &lt;int&gt; 9, NA, NA, 7, 9, 5, 9, 7, 7, 9, 9, 8, 9, 9, 1…
$ first_date               &lt;chr&gt; "1968-10-01 00:00:00", "1992-12-02 00:00:00",…
$ last_date                &lt;chr&gt; "1968-10-31 00:00:00", "2022-04-24 12:30:02",…
$ dly_first_date           &lt;chr&gt; "1968-10-01 00:00:00", "1992-12-02 00:00:00",…
$ dly_last_date            &lt;chr&gt; "1968-10-31 00:00:00", "2022-04-24 00:00:00",…
$ has_monthly_summary      &lt;chr&gt; "Y", "Y", "N", "Y", "Y", "Y", "Y", "Y", "Y", …
$ has_normals_data         &lt;chr&gt; "N", "N", "N", "N", "N", "N", "N", "N", "N", …
$ has_hourly_data          &lt;chr&gt; "N", "Y", "Y", "N", "N", "N", "N", "N", "N", …
$ lat                      &lt;dbl&gt; 48.13333, 42.86667, 60.02306, 45.93333, 47.36…
$ lon                      &lt;dbl&gt; -66.11667, -79.25000, -70.00361, -64.78333, -…
$ tc_identifier            &lt;chr&gt; NA, "WPC", "YAS", NA, NA, NA, NA, NA, NA, NA,…
$ wmo_identifier           &lt;chr&gt; NA, "71463", NA, NA, NA, NA, NA, NA, NA, NA, …
$ eng_stn_operator_acronym &lt;chr&gt; NA, "ECCC - MSC", "DND", NA, NA, NA, NA, NA, …
$ fre_stn_operator_acronym &lt;chr&gt; NA, "ECCC - SMC", "MDN", NA, NA, NA, NA, NA, …
$ eng_stn_operator_name    &lt;chr&gt; NA, "Environment and Climate Change Canada - …
$ fre_stn_operator_name    &lt;chr&gt; NA, "Environnement et Changement climatique C…
$ hly_first_date           &lt;chr&gt; NA, "1994-02-01 02:00:00", "1992-10-21 07:00:…
$ hly_last_date            &lt;chr&gt; NA, "2022-04-24 12:30:02", "2015-09-10 13:00:…
$ mly_first_date           &lt;chr&gt; NA, "2006-04-01 00:00:00", NA, "1964-01-01 00…
$ mly_last_date            &lt;chr&gt; NA, "2006-12-01 00:00:00", NA, "1979-12-01 00…
$ normal_code              &lt;chr&gt; NA, NA, NA, "F", NA, "D", NA, "F", "F", NA, N…</code></pre>
</div>
</div>
<p>Now I’ll filter this list down to those in Halifax, NS using distance to the bike counter latitude/longitude means:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>climate_stations_halifax <span class="ot">&lt;-</span> climate_stations <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prov_state_terr_code <span class="sc">==</span> <span class="st">"NS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compare to the mean lat/lon from the bike counters</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_lat =</span> <span class="fu">abs</span>(lat <span class="sc">-</span> mean_lat), <span class="at">diff_lon =</span> <span class="fu">abs</span>(lon <span class="sc">-</span> mean_lon),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use squared distance to determine the closest points</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff2 =</span> diff_lat<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> diff_lon<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Look at the top 5 for now</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(diff2, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>climate_stations_halifax <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stn_id"],"name":[1],"type":["int"],"align":["right"]},{"label":["station_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["prov_state_terr_code"],"name":[3],"type":["chr"],"align":["left"]},{"label":["eng_prov_name"],"name":[4],"type":["chr"],"align":["left"]},{"label":["fre_prov_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["country"],"name":[6],"type":["chr"],"align":["left"]},{"label":["timezone"],"name":[7],"type":["chr"],"align":["left"]},{"label":["elevation"],"name":[8],"type":["chr"],"align":["left"]},{"label":["climate_identifier"],"name":[9],"type":["chr"],"align":["left"]},{"label":["station_type"],"name":[10],"type":["chr"],"align":["left"]},{"label":["publication_code"],"name":[11],"type":["int"],"align":["right"]},{"label":["display_code"],"name":[12],"type":["int"],"align":["right"]},{"label":["first_date"],"name":[13],"type":["chr"],"align":["left"]},{"label":["last_date"],"name":[14],"type":["chr"],"align":["left"]},{"label":["dly_first_date"],"name":[15],"type":["chr"],"align":["left"]},{"label":["dly_last_date"],"name":[16],"type":["chr"],"align":["left"]},{"label":["has_monthly_summary"],"name":[17],"type":["chr"],"align":["left"]},{"label":["has_normals_data"],"name":[18],"type":["chr"],"align":["left"]},{"label":["has_hourly_data"],"name":[19],"type":["chr"],"align":["left"]},{"label":["lat"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["lon"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["tc_identifier"],"name":[22],"type":["chr"],"align":["left"]},{"label":["wmo_identifier"],"name":[23],"type":["chr"],"align":["left"]},{"label":["eng_stn_operator_acronym"],"name":[24],"type":["chr"],"align":["left"]},{"label":["fre_stn_operator_acronym"],"name":[25],"type":["chr"],"align":["left"]},{"label":["eng_stn_operator_name"],"name":[26],"type":["chr"],"align":["left"]},{"label":["fre_stn_operator_name"],"name":[27],"type":["chr"],"align":["left"]},{"label":["hly_first_date"],"name":[28],"type":["chr"],"align":["left"]},{"label":["hly_last_date"],"name":[29],"type":["chr"],"align":["left"]},{"label":["mly_first_date"],"name":[30],"type":["chr"],"align":["left"]},{"label":["mly_last_date"],"name":[31],"type":["chr"],"align":["left"]},{"label":["normal_code"],"name":[32],"type":["chr"],"align":["left"]},{"label":["diff_lat"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["diff_lon"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["diff2"],"name":[35],"type":["dbl"],"align":["right"]}],"data":[{"1":"6357","2":"HALIFAX CITADEL","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"70.10","9":"8202220","10":"Climate-Staffed","11":"1","12":"1","13":"1933-01-01 00:00:00","14":"2002-01-31 00:00:00","15":"1933-08-01 00:00:00","16":"2002-01-31 00:00:00","17":"Y","18":"Y","19":"N","20":"44.65000","21":"-63.58333","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"1933-01-01 00:00:00","31":"2002-01-01 00:00:00","32":"A","33":"0.0003737181","34":"0.002169598","35":"4.846822e-06"},{"1":"43405","2":"HALIFAX DOCKYARD","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"3.80","9":"8202240","10":"Climate-Auto","11":"NA","12":"NA","13":"2004-09-24 18:00:00","14":"2022-04-24 12:30:02","15":"2018-05-14 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"Y","20":"44.65528","21":"-63.57667","22":"AHD","23":"71328","24":"DND","25":"MDN","26":"Department of National Defence","27":"Ministère de la Défense nationale","28":"2004-09-24 18:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.0049040596","34":"0.004497068","35":"4.427343e-05"},{"1":"6356","2":"HALIFAX","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"31.70","9":"8202200","10":"N/A","11":"1","12":"8","13":"1939-01-01 00:00:00","14":"1974-12-01 00:00:00","15":"1939-09-01 00:00:00","16":"1974-07-31 00:00:00","17":"Y","18":"N","19":"N","20":"44.65000","21":"-63.56667","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"1953-01-01 00:00:00","29":"1963-09-14 23:00:00","30":"1939-01-01 00:00:00","31":"1974-12-01 00:00:00","32":"G","33":"0.0003737181","34":"0.014497068","35":"2.103047e-04"},{"1":"6355","2":"HALIFAX","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"29.60","9":"8202198","10":"N/A","11":"1","12":"9","13":"1871-01-01 00:00:00","14":"1933-12-01 00:00:00","15":"1871-04-01 00:00:00","16":"1933-07-31 00:00:00","17":"Y","18":"N","19":"N","20":"44.65000","21":"-63.60000","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"1871-01-01 00:00:00","31":"1933-12-01 00:00:00","32":"NA","33":"0.0003737181","34":"0.018836265","35":"3.549445e-04"},{"1":"6332","2":"DARTMOUTH","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"22.90","9":"8201292","10":"N/A","11":"1","12":"9","13":"1990-01-01 00:00:00","14":"1991-12-31 00:00:00","15":"1990-10-01 00:00:00","16":"1991-12-31 00:00:00","17":"Y","18":"N","19":"N","20":"44.66667","21":"-63.56667","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"1990-01-01 00:00:00","31":"1991-12-01 00:00:00","32":"G","33":"0.0162929485","34":"0.014497068","35":"4.756252e-04"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Visualize the locations of the stations and bike counters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  site_locs <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"bike counters"</span>, <span class="at">label =</span> site_name),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  climate_stations_halifax <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"{station_name} ({stn_id})"</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>              lat, lon, diff2, <span class="at">group =</span> <span class="st">"climate stations"</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(halifax_map) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> group), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> group, <span class="at">label =</span> <span class="fu">str_trunc</span>(label, <span class="at">width =</span> <span class="dv">25</span>)),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="dv">2</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Halifax Citadel is the closest to the center, but <code>last_date</code> is 2002-01-31 for this station, so it hasn’t been active for the past two decades. The next closest is the dockyard, which is actively being updated (<code>last_date</code> is 2022-04-24).</p>
<p>Now with the station name (“HALIFAX DOCKYARD”), I can request the daily climate reports:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    base_url,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"collections/climate-daily/items?f=json&amp;limit=10000&amp;STATION_NAME=HALIFAX%20DOCKYARD"</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>content_parsed <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(content_parsed, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 6
 $ type          : chr "FeatureCollection"
 $ features      :List of 1399
 $ numberMatched : int 1399
 $ numberReturned: int 1399
 $ links         :List of 4
 $ timeStamp     : chr "2022-04-27T03:27:56.527206Z"</code></pre>
</div>
</div>
<p>The <code>features</code> data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="ot">&lt;-</span> content_parsed<span class="sc">$</span>features</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(daily_climate[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ id        : chr "8202240.2021.2.11"
 $ type      : chr "Feature"
 $ geometry  :List of 2
  ..$ coordinates:List of 2
  .. ..$ : num -63.6
  .. ..$ : num 44.7
  ..$ type       : chr "Point"
 $ properties:List of 34
  ..$ STATION_NAME            : chr "HALIFAX DOCKYARD"
  ..$ CLIMATE_IDENTIFIER      : chr "8202240"
  ..$ ID                      : chr "8202240.2021.2.11"
  ..$ LOCAL_DATE              : chr "2021-02-11 00:00:00"
  ..$ PROVINCE_CODE           : chr "NS"
  ..$ LOCAL_YEAR              : int 2021
  ..$ LOCAL_MONTH             : int 2
  ..$ LOCAL_DAY               : int 11
  ..$ MEAN_TEMPERATURE        : num -7.5
  ..$ MEAN_TEMPERATURE_FLAG   : NULL
  ..$ MIN_TEMPERATURE         : num -9.9
  ..$ MIN_TEMPERATURE_FLAG    : NULL
  ..$ MAX_TEMPERATURE         : num -5.1
  ..$ MAX_TEMPERATURE_FLAG    : NULL
  ..$ TOTAL_PRECIPITATION     : NULL
  ..$ TOTAL_PRECIPITATION_FLAG: NULL
  ..$ TOTAL_RAIN              : NULL
  ..$ TOTAL_RAIN_FLAG         : NULL
  ..$ TOTAL_SNOW              : NULL
  ..$ TOTAL_SNOW_FLAG         : NULL
  ..$ SNOW_ON_GROUND          : NULL
  ..$ SNOW_ON_GROUND_FLAG     : NULL
  ..$ DIRECTION_MAX_GUST      : int 28
  ..$ DIRECTION_MAX_GUST_FLAG : NULL
  ..$ SPEED_MAX_GUST          : int 47
  ..$ SPEED_MAX_GUST_FLAG     : NULL
  ..$ COOLING_DEGREE_DAYS     : int 0
  ..$ COOLING_DEGREE_DAYS_FLAG: NULL
  ..$ HEATING_DEGREE_DAYS     : num 25.5
  ..$ HEATING_DEGREE_DAYS_FLAG: NULL
  ..$ MIN_REL_HUMIDITY        : int 41
  ..$ MIN_REL_HUMIDITY_FLAG   : NULL
  ..$ MAX_REL_HUMIDITY        : int 66
  ..$ MAX_REL_HUMIDITY_FLAG   : NULL</code></pre>
</div>
</div>
<p>Unfortunately, this station does not report some helpful measurements, like precipitation and snowfall. I might have to expand my search to find a more informative station:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>climate_stations_halifax <span class="ot">&lt;-</span> climate_stations <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prov_state_terr_code <span class="sc">==</span> <span class="st">"NS"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Only include stations with recent data</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>         last_date <span class="sc">&gt;</span> <span class="st">"2022-04-21"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff_lat =</span> <span class="fu">abs</span>(lat <span class="sc">-</span> mean_lat), <span class="at">diff_lon =</span> <span class="fu">abs</span>(lon <span class="sc">-</span> mean_lon),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff2 =</span> diff_lat<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> diff_lon<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(diff2, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>climate_stations_halifax <span class="sc">%&gt;%</span> rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stn_id"],"name":[1],"type":["int"],"align":["right"]},{"label":["station_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["prov_state_terr_code"],"name":[3],"type":["chr"],"align":["left"]},{"label":["eng_prov_name"],"name":[4],"type":["chr"],"align":["left"]},{"label":["fre_prov_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["country"],"name":[6],"type":["chr"],"align":["left"]},{"label":["timezone"],"name":[7],"type":["chr"],"align":["left"]},{"label":["elevation"],"name":[8],"type":["chr"],"align":["left"]},{"label":["climate_identifier"],"name":[9],"type":["chr"],"align":["left"]},{"label":["station_type"],"name":[10],"type":["chr"],"align":["left"]},{"label":["publication_code"],"name":[11],"type":["int"],"align":["right"]},{"label":["display_code"],"name":[12],"type":["int"],"align":["right"]},{"label":["first_date"],"name":[13],"type":["chr"],"align":["left"]},{"label":["last_date"],"name":[14],"type":["chr"],"align":["left"]},{"label":["dly_first_date"],"name":[15],"type":["chr"],"align":["left"]},{"label":["dly_last_date"],"name":[16],"type":["chr"],"align":["left"]},{"label":["has_monthly_summary"],"name":[17],"type":["chr"],"align":["left"]},{"label":["has_normals_data"],"name":[18],"type":["chr"],"align":["left"]},{"label":["has_hourly_data"],"name":[19],"type":["chr"],"align":["left"]},{"label":["lat"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["lon"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["tc_identifier"],"name":[22],"type":["chr"],"align":["left"]},{"label":["wmo_identifier"],"name":[23],"type":["chr"],"align":["left"]},{"label":["eng_stn_operator_acronym"],"name":[24],"type":["chr"],"align":["left"]},{"label":["fre_stn_operator_acronym"],"name":[25],"type":["chr"],"align":["left"]},{"label":["eng_stn_operator_name"],"name":[26],"type":["chr"],"align":["left"]},{"label":["fre_stn_operator_name"],"name":[27],"type":["chr"],"align":["left"]},{"label":["hly_first_date"],"name":[28],"type":["chr"],"align":["left"]},{"label":["hly_last_date"],"name":[29],"type":["chr"],"align":["left"]},{"label":["mly_first_date"],"name":[30],"type":["chr"],"align":["left"]},{"label":["mly_last_date"],"name":[31],"type":["chr"],"align":["left"]},{"label":["normal_code"],"name":[32],"type":["chr"],"align":["left"]},{"label":["diff_lat"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["diff_lon"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["diff2"],"name":[35],"type":["dbl"],"align":["right"]}],"data":[{"1":"43405","2":"HALIFAX DOCKYARD","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"3.80","9":"8202240","10":"Climate-Auto","11":"NA","12":"NA","13":"2004-09-24 18:00:00","14":"2022-04-24 12:30:02","15":"2018-05-14 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"Y","20":"44.65528","21":"-63.57667","22":"AHD","23":"71328","24":"DND","25":"MDN","26":"Department of National Defence","27":"Ministère de la Défense nationale","28":"2004-09-24 18:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.004904060","34":"0.004497068","35":"4.427343e-05"},{"1":"43403","2":"HALIFAX WINDSOR PARK","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"51.00","9":"8202255","10":"Climate-Auto","11":"NA","12":"NA","13":"2004-09-24 18:00:00","14":"2022-04-24 12:30:02","15":"2018-05-14 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"Y","20":"44.65694","21":"-63.60889","22":"AHW","23":"71327","24":"DND","25":"MDN","26":"Department of National Defence","27":"Ministère de la Défense nationale","28":"2004-09-24 18:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.006570726","34":"0.027725154","35":"8.118586e-04"},{"1":"10945","2":"SHEARWATER JETTY","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"5.50","9":"8205093","10":"Climate-Auto","11":"NA","12":"NA","13":"1994-02-01 03:00:00","14":"2022-04-24 12:30:02","15":"2018-05-14 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"Y","20":"44.62778","21":"-63.52333","22":"WZU","23":"71330","24":"DND","25":"MDN","26":"Department of National Defence","27":"Ministère de la Défense nationale","28":"1994-02-01 03:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.022595940","34":"0.057830402","35":"3.854932e-03"},{"1":"7169","2":"MCNABS ISLAND (AUT)","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"15.40","9":"8203478","10":"Climate-Auto","11":"NA","12":"NA","13":"1999-10-13 18:00:00","14":"2022-04-24 12:30:02","15":"2005-11-01 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"N","20":"44.60000","21":"-63.53333","22":"XMI","23":"NA","24":"ECCC - MSC","25":"ECCC - SMC","26":"Environment and Climate Change Canada - Meteorological Service of Canada","27":"Environnement et Changement climatique Canada - Service météorologique du Canada","28":"1999-10-13 18:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.050373718","34":"0.047830402","35":"4.825259e-03"},{"1":"43124","2":"HALIFAX KOOTENAY","3":"NS","4":"NOVA SCOTIA","5":"NOUVELLE-ÉCOSSE","6":"CAN","7":"AST","8":"52.00","9":"8202252","10":"Climate-Auto","11":"NA","12":"NA","13":"2004-09-28 16:00:00","14":"2022-04-24 12:30:02","15":"2018-05-14 00:00:00","16":"2022-04-24 00:00:00","17":"Y","18":"N","19":"Y","20":"44.58764","21":"-63.55083","22":"AHK","23":"71326","24":"DND","25":"MDN","26":"Department of National Defence","27":"Ministère de la Défense nationale","28":"2004-09-28 16:00:00","29":"2022-04-24 12:30:02","30":"NA","31":"NA","32":"NA","33":"0.062734829","34":"0.030330402","35":"4.855592e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Visualize these station locations in a zoomed out map:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>hrm_map <span class="ot">&lt;-</span> <span class="fu">get_googlemap</span>(<span class="fu">c</span>(mean_lon, mean_lat),</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">zoom =</span> <span class="dv">12</span>, <span class="at">maptype =</span> <span class="st">"satellite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  site_locs <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"bike counters"</span>, <span class="at">label =</span> site_name),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  climate_stations_halifax <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"{station_name} ({stn_id})"</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>              lat, lon, diff2, <span class="at">group =</span> <span class="st">"climate stations"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(hrm_map) <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> group), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> group, <span class="at">label =</span> <span class="fu">str_trunc</span>(label, <span class="at">width =</span> <span class="dv">25</span>)),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">force =</span> <span class="fl">1.5</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Exploring the data from these stations a bit (not shown), Halifax Windsor Park seems a reasonable choice in terms of available data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(base_url,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"collections/climate-daily/items?f=json&amp;limit=10000&amp;STATION_NAME="</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">URLencode</span>(<span class="st">"HALIFAX WINDSOR PARK"</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>content_parsed <span class="ot">&lt;-</span> <span class="fu">content</span>(resp, <span class="at">as =</span> <span class="st">"parsed"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  content_parsed<span class="sc">$</span>features,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">discard</span>(.x<span class="sc">$</span>properties, is.null) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(daily_climate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,431
Columns: 29
$ station_name             &lt;chr&gt; "HALIFAX WINDSOR PARK", "HALIFAX WINDSOR PARK…
$ climate_identifier       &lt;chr&gt; "8202255", "8202255", "8202255", "8202255", "…
$ id                       &lt;chr&gt; "8202255.2021.2.11", "8202255.2021.2.12", "82…
$ local_date               &lt;chr&gt; "2021-02-11 00:00:00", "2021-02-12 00:00:00",…
$ province_code            &lt;chr&gt; "NS", "NS", "NS", "NS", "NS", "NS", "NS", "NS…
$ local_year               &lt;int&gt; 2021, 2021, 2021, 2021, 2021, 2018, 2018, 201…
$ local_month              &lt;int&gt; 2, 2, 2, 2, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …
$ local_day                &lt;int&gt; 11, 12, 13, 14, 15, 14, 15, 16, 17, 18, 19, 2…
$ mean_temperature         &lt;dbl&gt; -8.1, -8.1, -5.2, -5.0, -1.5, 10.8, 12.1, 9.0…
$ min_temperature          &lt;dbl&gt; -11.1, -13.0, -8.0, -8.9, -5.4, 5.0, 9.1, 5.4…
$ max_temperature          &lt;dbl&gt; -5.2, -3.2, -2.3, -1.2, 2.4, 16.5, 15.1, 12.5…
$ snow_on_ground           &lt;int&gt; 13, 12, 11, 11, 11, NA, NA, NA, NA, NA, NA, N…
$ direction_max_gust       &lt;int&gt; 26, 30, NA, NA, NA, 22, 21, 33, NA, NA, NA, 2…
$ speed_max_gust           &lt;int&gt; 42, 32, NA, NA, NA, 38, 48, 32, NA, NA, NA, 4…
$ cooling_degree_days      &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, …
$ heating_degree_days      &lt;dbl&gt; 26.1, 26.1, 23.2, 23.0, 19.5, 7.2, 5.9, 9.0, …
$ min_rel_humidity         &lt;int&gt; 39, 66, 52, 67, 40, 37, 68, 40, 38, 21, 30, 8…
$ max_rel_humidity         &lt;int&gt; 68, 87, 90, 90, 83, 90, 96, 87, 97, 89, 96, 9…
$ total_precipitation_flag &lt;chr&gt; NA, NA, NA, NA, "M", NA, NA, NA, NA, NA, NA, …
$ total_precipitation      &lt;dbl&gt; NA, NA, NA, NA, NA, 0.0, 0.6, 0.0, 0.0, 0.0, …
$ mean_temperature_flag    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ min_temperature_flag     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ max_temperature_flag     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ direction_max_gust_flag  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ speed_max_gust_flag      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ cooling_degree_days_flag &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ heating_degree_days_flag &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ min_rel_humidity_flag    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ max_rel_humidity_flag    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<section id="eda-and-cleaning-1" class="level3">
<h3 class="anchored" data-anchor-id="eda-and-cleaning-1">EDA and cleaning</h3>
<p>Variable summaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(daily_climate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">daily_climate</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">station_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">climate_identifier</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1431</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">local_date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1431</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">province_code</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_precipitation_flag</td>
<td style="text-align: right;">1098</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_temperature_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_temperature_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_temperature_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">direction_max_gust_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">speed_max_gust_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">cooling_degree_days_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">heating_degree_days_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_rel_humidity_flag</td>
<td style="text-align: right;">1412</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_rel_humidity_flag</td>
<td style="text-align: right;">1409</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">local_year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2019.83</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">2018.0</td>
<td style="text-align: right;">2019.0</td>
<td style="text-align: right;">2020.0</td>
<td style="text-align: right;">2021.00</td>
<td style="text-align: right;">2022.0</td>
<td style="text-align: left;">▅▇▇▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">local_month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.59</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: left;">▇▅▅▅▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">local_day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">15.85</td>
<td style="text-align: right;">8.76</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: right;">31.0</td>
<td style="text-align: left;">▇▇▇▇▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean_temperature</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">8.51</td>
<td style="text-align: right;">9.16</td>
<td style="text-align: right;">-13.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">16.30</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: left;">▂▆▇▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min_temperature</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">4.12</td>
<td style="text-align: right;">8.95</td>
<td style="text-align: right;">-17.3</td>
<td style="text-align: right;">-2.1</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">11.93</td>
<td style="text-align: right;">20.7</td>
<td style="text-align: left;">▂▅▇▆▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_temperature</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">12.90</td>
<td style="text-align: right;">9.66</td>
<td style="text-align: right;">-11.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">21.20</td>
<td style="text-align: right;">34.1</td>
<td style="text-align: left;">▂▇▇▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">snow_on_ground</td>
<td style="text-align: right;">1061</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">direction_max_gust</td>
<td style="text-align: right;">554</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">23.77</td>
<td style="text-align: right;">8.16</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">30.00</td>
<td style="text-align: right;">36.0</td>
<td style="text-align: left;">▂▃▅▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">speed_max_gust</td>
<td style="text-align: right;">554</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">42.48</td>
<td style="text-align: right;">10.34</td>
<td style="text-align: right;">31.0</td>
<td style="text-align: right;">35.0</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">47.00</td>
<td style="text-align: right;">96.0</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">cooling_degree_days</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">8.8</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">heating_degree_days</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">10.10</td>
<td style="text-align: right;">8.32</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">9.8</td>
<td style="text-align: right;">16.70</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: left;">▇▅▅▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_rel_humidity</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">56.63</td>
<td style="text-align: right;">18.72</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">42.0</td>
<td style="text-align: right;">56.0</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: left;">▂▇▇▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_rel_humidity</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">92.31</td>
<td style="text-align: right;">9.40</td>
<td style="text-align: right;">47.0</td>
<td style="text-align: right;">88.0</td>
<td style="text-align: right;">96.0</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: left;">▁▁▁▂▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_precipitation</td>
<td style="text-align: right;">554</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">4.16</td>
<td style="text-align: right;">9.75</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">102.4</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Drop some un-needed variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="ot">&lt;-</span> daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>station_name, <span class="sc">-</span>climate_identifier, <span class="sc">-</span>id, <span class="sc">-</span>province_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Process the date variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="ot">&lt;-</span> daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">report_date =</span> <span class="fu">as.POSIXct</span>(local_date) <span class="sc">%&gt;%</span> <span class="fu">as.Date</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Can drop these now</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>local_date, <span class="sc">-</span>local_year, <span class="sc">-</span>local_month, <span class="sc">-</span>local_day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There happens to be some missing days:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">report_date =</span> <span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">"2018-05-14"</span>), <span class="fu">as.Date</span>(<span class="st">"2022-04-22"</span>),</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">"days"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(daily_climate, <span class="at">by =</span> <span class="st">"report_date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(report_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2020-01-02" "2020-01-03" "2020-01-04" "2020-01-05" "2020-01-06"
 [6] "2021-01-03" "2021-01-04" "2021-01-05" "2021-01-06" "2021-01-07"
[11] "2022-01-03"</code></pre>
</div>
</div>
<p>Seems odd that all of the missing days are in January of different years.</p>
<p>There are also some missing temperature values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(mean_temperature) <span class="sc">|</span> <span class="fu">is.na</span>(min_temperature) <span class="sc">|</span> <span class="fu">is.na</span>(max_temperature)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(report_date, <span class="fu">contains</span>(<span class="st">"_temperature"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["report_date"],"name":[1],"type":["date"],"align":["right"]},{"label":["mean_temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["min_temperature"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max_temperature"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_temperature_flag"],"name":[5],"type":["chr"],"align":["left"]},{"label":["min_temperature_flag"],"name":[6],"type":["chr"],"align":["left"]},{"label":["max_temperature_flag"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"2018-06-04","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2018-11-21","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2018-11-25","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2019-03-15","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2019-07-24","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-01-01","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-01-07","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-02-11","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-05-14","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-09-02","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-09-03","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2020-09-23","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2021-01-08","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2022-02-16","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2022-02-15","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2021-08-10","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2022-01-06","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2022-01-04","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"},{"1":"2022-01-05","2":"NA","3":"NA","4":"NA","5":"M","6":"M","7":"M"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The <code>report_date</code>s range from 2018 to 2022. The flag values (<code>*_temperature_flag</code>) are all “M”, telling us what we already know: the data is missing.</p>
<p>For non-missing values, here is the trend over time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mean_temperature)) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> report_date)) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_temperature), <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>ruby_red)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>total_precipitation</code> values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(total_precipitation, total_precipitation_flag) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">is.na</span>(total_precipitation))) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["total_precipitation"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["total_precipitation_flag"],"name":[2],"type":["chr"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"NA","2":"M","3":"333"},{"1":"NA","2":"NA","3":"221"},{"1":"0.0","2":"NA","3":"472"},{"1":"0.2","2":"NA","3":"69"},{"1":"0.4","2":"NA","3":"26"},{"1":"0.6","2":"NA","3":"12"},{"1":"0.8","2":"NA","3":"9"},{"1":"1.0","2":"NA","3":"6"},{"1":"1.2","2":"NA","3":"6"},{"1":"1.4","2":"NA","3":"16"},{"1":"1.6","2":"NA","3":"9"},{"1":"1.8","2":"NA","3":"3"},{"1":"2.0","2":"NA","3":"7"},{"1":"2.2","2":"NA","3":"5"},{"1":"2.4","2":"NA","3":"7"},{"1":"2.6","2":"NA","3":"4"},{"1":"2.8","2":"NA","3":"5"},{"1":"3.0","2":"NA","3":"7"},{"1":"3.2","2":"NA","3":"5"},{"1":"3.4","2":"NA","3":"4"},{"1":"3.6","2":"NA","3":"7"},{"1":"3.8","2":"NA","3":"5"},{"1":"4.0","2":"NA","3":"6"},{"1":"4.2","2":"NA","3":"5"},{"1":"4.4","2":"NA","3":"4"},{"1":"4.8","2":"NA","3":"5"},{"1":"5.0","2":"NA","3":"2"},{"1":"5.2","2":"NA","3":"1"},{"1":"5.4","2":"NA","3":"2"},{"1":"5.6","2":"NA","3":"3"},{"1":"5.8","2":"NA","3":"3"},{"1":"6.0","2":"NA","3":"3"},{"1":"6.2","2":"NA","3":"1"},{"1":"6.4","2":"NA","3":"2"},{"1":"6.6","2":"NA","3":"4"},{"1":"6.8","2":"NA","3":"2"},{"1":"7.2","2":"NA","3":"3"},{"1":"7.4","2":"NA","3":"3"},{"1":"7.6","2":"NA","3":"4"},{"1":"7.8","2":"NA","3":"1"},{"1":"8.0","2":"NA","3":"4"},{"1":"8.4","2":"NA","3":"3"},{"1":"8.6","2":"NA","3":"3"},{"1":"8.8","2":"NA","3":"2"},{"1":"9.0","2":"NA","3":"1"},{"1":"9.8","2":"NA","3":"2"},{"1":"10.0","2":"NA","3":"4"},{"1":"10.4","2":"NA","3":"2"},{"1":"10.6","2":"NA","3":"3"},{"1":"10.8","2":"NA","3":"1"},{"1":"11.0","2":"NA","3":"1"},{"1":"11.2","2":"NA","3":"2"},{"1":"11.6","2":"NA","3":"3"},{"1":"11.8","2":"NA","3":"4"},{"1":"12.0","2":"NA","3":"2"},{"1":"12.2","2":"NA","3":"1"},{"1":"12.4","2":"NA","3":"1"},{"1":"12.6","2":"NA","3":"2"},{"1":"12.8","2":"NA","3":"2"},{"1":"13.0","2":"NA","3":"1"},{"1":"13.8","2":"NA","3":"1"},{"1":"14.0","2":"NA","3":"2"},{"1":"14.2","2":"NA","3":"1"},{"1":"14.6","2":"NA","3":"3"},{"1":"15.0","2":"NA","3":"1"},{"1":"15.4","2":"NA","3":"5"},{"1":"15.6","2":"NA","3":"2"},{"1":"15.8","2":"NA","3":"1"},{"1":"16.0","2":"NA","3":"3"},{"1":"17.4","2":"NA","3":"1"},{"1":"17.6","2":"NA","3":"2"},{"1":"17.8","2":"NA","3":"2"},{"1":"18.0","2":"NA","3":"1"},{"1":"18.4","2":"NA","3":"1"},{"1":"18.6","2":"NA","3":"1"},{"1":"18.8","2":"NA","3":"1"},{"1":"19.2","2":"NA","3":"1"},{"1":"19.4","2":"NA","3":"1"},{"1":"19.8","2":"NA","3":"2"},{"1":"20.0","2":"NA","3":"1"},{"1":"20.2","2":"NA","3":"1"},{"1":"20.4","2":"NA","3":"1"},{"1":"20.6","2":"NA","3":"2"},{"1":"21.2","2":"NA","3":"1"},{"1":"21.4","2":"NA","3":"1"},{"1":"21.6","2":"NA","3":"1"},{"1":"21.8","2":"NA","3":"1"},{"1":"23.0","2":"NA","3":"1"},{"1":"23.2","2":"NA","3":"1"},{"1":"23.4","2":"NA","3":"1"},{"1":"23.6","2":"NA","3":"2"},{"1":"24.4","2":"NA","3":"1"},{"1":"24.6","2":"NA","3":"1"},{"1":"24.8","2":"NA","3":"2"},{"1":"25.0","2":"NA","3":"1"},{"1":"25.4","2":"NA","3":"1"},{"1":"26.6","2":"NA","3":"1"},{"1":"26.8","2":"NA","3":"2"},{"1":"27.0","2":"NA","3":"3"},{"1":"27.2","2":"NA","3":"1"},{"1":"27.4","2":"NA","3":"2"},{"1":"27.8","2":"NA","3":"1"},{"1":"28.2","2":"NA","3":"1"},{"1":"29.2","2":"NA","3":"2"},{"1":"29.4","2":"NA","3":"2"},{"1":"29.6","2":"NA","3":"2"},{"1":"29.8","2":"NA","3":"2"},{"1":"30.0","2":"NA","3":"1"},{"1":"33.8","2":"NA","3":"1"},{"1":"34.0","2":"NA","3":"1"},{"1":"34.4","2":"NA","3":"1"},{"1":"35.0","2":"NA","3":"1"},{"1":"35.8","2":"NA","3":"1"},{"1":"37.0","2":"NA","3":"1"},{"1":"37.4","2":"NA","3":"1"},{"1":"39.6","2":"NA","3":"1"},{"1":"40.0","2":"NA","3":"1"},{"1":"40.8","2":"NA","3":"2"},{"1":"42.2","2":"NA","3":"1"},{"1":"44.6","2":"NA","3":"1"},{"1":"45.4","2":"NA","3":"1"},{"1":"46.2","2":"NA","3":"2"},{"1":"46.4","2":"NA","3":"1"},{"1":"48.2","2":"NA","3":"1"},{"1":"56.6","2":"NA","3":"1"},{"1":"59.2","2":"NA","3":"1"},{"1":"63.0","2":"NA","3":"1"},{"1":"70.2","2":"NA","3":"1"},{"1":"102.4","2":"NA","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are missing <code>total_precipitation</code> values with NA <code>total_precipitation_flag</code>, which makes me think that the flag variables are not going to be useful/reliable.</p>
<p>Visualize the non-missing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_precipitation)) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> report_date)) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_precipitation), <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>spanish_blue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>snow_on_ground</code> values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(snow_on_ground) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">is.na</span>(snow_on_ground))) <span class="sc">%&gt;%</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["snow_on_ground"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"NA","2":"1061"},{"1":"0","2":"100"},{"1":"1","2":"109"},{"1":"2","2":"59"},{"1":"3","2":"18"},{"1":"4","2":"9"},{"1":"5","2":"15"},{"1":"6","2":"5"},{"1":"7","2":"6"},{"1":"8","2":"3"},{"1":"9","2":"6"},{"1":"10","2":"12"},{"1":"11","2":"13"},{"1":"12","2":"4"},{"1":"13","2":"3"},{"1":"14","2":"1"},{"1":"16","2":"2"},{"1":"17","2":"1"},{"1":"19","2":"1"},{"1":"23","2":"1"},{"1":"24","2":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(snow_on_ground)) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> report_date)) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> snow_on_ground), <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>spanish_blue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>speed_max_gust</code> values (in km/h):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(speed_max_gust, speed_max_gust_flag) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">is.na</span>(speed_max_gust))) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["speed_max_gust"],"name":[1],"type":["int"],"align":["right"]},{"label":["speed_max_gust_flag"],"name":[2],"type":["chr"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"NA","2":"M","3":"19"},{"1":"NA","2":"NA","3":"535"},{"1":"31","2":"NA","3":"42"},{"1":"32","2":"NA","3":"58"},{"1":"33","2":"NA","3":"56"},{"1":"34","2":"NA","3":"63"},{"1":"35","2":"NA","3":"45"},{"1":"36","2":"NA","3":"52"},{"1":"37","2":"NA","3":"41"},{"1":"38","2":"NA","3":"38"},{"1":"39","2":"NA","3":"39"},{"1":"40","2":"NA","3":"33"},{"1":"41","2":"NA","3":"51"},{"1":"42","2":"NA","3":"30"},{"1":"43","2":"NA","3":"22"},{"1":"44","2":"NA","3":"29"},{"1":"45","2":"NA","3":"20"},{"1":"46","2":"NA","3":"15"},{"1":"47","2":"NA","3":"30"},{"1":"48","2":"NA","3":"16"},{"1":"49","2":"NA","3":"11"},{"1":"50","2":"NA","3":"13"},{"1":"51","2":"NA","3":"14"},{"1":"52","2":"NA","3":"11"},{"1":"53","2":"NA","3":"15"},{"1":"54","2":"NA","3":"15"},{"1":"55","2":"NA","3":"14"},{"1":"56","2":"NA","3":"10"},{"1":"57","2":"NA","3":"10"},{"1":"58","2":"NA","3":"4"},{"1":"59","2":"NA","3":"7"},{"1":"60","2":"NA","3":"6"},{"1":"61","2":"NA","3":"6"},{"1":"62","2":"NA","3":"7"},{"1":"63","2":"NA","3":"2"},{"1":"64","2":"NA","3":"11"},{"1":"65","2":"NA","3":"5"},{"1":"66","2":"NA","3":"6"},{"1":"67","2":"NA","3":"4"},{"1":"68","2":"NA","3":"5"},{"1":"69","2":"NA","3":"4"},{"1":"70","2":"NA","3":"3"},{"1":"71","2":"NA","3":"3"},{"1":"73","2":"NA","3":"2"},{"1":"74","2":"NA","3":"1"},{"1":"75","2":"NA","3":"1"},{"1":"76","2":"NA","3":"1"},{"1":"79","2":"NA","3":"1"},{"1":"80","2":"NA","3":"1"},{"1":"82","2":"NA","3":"1"},{"1":"83","2":"NA","3":"1"},{"1":"86","2":"NA","3":"1"},{"1":"96","2":"NA","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(speed_max_gust)) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> report_date)) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> speed_max_gust), <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>emerald)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="combining-the-data" class="level2">
<h2 class="anchored" data-anchor-id="combining-the-data">Combining the data</h2>
<p>Now I’ll combine the two data sets (joining on the date), only taking the most useful variables from the climate report (temperature, precipitation, wind speed, snow):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>bike_counts_climate <span class="ot">&lt;-</span> bike_data_daily_counts <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    daily_climate <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(report_date, mean_temperature, total_precipitation,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>             speed_max_gust, snow_on_ground),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"count_date"</span> <span class="ot">=</span> <span class="st">"report_date"</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike_counts_climate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,840
Columns: 9
$ site_name           &lt;chr&gt; "Dartmouth Harbourfront Greenway", "Dartmouth Harb…
$ installation_date   &lt;date&gt; 2021-07-08, 2021-07-08, 2021-07-08, 2021-07-08, 2…
$ count_date          &lt;date&gt; 2021-07-08, 2021-07-09, 2021-07-10, 2021-07-11, 2…
$ n_records           &lt;int&gt; 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48…
$ n_bikes             &lt;int&gt; 130, 54, 180, 245, 208, 250, 182, 106, 152, 257, 1…
$ mean_temperature    &lt;dbl&gt; 18.2, 17.6, 21.0, 21.0, 20.6, 18.6, 17.7, 20.2, 20…
$ total_precipitation &lt;dbl&gt; 0.6, 10.0, 0.4, 0.0, 0.0, 0.0, 0.0, 11.6, 0.2, 0.4…
$ speed_max_gust      &lt;int&gt; NA, 54, 56, NA, NA, NA, NA, 32, 37, NA, NA, NA, NA…
$ snow_on_ground      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<p>Visualize the missing climate data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>bike_counts_climate <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(count_date, mean_temperature, total_precipitation,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>           speed_max_gust, snow_on_ground) <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), is.na)) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>count_date) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Missing"</span>) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>indigo_blue, <span class="st">"gray80"</span>)) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Quite a bit of missing data, but we should have enough to make for an interesting analysis. Save the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bike_counts_climate, <span class="st">"bike-ridership-data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="../2022-04-29-predicting-bike-ridership-developing-a-model">my next post</a>, I will use this data to develop and evaluate various prediction models.</p>
</section>



<div id="quarto-appendix" class="default"><section id="reproducibility" class="level2 appendix unlisted"><h2 class="anchored quarto-appendix-heading">Reproducibility</h2><div class="quarto-appendix-contents">

<details>
<summary>
Session info
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> setting  value
 version  R version 4.2.1 (2022-06-23 ucrt)
 os       Windows 10 x64 (build 19044)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_Canada.utf8
 ctype    English_Canada.utf8
 tz       America/Curacao
 date     2022-10-27
 pandoc   2.18 @ C:/Program Files/RStudio/bin/quarto/bin/tools/ (via rmarkdown)</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["package"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ondiskversion"],"name":[2],"type":["chr"],"align":["left"]},{"label":["loadedversion"],"name":[3],"type":["chr"],"align":["left"]},{"label":["path"],"name":[4],"type":["chr"],"align":["left"]},{"label":["loadedpath"],"name":[5],"type":["chr"],"align":["left"]},{"label":["attached"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["is_base"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["date"],"name":[8],"type":["chr"],"align":["left"]},{"label":["source"],"name":[9],"type":["chr"],"align":["left"]},{"label":["md5ok"],"name":[10],"type":["lgl"],"align":["right"]},{"label":["library"],"name":[11],"type":["fct"],"align":["left"]}],"data":[{"1":"assertthat","2":"0.2.1","3":"0.2.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/assertthat","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/assertthat","6":"FALSE","7":"FALSE","8":"2019-03-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"assertthat"},{"1":"backports","2":"1.4.1","3":"1.4.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/backports","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/backports","6":"FALSE","7":"FALSE","8":"2021-12-13","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"backports"},{"1":"base64enc","2":"0.1.3","3":"0.1-3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/base64enc","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/base64enc","6":"FALSE","7":"FALSE","8":"2015-07-28","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"base64enc"},{"1":"bitops","2":"1.0.7","3":"1.0-7","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/bitops","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/bitops","6":"FALSE","7":"FALSE","8":"2021-04-24","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"bitops"},{"1":"broom","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/broom","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/broom/1.0.0/c948329889c7b24a4201df3aef5058c2/broom","6":"FALSE","7":"FALSE","8":"2022-07-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"broom"},{"1":"cachem","2":"1.0.6","3":"1.0.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cachem","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cachem","6":"FALSE","7":"FALSE","8":"2021-08-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cachem"},{"1":"callr","2":"3.7.1","3":"3.7.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/callr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/callr/3.7.1/2fda237f24bc56508f31394beaa56877/callr","6":"FALSE","7":"FALSE","8":"2022-07-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"callr"},{"1":"cellranger","2":"1.1.0","3":"1.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cellranger","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cellranger","6":"FALSE","7":"FALSE","8":"2016-07-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cellranger"},{"1":"checkmate","2":"2.1.0","3":"2.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/checkmate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/checkmate","6":"FALSE","7":"FALSE","8":"2022-04-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"checkmate"},{"1":"cli","2":"3.3.0","3":"3.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/cli","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cli","6":"FALSE","7":"FALSE","8":"2022-04-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cli"},{"1":"colorspace","2":"2.0.3","3":"2.0-3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/colorspace","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/colorspace","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"colorspace"},{"1":"crayon","2":"1.5.1","3":"1.5.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/crayon","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/crayon/1.5.1/8dc45fd8a1ee067a92b85ef274e66d6a/crayon","6":"FALSE","7":"FALSE","8":"2022-03-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"crayon"},{"1":"DBI","2":"1.1.3","3":"1.1.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DBI","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DBI","6":"FALSE","7":"FALSE","8":"2022-06-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"DBI"},{"1":"dbplyr","2":"2.2.1","3":"2.2.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dbplyr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dbplyr","6":"FALSE","7":"FALSE","8":"2022-06-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"dbplyr"},{"1":"devtools","2":"2.4.4","3":"2.4.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/devtools","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/devtools/2.4.4/d6ad91ae6533b84d227bb0b5262c111f/devtools","6":"FALSE","7":"FALSE","8":"2022-07-20","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"devtools"},{"1":"digest","2":"0.6.29","3":"0.6.30","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/digest","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/digest","6":"FALSE","7":"FALSE","8":"2021-12-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"digest"},{"1":"distill","2":"1.4","3":"1.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/distill","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/distill/1.4/a63cb71f49496a5595819f836f06fdcb/distill","6":"FALSE","7":"FALSE","8":"2022-05-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"distill"},{"1":"downlit","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/downlit","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/downlit","6":"FALSE","7":"FALSE","8":"2022-07-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"downlit"},{"1":"dplyr","2":"1.0.9","3":"1.0.9","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/dplyr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/dplyr/1.0.9/f0bda1627a7f5d3f9a0b5add931596ac/dplyr","6":"TRUE","7":"FALSE","8":"2022-04-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"dplyr"},{"1":"dunnr","2":"0.2.6","3":"0.2.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dunnr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dunnr","6":"TRUE","7":"FALSE","8":"2022-08-07","9":"Github (taylordunn/dunnr@e2a82136012b9edae43fc5f8e728492125366267)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"dunnr"},{"1":"ellipsis","2":"0.3.2","3":"0.3.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ellipsis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ellipsis","6":"FALSE","7":"FALSE","8":"2021-04-29","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ellipsis"},{"1":"evaluate","2":"0.15","3":"0.17","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/evaluate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/evaluate","6":"FALSE","7":"FALSE","8":"2022-02-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"evaluate"},{"1":"extrafont","2":"0.18","3":"0.18","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafont","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafont","6":"FALSE","7":"FALSE","8":"2022-04-12","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"extrafont"},{"1":"extrafontdb","2":"1.0","3":"1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafontdb","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafontdb","6":"FALSE","7":"FALSE","8":"2012-06-11","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"extrafontdb"},{"1":"fansi","2":"1.0.3","3":"1.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fansi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fansi","6":"FALSE","7":"FALSE","8":"2022-03-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fansi"},{"1":"farver","2":"2.1.1","3":"2.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/farver","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/farver","6":"FALSE","7":"FALSE","8":"2022-07-06","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"farver"},{"1":"fastmap","2":"1.1.0","3":"1.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fastmap","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fastmap","6":"FALSE","7":"FALSE","8":"2021-01-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fastmap"},{"1":"forcats","2":"0.5.1","3":"0.5.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/forcats","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/forcats/0.5.1/81c3244cab67468aac4c60550832655d/forcats","6":"TRUE","7":"FALSE","8":"2021-01-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"forcats"},{"1":"fs","2":"1.5.2","3":"1.5.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fs","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fs","6":"FALSE","7":"FALSE","8":"2021-12-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fs"},{"1":"gargle","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/gargle","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gargle/1.2.0/9d234e6a87a6f8181792de6dc4a00e39/gargle","6":"FALSE","7":"FALSE","8":"2021-07-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gargle"},{"1":"generics","2":"0.1.3","3":"0.1.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/generics","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/generics","6":"FALSE","7":"FALSE","8":"2022-07-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"generics"},{"1":"ggmap","2":"3.0.0","3":"3.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggmap","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggmap","6":"TRUE","7":"FALSE","8":"2019-02-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ggmap"},{"1":"ggplot2","2":"3.3.6","3":"3.3.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggplot2","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggplot2","6":"TRUE","7":"FALSE","8":"2022-05-03","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ggplot2"},{"1":"ggrepel","2":"0.9.1","3":"0.9.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggrepel","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggrepel","6":"FALSE","7":"FALSE","8":"2021-01-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ggrepel"},{"1":"glue","2":"1.6.2","3":"1.6.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/glue","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/glue","6":"TRUE","7":"FALSE","8":"2022-02-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"glue"},{"1":"googledrive","2":"2.0.0","3":"2.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/googledrive","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/googledrive","6":"FALSE","7":"FALSE","8":"2021-07-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"googledrive"},{"1":"googlesheets4","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/googlesheets4","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/googlesheets4/1.0.0/9a6564184dc4a81daea4f1d7ce357c6a/googlesheets4","6":"FALSE","7":"FALSE","8":"2021-07-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"googlesheets4"},{"1":"gt","2":"0.6.0","3":"0.6.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/gt","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gt/0.6.0/842059d3f71b14e812500b23eeea765e/gt","6":"TRUE","7":"FALSE","8":"2022-05-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gt"},{"1":"gtable","2":"0.3.0","3":"0.3.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/gtable","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gtable/0.3.0/ac5c6baf7822ce8732b343f14c072c4d/gtable","6":"FALSE","7":"FALSE","8":"2019-03-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gtable"},{"1":"haven","2":"2.5.0","3":"2.5.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/haven","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/haven/2.5.0/e3058e4ac77f4fa686f68a1838d5b715/haven","6":"FALSE","7":"FALSE","8":"2022-04-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"haven"},{"1":"highr","2":"0.9","3":"0.9","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/highr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/highr","6":"FALSE","7":"FALSE","8":"2021-04-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"highr"},{"1":"hms","2":"1.1.1","3":"1.1.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/hms","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/hms/1.1.1/5b8a2dd0fdbe2ab4f6081e6c7be6dfca/hms","6":"FALSE","7":"FALSE","8":"2021-09-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"hms"},{"1":"htmltools","2":"0.5.3","3":"0.5.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmltools","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmltools","6":"FALSE","7":"FALSE","8":"2022-07-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"htmltools"},{"1":"htmlwidgets","2":"1.5.4","3":"1.5.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmlwidgets","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmlwidgets","6":"FALSE","7":"FALSE","8":"2021-09-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"htmlwidgets"},{"1":"httpuv","2":"1.6.5","3":"1.6.5","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/httpuv","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/httpuv/1.6.5/97fe71f0a4a1c9890e6c2128afa04bc0/httpuv","6":"FALSE","7":"FALSE","8":"2022-01-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"httpuv"},{"1":"httr","2":"1.4.3","3":"1.4.3","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/httr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/httr/1.4.3/88d1b310583777edf01ccd1216fb0b2b/httr","6":"TRUE","7":"FALSE","8":"2022-05-04","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"httr"},{"1":"janitor","2":"2.1.0","3":"2.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/janitor","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/janitor","6":"FALSE","7":"FALSE","8":"2021-01-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"janitor"},{"1":"jpeg","2":"0.1.9","3":"0.1-9","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/jpeg","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/jpeg","6":"FALSE","7":"FALSE","8":"2021-07-24","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"jpeg"},{"1":"jsonlite","2":"1.8.0","3":"1.8.3","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/jsonlite","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/jsonlite","6":"FALSE","7":"FALSE","8":"2022-02-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"jsonlite"},{"1":"knitr","2":"1.39","3":"1.40","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/knitr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/knitr","6":"FALSE","7":"FALSE","8":"2022-04-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"knitr"},{"1":"labeling","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/labeling","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/labeling","6":"FALSE","7":"FALSE","8":"2020-10-20","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"labeling"},{"1":"later","2":"1.3.0","3":"1.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/later","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/later","6":"FALSE","7":"FALSE","8":"2021-08-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"later"},{"1":"lattice","2":"0.20.45","3":"0.20-45","4":"C:/Program Files/R/R-4.2.1/library/lattice","5":"C:/Program Files/R/R-4.2.1/library/lattice","6":"FALSE","7":"FALSE","8":"2021-09-22","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"lattice"},{"1":"lifecycle","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/lifecycle","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/lifecycle/1.0.1/a6b6d352e3ed897373ab19d8395c98d0/lifecycle","6":"FALSE","7":"FALSE","8":"2021-09-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"lifecycle"},{"1":"lubridate","2":"1.8.0","3":"1.8.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lubridate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lubridate","6":"TRUE","7":"FALSE","8":"2021-10-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"lubridate"},{"1":"magrittr","2":"2.0.3","3":"2.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/magrittr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/magrittr","6":"FALSE","7":"FALSE","8":"2022-03-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"magrittr"},{"1":"memoise","2":"2.0.1","3":"2.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/memoise","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/memoise","6":"FALSE","7":"FALSE","8":"2021-11-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"memoise"},{"1":"mime","2":"0.12","3":"0.12","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/mime","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/mime","6":"FALSE","7":"FALSE","8":"2021-09-28","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"mime"},{"1":"miniUI","2":"0.1.1.1","3":"0.1.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/miniUI","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/miniUI","6":"FALSE","7":"FALSE","8":"2018-05-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"miniUI"},{"1":"modelr","2":"0.1.8","3":"0.1.8","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/modelr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/modelr/0.1.8/9fd59716311ee82cba83dc2826fc5577/modelr","6":"FALSE","7":"FALSE","8":"2020-05-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"modelr"},{"1":"munsell","2":"0.5.0","3":"0.5.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/munsell","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/munsell","6":"FALSE","7":"FALSE","8":"2018-06-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"munsell"},{"1":"pillar","2":"1.8.0","3":"1.8.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/pillar","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/pillar/1.8.0/f95cf85794546c4ac2b9a6ca42e671ff/pillar","6":"FALSE","7":"FALSE","8":"2022-07-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"pillar"},{"1":"pkgbuild","2":"1.3.1","3":"1.3.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgbuild","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgbuild","6":"FALSE","7":"FALSE","8":"2021-12-20","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgbuild"},{"1":"pkgconfig","2":"2.0.3","3":"2.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgconfig","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgconfig","6":"FALSE","7":"FALSE","8":"2019-09-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgconfig"},{"1":"pkgload","2":"1.3.0","3":"1.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgload","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgload","6":"FALSE","7":"FALSE","8":"2022-06-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgload"},{"1":"plyr","2":"1.8.7","3":"1.8.7","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/plyr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/plyr","6":"FALSE","7":"FALSE","8":"2022-03-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"plyr"},{"1":"png","2":"0.1.7","3":"0.1-7","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/png","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/png","6":"FALSE","7":"FALSE","8":"2013-12-03","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"png"},{"1":"prettyunits","2":"1.1.1","3":"1.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prettyunits","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prettyunits","6":"FALSE","7":"FALSE","8":"2020-01-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"prettyunits"},{"1":"processx","2":"3.7.0","3":"3.7.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/processx","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/processx","6":"FALSE","7":"FALSE","8":"2022-07-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"processx"},{"1":"profvis","2":"0.3.7","3":"0.3.7","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/profvis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/profvis","6":"FALSE","7":"FALSE","8":"2020-11-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"profvis"},{"1":"promises","2":"1.2.0.1","3":"1.2.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/promises","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/promises","6":"FALSE","7":"FALSE","8":"2021-02-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"promises"},{"1":"ps","2":"1.7.1","3":"1.7.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ps","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ps","6":"FALSE","7":"FALSE","8":"2022-06-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ps"},{"1":"purrr","2":"0.3.4","3":"0.3.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/purrr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/purrr/0.3.4/97def703420c8ab10d8f0e6c72101e02/purrr","6":"TRUE","7":"FALSE","8":"2020-04-17","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"purrr"},{"1":"R6","2":"2.5.1","3":"2.5.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/R6","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/R6","6":"FALSE","7":"FALSE","8":"2021-08-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"R6"},{"1":"ragg","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/ragg","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/ragg/1.2.2/14932bb6f2739c771ca4ceaba6b4248e/ragg","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"ragg"},{"1":"RColorBrewer","2":"1.1.3","3":"1.1-3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/RColorBrewer","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/RColorBrewer","6":"FALSE","7":"FALSE","8":"2022-04-03","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"RColorBrewer"},{"1":"Rcpp","2":"1.0.9","3":"1.0.9","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rcpp","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rcpp","6":"FALSE","7":"FALSE","8":"2022-07-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"Rcpp"},{"1":"readr","2":"2.1.2","3":"2.1.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/readr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/readr/2.1.2/9c59de1357dc209868b5feb5c9f0fe2f/readr","6":"TRUE","7":"FALSE","8":"2022-01-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"readr"},{"1":"readxl","2":"1.4.0","3":"1.4.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/readxl","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/readxl/1.4.0/170c35f745563bb307e963bde0197e4f/readxl","6":"FALSE","7":"FALSE","8":"2022-03-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"readxl"},{"1":"remotes","2":"2.4.2","3":"2.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/remotes","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/remotes","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"remotes"},{"1":"renv","2":"0.15.5","3":"0.16.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/renv","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/renv","6":"FALSE","7":"FALSE","8":"2022-05-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"renv"},{"1":"repr","2":"1.1.4","3":"1.1.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/repr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/repr","6":"FALSE","7":"FALSE","8":"2022-01-04","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"repr"},{"1":"reprex","2":"2.0.1","3":"2.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/reprex","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/reprex/2.0.1/911d101becedc0fde495bd910984bdc8/reprex","6":"FALSE","7":"FALSE","8":"2021-08-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"reprex"},{"1":"RgoogleMaps","2":"1.4.5.3","3":"1.4.5.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/RgoogleMaps","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/RgoogleMaps","6":"FALSE","7":"FALSE","8":"2020-02-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"RgoogleMaps"},{"1":"rjson","2":"0.2.21","3":"0.2.21","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rjson","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rjson","6":"FALSE","7":"FALSE","8":"2022-01-09","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rjson"},{"1":"rlang","2":"1.0.4","3":"1.0.6","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/rlang","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rlang","6":"FALSE","7":"FALSE","8":"2022-07-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rlang"},{"1":"rmarkdown","2":"2.14","3":"2.17","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/rmarkdown","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rmarkdown","6":"FALSE","7":"FALSE","8":"2022-04-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rmarkdown"},{"1":"rstudioapi","2":"0.13","3":"0.14","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/rstudioapi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rstudioapi","6":"FALSE","7":"FALSE","8":"2020-11-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rstudioapi"},{"1":"Rttf2pt1","2":"1.3.8","3":"1.3.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rttf2pt1","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rttf2pt1","6":"FALSE","7":"FALSE","8":"2020-01-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"Rttf2pt1"},{"1":"rvest","2":"1.0.2","3":"1.0.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/rvest","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/rvest/1.0.2/bb099886deffecd6f9b298b7d4492943/rvest","6":"FALSE","7":"FALSE","8":"2021-10-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"rvest"},{"1":"sass","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sass","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sass","6":"FALSE","7":"FALSE","8":"2022-07-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"sass"},{"1":"scales","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/scales","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/scales/1.2.0/6e8750cdd13477aa440d453da93d5cac/scales","6":"FALSE","7":"FALSE","8":"2022-04-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"scales"},{"1":"sessioninfo","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sessioninfo","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sessioninfo","6":"FALSE","7":"FALSE","8":"2021-12-06","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"sessioninfo"},{"1":"shiny","2":"1.7.2","3":"1.7.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/shiny","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/shiny","6":"FALSE","7":"FALSE","8":"2022-07-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"shiny"},{"1":"skimr","2":"2.1.4","3":"2.1.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/skimr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/skimr","6":"FALSE","7":"FALSE","8":"2022-04-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"skimr"},{"1":"snakecase","2":"0.11.0","3":"0.11.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/snakecase","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/snakecase","6":"FALSE","7":"FALSE","8":"2019-05-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"snakecase"},{"1":"sp","2":"1.5.0","3":"1.5-0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sp","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sp","6":"FALSE","7":"FALSE","8":"2022-06-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"sp"},{"1":"stringi","2":"1.7.8","3":"1.7.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringi","6":"FALSE","7":"FALSE","8":"2022-07-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"stringi"},{"1":"stringr","2":"1.4.0","3":"1.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/stringr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringr","6":"TRUE","7":"FALSE","8":"2019-02-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"stringr"},{"1":"systemfonts","2":"1.0.4","3":"1.0.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/systemfonts","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/systemfonts","6":"FALSE","7":"FALSE","8":"2022-02-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"systemfonts"},{"1":"textshaping","2":"0.3.6","3":"0.3.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/textshaping","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/textshaping","6":"FALSE","7":"FALSE","8":"2021-10-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"textshaping"},{"1":"tibble","2":"3.1.8","3":"3.1.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tibble","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tibble","6":"TRUE","7":"FALSE","8":"2022-07-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tibble"},{"1":"tidyr","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/tidyr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tidyr/1.2.0/d8b95b7fee945d7da6888cf7eb71a49c/tidyr","6":"TRUE","7":"FALSE","8":"2022-02-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"tidyr"},{"1":"tidyselect","2":"1.1.2","3":"1.1.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/tidyselect","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tidyselect/1.1.2/17f6da8cfd7002760a859915ce7eef8f/tidyselect","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"tidyselect"},{"1":"tidyverse","2":"1.3.2","3":"1.3.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidyverse","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidyverse","6":"TRUE","7":"FALSE","8":"2022-07-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tidyverse"},{"1":"tzdb","2":"0.3.0","3":"0.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tzdb","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tzdb","6":"FALSE","7":"FALSE","8":"2022-03-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tzdb"},{"1":"urlchecker","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/urlchecker","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/urlchecker","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"urlchecker"},{"1":"usethis","2":"2.1.6","3":"2.1.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/usethis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/usethis","6":"FALSE","7":"FALSE","8":"2022-05-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"usethis"},{"1":"utf8","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/utf8","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/utf8","6":"FALSE","7":"FALSE","8":"2021-07-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"utf8"},{"1":"vctrs","2":"0.4.1","3":"0.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/vctrs","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/vctrs/0.4.1/8b54f22e2a58c4f275479c92ce041a57/vctrs","6":"FALSE","7":"FALSE","8":"2022-04-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"vctrs"},{"1":"withr","2":"2.5.0","3":"2.5.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/withr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/withr","6":"FALSE","7":"FALSE","8":"2022-03-03","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"withr"},{"1":"xfun","2":"0.31","3":"0.34","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/xfun","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xfun","6":"FALSE","7":"FALSE","8":"2022-05-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xfun"},{"1":"xml2","2":"1.3.3","3":"1.3.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xml2","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xml2","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xml2"},{"1":"xtable","2":"1.8.4","3":"1.8-4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xtable","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xtable","6":"FALSE","7":"FALSE","8":"2019-04-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xtable"},{"1":"yaml","2":"2.3.5","3":"2.3.6","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpsPILly/renv-library-2d90cf168d6/yaml","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/yaml","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"yaml"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</details>
<details>
<summary>
Git repository
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Local:    main C:/Users/tdunn/Documents/tdunn-quarto
Remote:   main @ origin (https://github.com/taylordunn/tdunn-quarto.git)
Head:     [4eb5bf2] 2022-10-26: Added font import to style sheet</code></pre>
</div>
</div>
</details>
<p><a href="https://github.com/taylordunn/tdunn-quarto/tree/main/posts/2022-04-27-predicting-bike-ridership-getting-the-data">Source code</a>, <a href="https://github.com/taylordunn/tdunn-quarto/tree/main/posts/2022-04-27-predicting-bike-ridership-getting-the-data/renv.lock">R environment</a></p>


</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Went through some trial and error to get the <code>get_googlemap()</code> function working here. In brief, I (1) downloaded the development version of <code>ggmap</code> from GitHub (<code>remotes::install_github("dkahle/ggmap")</code>) (2) created a new project on my Google Cloud Platform (GCP) account, (3) added an API key with access to the Google Static Maps API and registered it with <code>register_google()</code>, and (4) had to enable billing (because my free trial had been used).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>To build these API queries, I found <a href="https://api.weather.gc.ca/openapi?f=html#/">this documentation</a> to be very helpful.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{dunn2022,
  author = {Dunn, Taylor},
  title = {Predicting Bike Ridership: Getting the Data},
  date = {2022-04-27},
  url = {https://tdunn.ca/posts/2022-04-27-predicting-bike-ridership-getting-the-data/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-dunn2022" class="csl-entry quarto-appendix-citeas" role="listitem">
Dunn, Taylor. 2022. <span>“Predicting Bike Ridership: Getting the
Data.”</span> April 27, 2022. <a href="https://tdunn.ca/posts/2022-04-27-predicting-bike-ridership-getting-the-data/">https://tdunn.ca/posts/2022-04-27-predicting-bike-ridership-getting-the-data/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tdunn\.ca");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/taylordunn/tdunn-quarto/edit/main/posts/2022-04-27-predicting-bike-ridership-getting-the-data/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/taylordunn/tdunn-quarto/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>