<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taylor Dunn">
<meta name="dcterms.date" content="2022-04-29">
<meta name="description" content="Part 2 of predicting bike ridership in Halifax, Nova Scotia. In this post, I explore and tune different modeling approaches.">

<title>tdunn - Predicting bike ridership: developing a model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/td.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-196523553-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="tdunn - Predicting bike ridership: developing a model">
<meta property="og:description" content="Part 2 of predicting bike ridership in Halifax, Nova Scotia. In this post,
I explore and tune different modeling approaches.">
<meta property="og:image" content="https://tdunn.ca/posts\2022-04-29-predicting-bike-ridership-developing-a-model\preview.png">
<meta property="og:site-name" content="tdunn">
<meta property="og:image:height" content="1500">
<meta property="og:image:width" content="1800">
<meta name="twitter:title" content="tdunn - Predicting bike ridership: developing a model">
<meta name="twitter:description" content="Part 2 of predicting bike ridership in Halifax, Nova Scotia. In this post,
I explore and tune different modeling approaches.">
<meta name="twitter:image" content="https://tdunn.ca/posts\2022-04-29-predicting-bike-ridership-developing-a-model\preview.png">
<meta name="twitter:creator" content="@TDunn12">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="1500">
<meta name="twitter:image-width" content="1800">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tdunn</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/taylordunn"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/TDunn12"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/dunn-taylor/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Predicting bike ridership: developing a model</h1>
                  <div>
        <div class="description">
          <p>Part 2 of predicting bike ridership in Halifax, Nova Scotia. In this post, I explore and tune different modeling approaches.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">machine learning</div>
                <div class="quarto-category">tidymodels</div>
                <div class="quarto-category">random forest</div>
                <div class="quarto-category">XGBoost</div>
                <div class="quarto-category">support-vector machine</div>
                <div class="quarto-category">forecasting</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Taylor Dunn <a href="https://orcid.org/0000-0001-8042-1611" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 29, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory data analysis</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering">Feature engineering</a>
  <ul class="collapse">
  <li><a href="#temperature" id="toc-temperature" class="nav-link" data-scroll-target="#temperature">Temperature</a></li>
  <li><a href="#precipitation-and-snow" id="toc-precipitation-and-snow" class="nav-link" data-scroll-target="#precipitation-and-snow">Precipitation and snow</a></li>
  <li><a href="#wind-speed" id="toc-wind-speed" class="nav-link" data-scroll-target="#wind-speed">Wind speed</a></li>
  <li><a href="#lagged-counts" id="toc-lagged-counts" class="nav-link" data-scroll-target="#lagged-counts">Lagged counts</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#resampling-and-metrics" id="toc-resampling-and-metrics" class="nav-link" data-scroll-target="#resampling-and-metrics">Resampling and metrics</a></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized linear models</a></li>
  <li><a href="#tree-based-methods" id="toc-tree-based-methods" class="nav-link" data-scroll-target="#tree-based-methods">Tree-based methods</a></li>
  <li><a href="#support-vector-machines" id="toc-support-vector-machines" class="nav-link" data-scroll-target="#support-vector-machines">Support vector machines</a></li>
  </ul></li>
  <li><a href="#choosing-a-final-model" id="toc-choosing-a-final-model" class="nav-link" data-scroll-target="#choosing-a-final-model">Choosing a final model</a>
  <ul class="collapse">
  <li><a href="#exploring-the-predictions" id="toc-exploring-the-predictions" class="nav-link" data-scroll-target="#exploring-the-predictions">Exploring the predictions</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/taylordunn/tdunn-quarto/edit/main/posts/2022-04-29-predicting-bike-ridership-developing-a-model/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/taylordunn/tdunn-quarto/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<div class="cell">
<details>
<summary>R setup</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunnr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"win"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_td</span>())</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set_geom_fonts</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set_palette</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In <a href="../2022-04-27-predicting-bike-ridership-getting-the-data">my last post</a>, I retrieved, explored, and prepared bike counter data from Halifax, Nova Scotia. I also got some historical weather data to go along with it. Here, I will further explore the data, engineer some features, and fit and evaluate many models to predict bike ridership at different sites around the city.</p>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<p>Import the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"bike-ridership-data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike_ridership)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,840
Columns: 9
$ site_name           &lt;chr&gt; "Dartmouth Harbourfront Greenway", "Dartmouth Harb…
$ installation_date   &lt;date&gt; 2021-07-08, 2021-07-08, 2021-07-08, 2021-07-08, 2…
$ count_date          &lt;date&gt; 2021-07-08, 2021-07-09, 2021-07-10, 2021-07-11, 2…
$ n_records           &lt;int&gt; 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48…
$ n_bikes             &lt;int&gt; 130, 54, 180, 245, 208, 250, 182, 106, 152, 257, 1…
$ mean_temperature    &lt;dbl&gt; 18.2, 17.6, 21.0, 21.0, 20.6, 18.6, 17.7, 20.2, 20…
$ total_precipitation &lt;dbl&gt; 0.6, 10.0, 0.4, 0.0, 0.0, 0.0, 0.0, 11.6, 0.2, 0.4…
$ speed_max_gust      &lt;int&gt; NA, 54, 56, NA, NA, NA, NA, 32, 37, NA, NA, NA, NA…
$ snow_on_ground      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<p>This data consists of daily bike counts (<code>n_bikes</code>) over a 24 hour period (<code>count_date</code>) recorded at 5 sites (<code>site_name</code>) around the city. In the original data, counts are recorded every hour which is reflected by the <code>n_records</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(site_name, n_records) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="hgvawggvbt" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#hgvawggvbt) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#hgvawggvbt) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#hgvawggvbt) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#hgvawggvbt) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#hgvawggvbt) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#hgvawggvbt) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#hgvawggvbt) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#hgvawggvbt) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#hgvawggvbt) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#hgvawggvbt) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#hgvawggvbt) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#hgvawggvbt) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#hgvawggvbt) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hgvawggvbt) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#hgvawggvbt) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#hgvawggvbt) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hgvawggvbt) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#hgvawggvbt) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hgvawggvbt) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#hgvawggvbt) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hgvawggvbt) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#hgvawggvbt) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#hgvawggvbt) .gt_left {
  text-align: left;
}

:where(#hgvawggvbt) .gt_center {
  text-align: center;
}

:where(#hgvawggvbt) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#hgvawggvbt) .gt_font_normal {
  font-weight: normal;
}

:where(#hgvawggvbt) .gt_font_bold {
  font-weight: bold;
}

:where(#hgvawggvbt) .gt_font_italic {
  font-style: italic;
}

:where(#hgvawggvbt) .gt_super {
  font-size: 65%;
}

:where(#hgvawggvbt) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#hgvawggvbt) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#hgvawggvbt) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#hgvawggvbt) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#hgvawggvbt) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#hgvawggvbt) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">site_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n_records</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_right">48</td>
<td class="gt_row gt_right">291</td></tr>
    <tr><td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right">656</td></tr>
    <tr><td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_right">48</td>
<td class="gt_row gt_right">884</td></tr>
    <tr><td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_right">48</td>
<td class="gt_row gt_right">502</td></tr>
    <tr><td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_right">8</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_right">48</td>
<td class="gt_row gt_right">502</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><a href="../2022-04-27-predicting-bike-ridership-getting-the-data/#eda-and-cleaning">All except the Hollis St site have two channels</a> (northbound and southbound), which is why <code>n_records</code> = 48. The entries with fewer <code>n_records</code> reflect the time of day that the data was extracted:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_records <span class="sc">&lt;</span> <span class="dv">24</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(site_name, count_date, n_records) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="oiduylfgeq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#oiduylfgeq) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#oiduylfgeq) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#oiduylfgeq) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#oiduylfgeq) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#oiduylfgeq) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#oiduylfgeq) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#oiduylfgeq) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#oiduylfgeq) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#oiduylfgeq) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#oiduylfgeq) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#oiduylfgeq) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#oiduylfgeq) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#oiduylfgeq) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#oiduylfgeq) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#oiduylfgeq) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#oiduylfgeq) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#oiduylfgeq) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#oiduylfgeq) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#oiduylfgeq) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#oiduylfgeq) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#oiduylfgeq) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#oiduylfgeq) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#oiduylfgeq) .gt_left {
  text-align: left;
}

:where(#oiduylfgeq) .gt_center {
  text-align: center;
}

:where(#oiduylfgeq) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#oiduylfgeq) .gt_font_normal {
  font-weight: normal;
}

:where(#oiduylfgeq) .gt_font_bold {
  font-weight: bold;
}

:where(#oiduylfgeq) .gt_font_italic {
  font-style: italic;
}

:where(#oiduylfgeq) .gt_super {
  font-size: 65%;
}

:where(#oiduylfgeq) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#oiduylfgeq) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#oiduylfgeq) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#oiduylfgeq) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#oiduylfgeq) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#oiduylfgeq) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">site_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">count_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n_records</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_left">2022-04-25</td>
<td class="gt_row gt_right">8</td></tr>
    <tr><td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_left">2022-04-25</td>
<td class="gt_row gt_right">4</td></tr>
    <tr><td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_left">2022-04-25</td>
<td class="gt_row gt_right">8</td></tr>
    <tr><td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_left">2022-04-25</td>
<td class="gt_row gt_right">8</td></tr>
    <tr><td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_left">2022-04-25</td>
<td class="gt_row gt_right">8</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>For this analysis, I will exclude this incomplete day:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> bike_ridership <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n_records <span class="sc">&gt;</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The date ranges for each site:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_date =</span> <span class="fu">min</span>(count_date), <span class="at">max_date =</span> <span class="fu">max</span>(count_date),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_days =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">site_name =</span> <span class="fu">fct_reorder</span>(site_name, min_date),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_days_label =</span> <span class="fu">ifelse</span>(site_name <span class="sc">==</span> <span class="fu">levels</span>(site_name)[<span class="dv">1</span>],</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_c</span>(<span class="st">"n_days = "</span>, n_days), n_days),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint_date =</span> min_date <span class="sc">+</span> n_days <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> site_name, <span class="at">color =</span> site_name)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> min_date, <span class="at">xmax =</span> max_date)) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> min_date)) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_date)) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_days_label, <span class="at">x =</span> midpoint_date), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="sc">~</span> <span class="fu">str_wrap</span>(., <span class="at">width =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">"min_date -&gt; max_date"</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Before any more EDA, I’ll split the data into training and testing sets (and only look at the training data going forward). For time series data, there is the <code>rsample::initial_time_split()</code> function, which I’ll use to make a 70-30 split:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to order by time to properly use time split</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> bike_ridership <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(count_date, site_name)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>bike_split <span class="ot">&lt;-</span> <span class="fu">initial_time_split</span>(bike_ridership, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>bike_train <span class="ot">&lt;-</span> <span class="fu">training</span>(bike_split)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>bike_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(bike_split)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">train =</span> bike_train, <span class="at">test =</span> bike_test, <span class="at">.id =</span> <span class="st">"data_set"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_set, site_name) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_date =</span> <span class="fu">min</span>(count_date), <span class="at">max_date =</span> <span class="fu">max</span>(count_date),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_days =</span> <span class="fu">n</span>(), <span class="at">midpoint_date =</span> min_date <span class="sc">+</span> n_days <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(site_name, min_date), <span class="at">color =</span> data_set)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> min_date, <span class="at">xmax =</span> max_date),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> min_date), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_date), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n_days, <span class="at">x =</span> midpoint_date), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"date range"</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It might make more sense to stratify by <code>site_name</code> so that there is a 70-30 split in each site.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For now, I’m using a simpler approach to split into the first 70% and 30% of the data.</p>
<p>For each site, the distribution of daily <code>n_bikes</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n_bikes, <span class="at">fill =</span> site_name)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">str_trunc</span>(site_name, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The South Park St site appears bimodal, which <a href="../2022-04-27-predicting-bike-ridership-getting-the-data#eda-and-cleaning">I noted in part 1</a> was likely due to the addition of protected bike lanes in 2021. This can be seen more clearly in the trend over time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> n_bikes, <span class="at">color =</span> site_name)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>As you would expect for data in the same city, bike counters between sites are very highly correlated, which I can visualize:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(count_date, <span class="at">n_bikes1 =</span> n_bikes,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">site_name1 =</span> <span class="fu">factor</span>(<span class="fu">str_trunc</span>(site_name, <span class="dv">10</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., <span class="fu">rename</span>(., <span class="at">n_bikes2 =</span> n_bikes1, <span class="at">site_name2 =</span> site_name1),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"count_date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(site_name1) <span class="sc">&lt;</span> <span class="fu">as.numeric</span>(site_name2)) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n_bikes1, <span class="at">y =</span> n_bikes2)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> site_name1), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(site_name2 <span class="sc">~</span> site_name1) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The day of the week effect looks important:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_of_week =</span> lubridate<span class="sc">::</span><span class="fu">wday</span>(count_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day_of_week, <span class="at">y =</span> n_bikes)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> site_name), <span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">str_trunc</span>(site_name, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Another thing to consider is holidays. I can get Canadian holidays with the <code>timeDate</code> package (this is how <code>recipes::step_holiday()</code> works):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timeDate)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>canada_holidays <span class="ot">&lt;-</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  timeDate<span class="sc">::</span><span class="fu">listHolidays</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"^CA|^Christmas|^NewYears|Easter[Sun|Mon]|^GoodFriday|^CaRem"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>canada_holidays</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CACanadaDay"              "CACivicProvincialHoliday"
 [3] "CALabourDay"              "CaRemembranceDay"        
 [5] "CAThanksgivingDay"        "CAVictoriaDay"           
 [7] "ChristmasDay"             "ChristmasEve"            
 [9] "EasterMonday"             "EasterSunday"            
[11] "GoodFriday"               "NewYearsDay"             </code></pre>
</div>
</div>
<p>Then get the dates for each across the years in the bike data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>canada_holiday_dates <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">holiday =</span> canada_holidays) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">year =</span> <span class="dv">2019</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">holiday_date =</span> <span class="fu">map2</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      year, holiday,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">as.Date</span>(timeDate<span class="sc">::</span><span class="fu">holiday</span>(.x, .y)<span class="sc">@</span>Data)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(holiday_date)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>canada_holiday_dates <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(holiday, holiday_date) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["holiday"],"name":[1],"type":["chr"],"align":["left"]},{"label":["holiday_date"],"name":[2],"type":["date"],"align":["right"]}],"data":[{"1":"CACanadaDay","2":"2019-07-01"},{"1":"CACanadaDay","2":"2020-07-01"},{"1":"CACanadaDay","2":"2021-07-01"},{"1":"CACanadaDay","2":"2022-07-01"},{"1":"CACivicProvincialHoliday","2":"2019-08-05"},{"1":"CACivicProvincialHoliday","2":"2020-08-03"},{"1":"CACivicProvincialHoliday","2":"2021-08-02"},{"1":"CACivicProvincialHoliday","2":"2022-08-01"},{"1":"CALabourDay","2":"2019-09-02"},{"1":"CALabourDay","2":"2020-09-07"},{"1":"CALabourDay","2":"2021-09-06"},{"1":"CALabourDay","2":"2022-09-05"},{"1":"CaRemembranceDay","2":"2019-11-11"},{"1":"CaRemembranceDay","2":"2020-11-11"},{"1":"CaRemembranceDay","2":"2021-11-11"},{"1":"CaRemembranceDay","2":"2022-11-11"},{"1":"CAThanksgivingDay","2":"2019-10-14"},{"1":"CAThanksgivingDay","2":"2020-10-12"},{"1":"CAThanksgivingDay","2":"2021-10-11"},{"1":"CAThanksgivingDay","2":"2022-10-10"},{"1":"CAVictoriaDay","2":"2019-05-20"},{"1":"CAVictoriaDay","2":"2020-05-18"},{"1":"CAVictoriaDay","2":"2021-05-24"},{"1":"CAVictoriaDay","2":"2022-05-23"},{"1":"ChristmasDay","2":"2019-12-25"},{"1":"ChristmasDay","2":"2020-12-25"},{"1":"ChristmasDay","2":"2021-12-25"},{"1":"ChristmasDay","2":"2022-12-25"},{"1":"ChristmasEve","2":"2019-12-24"},{"1":"ChristmasEve","2":"2020-12-24"},{"1":"ChristmasEve","2":"2021-12-24"},{"1":"ChristmasEve","2":"2022-12-24"},{"1":"EasterMonday","2":"2019-04-22"},{"1":"EasterMonday","2":"2020-04-13"},{"1":"EasterMonday","2":"2021-04-05"},{"1":"EasterMonday","2":"2022-04-18"},{"1":"EasterSunday","2":"2019-04-21"},{"1":"EasterSunday","2":"2020-04-12"},{"1":"EasterSunday","2":"2021-04-04"},{"1":"EasterSunday","2":"2022-04-17"},{"1":"GoodFriday","2":"2019-04-19"},{"1":"GoodFriday","2":"2020-04-10"},{"1":"GoodFriday","2":"2021-04-02"},{"1":"GoodFriday","2":"2022-04-15"},{"1":"NewYearsDay","2":"2019-01-01"},{"1":"NewYearsDay","2":"2020-01-01"},{"1":"NewYearsDay","2":"2021-01-01"},{"1":"NewYearsDay","2":"2022-01-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Only day I can think is missing from this list is Family Day (Heritage Day in Nova Scotia) which is the third Monday in February. Visualize the effect of these holidays on bike ridership by plotting <code>n_bikes</code> in a 2 week window around the holidays (showing just the South Park St site for this plot):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>canada_holiday_dates <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(holiday_date <span class="sc">%in%</span> <span class="fu">unique</span>(bike_train<span class="sc">$</span>count_date)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_window =</span> <span class="fu">map</span>(holiday_date, <span class="sc">~</span> <span class="fu">seq.Date</span>(.x <span class="sc">-</span> <span class="dv">7</span>, .x <span class="sc">+</span> <span class="dv">7</span>, <span class="at">by =</span> <span class="st">"1 day"</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(date_window) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    bike_train, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"date_window"</span> <span class="ot">=</span> <span class="st">"count_date"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_holiday =</span> holiday_date <span class="sc">==</span> date_window) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(holiday) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_from_holiday =</span> <span class="fu">as.numeric</span>(holiday_date <span class="sc">-</span> date_window)) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site_name <span class="sc">==</span> <span class="st">"South Park St"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day_from_holiday, <span class="at">y =</span> n_bikes,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> holiday) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"year"</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The only holidays with a clear drop in ridership are Labour Day and the Civic Holiday (called Natal Day in NS) in 2021. Victoria Day seems to have the opposite effect. The Good Friday, Easter Sunday and Easter Monday holidays are obviously overlapping, and the <code>n_bikes</code> trend is a bit of a mess, but I can see an indication to the left of Good Friday that there may be a drop in ridership going into that weekend.</p>
<p>One thing to note is that the first, middle and last points correspond to the same day of the week, and the middle point in this set is usually lower than those two point, so holidays may be useful features in conjunction with day of the week.</p>
<p>The weather variables have varying levels of completeness:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate out the weather data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> bike_train <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(count_date, mean_temperature, total_precipitation,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>           speed_max_gust, snow_on_ground)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>weather_data <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), is.na)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>count_date) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Missing"</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>indigo_blue, <span class="st">"gray80"</span>)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>The distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>weather_data <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>count_date) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>For non-missing cases, plot the pairwise relationships:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>weather_data <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>count_date, <span class="at">names_to =</span> <span class="st">"var1"</span>, <span class="at">values_to =</span> <span class="st">"val1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var1 =</span> <span class="fu">factor</span>(var1)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., <span class="fu">rename</span>(., <span class="at">var2 =</span> var1, <span class="at">val2 =</span> val1),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"count_date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(val1), <span class="sc">!</span><span class="fu">is.na</span>(val2),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Use numeric factor labels to remove duplicates</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">as.numeric</span>(var1) <span class="sc">&lt;</span> <span class="fu">as.numeric</span>(var2)) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> val1, <span class="at">y =</span> val2, <span class="at">color =</span> var1)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(var2 <span class="sc">~</span> var1, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The clearest relationship to me is unsurprising: increasing <code>mean_temperature</code> is associated with decreasing <code>snow_on_ground</code> (top left plot).</p>
<p>Visualize relationships with <code>n_bikes</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(mean_temperature, total_precipitation,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>             speed_max_gust, snow_on_ground),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"var"</span>, <span class="at">values_to =</span> <span class="st">"val"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">y =</span> n_bikes)) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">str_trunc</span>(site_name, <span class="dv">15</span>)), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> var, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>All of the weather variables seem to be have a relationship with <code>n_bikes</code>. In terms of predictive value, <code>mean_temperature</code> looks like it might be the most useful, and <code>speed_max_gust</code> the least.</p>
</section>
<section id="feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="feature-engineering">Feature engineering</h2>
<p>From my EDA, I decided I want try including all 4 weather variables to predict bike ridership. This will require imputation of missing values for all 4, which I’ll attempt here.</p>
<p>Add some more time variables for working with the <code>weather_data</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>weather_data <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(count_date),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Day number relative to earliest date</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">count_day =</span> <span class="fu">as.numeric</span>(count_date <span class="sc">-</span> <span class="fu">min</span>(count_date)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Day of the year, from 1 to 365</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">count_yday =</span> lubridate<span class="sc">::</span><span class="fu">yday</span>(count_date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="temperature" class="level3">
<h3 class="anchored" data-anchor-id="temperature">Temperature</h3>
<p>The <code>mean_temperature</code> variable is missing 3% of values. Visualize the trend over time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mean_temperature)) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> mean_temperature)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(count_year))) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">"year"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="st">"date"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mean_temperature)) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_yday, <span class="at">y =</span> mean_temperature)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(count_year))) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="st">"year"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"day of year"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>, <span class="dv">180</span>, <span class="dv">270</span>, <span class="dv">365</span>)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The cyclic nature makes it a good candidate for smoothing splines. As a starting point, try a natural spline with 5 knots on the <code>count_yday</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lm_temperature <span class="ot">&lt;-</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mean_temperature <span class="sc">~</span> <span class="fu">ns</span>(count_yday, <span class="at">knots =</span> <span class="dv">5</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">filter</span>(weather_data, <span class="sc">!</span><span class="fu">is.na</span>(mean_temperature)))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">augment</span>(lm_temperature, <span class="at">newdata =</span> weather_data),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can obviously do a lot better, especially at the yearly boundaries. I’ll fit the data using a generalized additive model (GAM) with the <code>mgcv</code> package.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> For the <code>count_yday</code> variable (ranges from 1-365), I’ll make sure that there is no discontinuity between year by using a <em>cyclic</em> spline (<code>bs = "cc"</code>). I’ll also include a smoothing term of <code>count_day</code> which will capture the trend across years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>gam_temperature <span class="ot">&lt;-</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gam</span>(mean_temperature <span class="sc">~</span> <span class="fu">s</span>(count_yday, <span class="at">bs =</span> <span class="st">"cc"</span>, <span class="at">k =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">s</span>(count_day),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">filter</span>(weather_data, <span class="sc">!</span><span class="fu">is.na</span>(mean_temperature)))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gam_temperature, <span class="at">pages =</span> <span class="dv">1</span>, <span class="at">shade =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The left plot shows the seasonal trend within a year (note the lines would connect at <code>count_yday</code> = 1 and 365), and the right plot shows the increase in average temperature throughout time (across years) after accounting for the seasonal effect. Overlay the fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">augment</span>(gam_temperature, <span class="at">newdata =</span> weather_data),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I’m pretty happy with that. I’ll use predictions from this GAM to impute missing daily temperatures.</p>
</section>
<section id="precipitation-and-snow" class="level3">
<h3 class="anchored" data-anchor-id="precipitation-and-snow">Precipitation and snow</h3>
<p>The <code>total_precipitation</code> variable is missing 36% of values; 76% for <code>snow_on_ground</code>.</p>
<p>The <code>total_precipitation</code> distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_precipitation =</span> <span class="fu">replace_na</span>(total_precipitation, <span class="sc">-</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> total_precipitation)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"missing"</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>This pattern of missing data during winter months makes me think that the <code>total_precipitation</code> is actually total rainfall, i.e.&nbsp;snowfall is not counted. I’m going to impute the missing values with 0 during pre-processing, which is admittedly a poor approximation of the truth.</p>
<p>The <code>snow_on_ground</code> distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> weather_data <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">snow_on_ground =</span> <span class="fu">replace_na</span>(snow_on_ground, <span class="sc">-</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> snow_on_ground)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"missing"</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>I’ll also impute zero for missing <code>snow_on_ground</code>, which I’m a lot more confident doing here because most of the missing values occur during non-winter months. A more careful approach might involve imputing 0 during non-winter months that I’m certain would have no snow on the ground, then modeling the winter months with something like a zero-inflated Poisson model.</p>
</section>
<section id="wind-speed" class="level3">
<h3 class="anchored" data-anchor-id="wind-speed">Wind speed</h3>
<p>The <code>speed_max_gust</code> variable is the daily maximum wind speed in km/h, and has 41% missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mean_speed <span class="ot">&lt;-</span> <span class="fu">mean</span>(weather_data<span class="sc">$</span>speed_max_gust, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>weather_data <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">speed_max_gust =</span> <span class="fu">replace_na</span>(speed_max_gust, <span class="dv">20</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> speed_max_gust)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(speed_max_gust <span class="sc">&gt;</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(speed_max_gust <span class="sc">&gt;</span> <span class="dv">20</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>spanish_blue) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_speed,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>opera_mauve, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(speed_max_gust <span class="sc">==</span> <span class="dv">20</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(mean_speed, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"mean_speed"</span>, <span class="st">"missing"</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Relative to the noise, the time trends are pretty minor, and the missing data looks to be missing mostly at random. I’ll just impute using the mean speed.</p>
</section>
<section id="lagged-counts" class="level3">
<h3 class="anchored" data-anchor-id="lagged-counts">Lagged counts</h3>
<p>As a time series data set, it would be careless to not account for past data when predicting future data, so I’ll include lagged <code>n_bikes</code> values. Investigate the correlation in <code>n_bikes</code> for values lagged by 1, 2 and 3 days, and by 1 and 2 weeks (because they are the same day of the week):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bike_train_lag <span class="ot">&lt;-</span> bike_train <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(site_name, count_date) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bikes_lag_1 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">1</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bikes_lag_2 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">2</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bikes_lag_3 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">3</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bikes_lag_7 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">7</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bikes_lag_14 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">14</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>bike_train_lag <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(site_name, count_date, <span class="fu">starts_with</span>(<span class="st">"n_bikes"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"n_bikes_lag"</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"lag_days"</span>, <span class="at">values_to =</span> <span class="st">"n_bikes_lag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_bikes_lag)) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lag_days =</span> <span class="fu">str_extract</span>(lag_days, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name, lag_days) <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">corr_coef =</span> <span class="fu">cor</span>(n_bikes, n_bikes_lag)) <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n_bikes_lag, <span class="at">y =</span> n_bikes, <span class="at">color =</span> site_name)) <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(n_bikes_lag, site_name, corr_coef),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(corr_coef, <span class="dv">2</span>), <span class="at">x =</span> <span class="dv">500</span>, <span class="at">y =</span> <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">str_trunc</span>(site_name, <span class="dv">8</span>) <span class="sc">~</span> <span class="fu">factor</span>(lag_days)) <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The 7- and 14-day lagged values are correlated just as strongly (in some cases stronger) than the other options. This is great news because I only want to include a single lag variable, and using the 14th day lag means I can forecast 14 days ahead.</p>
<p>In order to use 14-day lag in a <code>tidymodels</code> workflow, I need to add it to the data myself. The <code>step_lag()</code> function won’t allow the outcome <code>n_bikes</code> to be lagged, because any new data won’t have an <code>n_bikes</code> variable to use. See <a href="https://www.tmwr.org/recipes.html#skip-equals-true">the warning in this section of the Tidy Modeling with R book</a>. Add the <code>n_bikes_lag_14</code> predictor, and exclude any values without it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_bikes_lag_14 =</span> <span class="fu">lag</span>(n_bikes, <span class="dv">14</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_bikes_lag_14))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While I’m at it, I’ll impute the missing <code>mean_temperature</code> values with the seasonal GAM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">count_day =</span> <span class="fu">as.numeric</span>(count_date <span class="sc">-</span> <span class="fu">min</span>(count_date)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count_yday =</span> lubridate<span class="sc">::</span><span class="fu">yday</span>(count_date),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pred =</span> <span class="fu">predict</span>(gam_temperature, <span class="at">newdata =</span> .)) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_temperature =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(mean_temperature), pred,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                              mean_temperature)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count_day, <span class="sc">-</span>count_yday, <span class="sc">-</span>pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This means I’ll have to re-split the data into training and testing (<code>initial_time_split()</code> isn’t random, so doesn’t require setting the seed):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="ot">&lt;-</span> bike_ridership <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(count_date, site_name)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>bike_split <span class="ot">&lt;-</span> <span class="fu">initial_time_split</span>(bike_ridership, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>bike_train <span class="ot">&lt;-</span> <span class="fu">training</span>(bike_split)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>bike_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(bike_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="modeling" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>Register parallel computing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(<span class="at">logical =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This extra step makes sure the parallel workers have access to the</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  `tidyr::replace_na()` function during pre-processing, which I use later on</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># See this issue: https://github.com/tidymodels/tune/issues/364</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"replace_na"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="resampling-and-metrics" class="level3">
<h3 class="anchored" data-anchor-id="resampling-and-metrics">Resampling and metrics</h3>
<p>For re-sampling, I will use <code>sliding_period()</code> to break up the data into 14 months of data (chosen to give 10 resamples) for analysis and 1 month for assessment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bike_resamples <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliding_period</span>(bike_train, <span class="at">index =</span> count_date,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">period =</span> <span class="st">"month"</span>, <span class="at">lookback =</span> <span class="dv">12</span>, <span class="at">assess_stop =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize the resamples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">analysis_set =</span> <span class="fu">map_dfr</span>(bike_resamples<span class="sc">$</span>splits, analysis, <span class="at">.id =</span> <span class="st">"i"</span>),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment_set =</span> <span class="fu">map_dfr</span>(bike_resamples<span class="sc">$</span>splits, assessment, <span class="at">.id =</span> <span class="st">"i"</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"data_set"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i, data_set) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_date =</span> <span class="fu">min</span>(count_date), <span class="at">max_date =</span> <span class="fu">max</span>(count_date),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_days =</span> <span class="fu">n</span>(), <span class="at">midpoint_date =</span> min_date <span class="sc">+</span> n_days <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">factor</span>(i), <span class="at">color =</span> data_set)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> min_date, <span class="at">xmax =</span> max_date),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> min_date), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_date), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"date range"</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>I’ll define a set of metrics to use here as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>bike_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rmse, rsq, mase, poisson_log_loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Poisson log loss is a new one to me, that was <a href="https://yardstick.tidymodels.org/news/index.html#yardstick-0-0-9-2021-11-22">recently added to <code>yardstick</code></a>. I’ll include it just for kicks, but I will choose my final model with <code>mase</code>, the mean absolute scaled error, which was introduced by Hyndman and Koehler <span class="citation" data-cites="Hyndman2006">(<a href="#ref-Hyndman2006" role="doc-biblioref">Hyndman and Koehler 2006</a>)</span>. The MASE involves dividing the absolute forecast error (<span class="math inline">\(|y_i - \hat{y}_i|\)</span>) by absolute <em>naive</em> forecast error (which involves predicting with the last observed value). The main advantage of this is that it is scale invariant. Mean absolute percentage error (MAPE) is the typical scale-invariant choice in regression problems, but the MASE avoids dividing by <code>n_bikes</code> = 0 (of which there are about 20 in this data set). It also has a straightforward interpretation: values greater than one indicate a worse forecast than the naive method, and values less indicate better.</p>
</section>
<section id="generalized-linear-models" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="generalized-linear-models">Generalized linear models</h3>
<p>The first models I will try are simple linear regression and Poisson regression, but I will test out a few different pre-processing/feature combinations. I would prefer to use negative binomial regression instead of Poisson to account for overdispersion (see aside), but <a href="https://github.com/tidymodels/parsnip/issues/35#issuecomment-1001088658">it hasn’t been implemented in <code>parsnip</code> yet</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">engine =</span> <span class="st">"lm"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg) <span class="co"># This wrapper package is required to use `poisson_reg()`</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>poisson_spec <span class="ot">&lt;-</span> <span class="fu">poisson_reg</span>(<span class="at">engine =</span> <span class="st">"glm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Over-dispersion in <code>n_bikes</code> (variance much higher than the mean):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>bike_train <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_name) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_n_bikes =</span> <span class="fu">mean</span>(n_bikes), <span class="at">var_n_bikes =</span> <span class="fu">var</span>(n_bikes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  site_name                       mean_n_bikes var_n_bikes
  &lt;chr&gt;                                  &lt;dbl&gt;       &lt;dbl&gt;
1 Dartmouth Harbourfront Greenway        145.        3121.
2 Hollis St                               77.0       2180.
3 South Park St                          174.       26594.
4 Vernon St                              212.       18080.
5 Windsor St                              96.3       3413.</code></pre>
</div>
</div>
</div></div><p>For my base pre-processing, I’ll include just <code>site_name</code> and <code>n_bikes_lag_14</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>glm_recipe <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> bike_train) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first extension of this recipe will include date variables. I’ll add day of week as categorical, day of year as numerical (and tune a natural spline function), year as numerical and Canadian holidays as categorical.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>glm_recipe_date <span class="ot">&lt;-</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> bike_train) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(count_date, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"dow"</span>, <span class="st">"doy"</span>, <span class="st">"year"</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">ordinal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(count_date_doy, <span class="at">deg_free =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_holiday</span>(count_date, <span class="at">holidays =</span> canada_holidays) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll consider the weather variables, with the imputations discussed in the <a href="#feature-engineering">feature engineering section</a>, separately:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>glm_recipe_weather <span class="ot">&lt;-</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14 <span class="sc">+</span> mean_temperature <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>           total_precipitation <span class="sc">+</span> speed_max_gust <span class="sc">+</span> snow_on_ground,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> bike_train) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(speed_max_gust) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Impute these missing values with zero</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate_at</span>(<span class="fu">c</span>(total_precipitation, snow_on_ground),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fn =</span> <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And lastly, all the features together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>glm_recipe_date_weather <span class="ot">&lt;-</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14 <span class="sc">+</span> mean_temperature <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>           total_precipitation <span class="sc">+</span> speed_max_gust <span class="sc">+</span> snow_on_ground,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> bike_train) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(count_date, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"dow"</span>, <span class="st">"doy"</span>, <span class="st">"year"</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">ordinal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(count_date_doy, <span class="at">deg_free =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_holiday</span>(count_date, <span class="at">holidays =</span> canada_holidays) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(speed_max_gust) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate_at</span>(<span class="fu">c</span>(total_precipitation, snow_on_ground),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fn =</span> <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Put these pre-processing recipes and the model specifications into a <code>workflow_set()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>glm_wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">base =</span> glm_recipe,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date =</span> glm_recipe_date, <span class="at">weather =</span> glm_recipe_weather,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date_weather =</span> glm_recipe_date_weather),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">linear_reg =</span> lm_spec, <span class="at">poisson_reg =</span> poisson_spec),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross =</span> <span class="cn">TRUE</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now fit the resamples using each combination of model specification and pre-processing recipe:</p>
<div class="cell" data-hash="index_cache/html/glm-wf-set-res_c70859fa838bcf2072962b6fc7b49e0c">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>glm_wf_set_res <span class="ot">&lt;-</span> <span class="fu">workflow_map</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  glm_wf_set,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tune_grid"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I'll try just a few `deg_free` in the spline term</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="fu">grid_regular</span>(<span class="fu">deg_free</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>)), <span class="at">levels =</span> <span class="dv">4</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> bike_resamples, <span class="at">metrics =</span> bike_metrics</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>35.38 sec elapsed</code></pre>
</div>
</div>
<p>For plotting the results this set of workflows, I’ll use a custom plotting function with <code>rank_results()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plot_wf_set_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(wf_set_res, <span class="at">rank_metric =</span> <span class="st">"mase"</span>) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(wf_set_res, <span class="at">rank_metric =</span> rank_metric) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">preproc =</span> <span class="fu">str_remove</span>(wflow_id, <span class="fu">paste0</span>(<span class="st">"_"</span>, model))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> mean, <span class="at">color =</span> model, <span class="at">shape =</span> preproc)) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> .metric, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_wf_set_metrics</span>(glm_wf_set_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>I’m using my own function because the <code>workflowsets::autoplot()</code> function doesn’t distinguish preprocessor recipes using the names provided to the <code>preproc</code> argument – everything just gets the name “recipe”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rank_results</span>(glm_wf_set_res) <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(wflow_id, model, preprocessor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  wflow_id                 preprocessor model      
  &lt;chr&gt;                    &lt;chr&gt;        &lt;chr&gt;      
1 date_weather_poisson_reg recipe       poisson_reg
2 date_weather_linear_reg  recipe       linear_reg 
3 weather_linear_reg       recipe       linear_reg 
4 date_linear_reg          recipe       linear_reg 
5 base_linear_reg          recipe       linear_reg 
6 date_poisson_reg         recipe       poisson_reg
7 weather_poisson_reg      recipe       poisson_reg
8 base_poisson_reg         recipe       poisson_reg</code></pre>
</div>
</div>
<p>My function extracts the recipe name from <code>wflow_id</code>.</p>
</div></div><p>Across the board, the model will all the features (date and weather predictors; indicated by the square symbols) are best, and Poisson regression slightly outperforms linear. Here are the models ranked by MASE:<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rank_results</span>(glm_wf_set_res, <span class="at">select_best =</span> <span class="cn">TRUE</span>, <span class="at">rank_metric =</span> <span class="st">"mase"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"mase"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, wflow_id, .config, <span class="at">mase =</span> mean, std_err) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(mase, std_err), <span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="rcwulkufdm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#rcwulkufdm) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#rcwulkufdm) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#rcwulkufdm) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#rcwulkufdm) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#rcwulkufdm) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#rcwulkufdm) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#rcwulkufdm) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#rcwulkufdm) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#rcwulkufdm) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#rcwulkufdm) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#rcwulkufdm) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#rcwulkufdm) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#rcwulkufdm) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rcwulkufdm) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#rcwulkufdm) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#rcwulkufdm) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rcwulkufdm) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#rcwulkufdm) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rcwulkufdm) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#rcwulkufdm) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rcwulkufdm) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#rcwulkufdm) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#rcwulkufdm) .gt_left {
  text-align: left;
}

:where(#rcwulkufdm) .gt_center {
  text-align: center;
}

:where(#rcwulkufdm) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#rcwulkufdm) .gt_font_normal {
  font-weight: normal;
}

:where(#rcwulkufdm) .gt_font_bold {
  font-weight: bold;
}

:where(#rcwulkufdm) .gt_font_italic {
  font-style: italic;
}

:where(#rcwulkufdm) .gt_super {
  font-size: 65%;
}

:where(#rcwulkufdm) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#rcwulkufdm) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#rcwulkufdm) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#rcwulkufdm) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#rcwulkufdm) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#rcwulkufdm) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">wflow_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.config</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std_err</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">date_weather_poisson_reg</td>
<td class="gt_row gt_left">Preprocessor3_Model1</td>
<td class="gt_row gt_right">0.547</td>
<td class="gt_row gt_right">0.056</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">date_weather_linear_reg</td>
<td class="gt_row gt_left">Preprocessor3_Model1</td>
<td class="gt_row gt_right">0.577</td>
<td class="gt_row gt_right">0.075</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">date_linear_reg</td>
<td class="gt_row gt_left">Preprocessor2_Model1</td>
<td class="gt_row gt_right">0.604</td>
<td class="gt_row gt_right">0.052</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_left">weather_linear_reg</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td>
<td class="gt_row gt_right">0.622</td>
<td class="gt_row gt_right">0.067</td></tr>
    <tr><td class="gt_row gt_right">5</td>
<td class="gt_row gt_left">date_poisson_reg</td>
<td class="gt_row gt_left">Preprocessor2_Model1</td>
<td class="gt_row gt_right">0.626</td>
<td class="gt_row gt_right">0.064</td></tr>
    <tr><td class="gt_row gt_right">6</td>
<td class="gt_row gt_left">base_linear_reg</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td>
<td class="gt_row gt_right">0.635</td>
<td class="gt_row gt_right">0.055</td></tr>
    <tr><td class="gt_row gt_right">7</td>
<td class="gt_row gt_left">weather_poisson_reg</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td>
<td class="gt_row gt_right">0.670</td>
<td class="gt_row gt_right">0.080</td></tr>
    <tr><td class="gt_row gt_right">8</td>
<td class="gt_row gt_left">base_poisson_reg</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td>
<td class="gt_row gt_right">0.760</td>
<td class="gt_row gt_right">0.055</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>So our best workflow has the id <code>date_weather_poisson_reg</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> with the <code>.config</code> “Preprocessor3_Model1” which refers to a specific spline degree from our tuning of the <code>count_date_doy</code> feature. I can check out the results of the tuning with <code>autoplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(glm_wf_set_res, <span class="at">id =</span> <span class="st">"date_weather_poisson_reg"</span>) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> .metric, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>The polynomial of degree 6 did best by MASE, which I’ll use to finalize the workflow and fit to the full training set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>glm_poisson_workflow <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(glm_wf_set_res, <span class="st">"date_weather_poisson_reg"</span>),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(glm_wf_set_res, <span class="st">"date_weather_poisson_reg"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mase"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>glm_poisson_fit <span class="ot">&lt;-</span> glm_poisson_workflow <span class="sc">%&gt;%</span> <span class="fu">fit</span>(bike_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="model-interpretation">Model interpretation</h4>
<p>An advantage of using a generalized linear model is that they are easy to interpret. A simple way to estimate variable important in a GLM is to look at the absolute value of the <span class="math inline">\(t\)</span>-statistic (<code>statistic</code> in the below table) – here are the top 5:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>poisson_coefs <span class="ot">&lt;-</span> <span class="fu">tidy</span>(glm_poisson_fit) <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(statistic))) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">signif</span>(estimate, <span class="dv">3</span>), <span class="at">std.error =</span> <span class="fu">signif</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">1</span>), <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(poisson_coefs, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="kbdrnywwos" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#kbdrnywwos) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#kbdrnywwos) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#kbdrnywwos) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#kbdrnywwos) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#kbdrnywwos) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#kbdrnywwos) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#kbdrnywwos) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#kbdrnywwos) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#kbdrnywwos) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#kbdrnywwos) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#kbdrnywwos) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#kbdrnywwos) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#kbdrnywwos) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#kbdrnywwos) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#kbdrnywwos) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#kbdrnywwos) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#kbdrnywwos) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#kbdrnywwos) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#kbdrnywwos) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#kbdrnywwos) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#kbdrnywwos) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#kbdrnywwos) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#kbdrnywwos) .gt_left {
  text-align: left;
}

:where(#kbdrnywwos) .gt_center {
  text-align: center;
}

:where(#kbdrnywwos) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#kbdrnywwos) .gt_font_normal {
  font-weight: normal;
}

:where(#kbdrnywwos) .gt_font_bold {
  font-weight: bold;
}

:where(#kbdrnywwos) .gt_font_italic {
  font-style: italic;
}

:where(#kbdrnywwos) .gt_super {
  font-size: 65%;
}

:where(#kbdrnywwos) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#kbdrnywwos) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#kbdrnywwos) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#kbdrnywwos) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#kbdrnywwos) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#kbdrnywwos) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">total_precipitation</td>
<td class="gt_row gt_right">-0.0384</td>
<td class="gt_row gt_right">-0.038</td>
<td class="gt_row gt_right">-84.6</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">site_name_South.Park.St</td>
<td class="gt_row gt_right">0.6890</td>
<td class="gt_row gt_right">0.690</td>
<td class="gt_row gt_right">68.6</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">site_name_Vernon.St</td>
<td class="gt_row gt_right">0.5490</td>
<td class="gt_row gt_right">0.550</td>
<td class="gt_row gt_right">57.8</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">mean_temperature</td>
<td class="gt_row gt_right">0.0365</td>
<td class="gt_row gt_right">0.036</td>
<td class="gt_row gt_right">53.3</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">n_bikes_lag_14</td>
<td class="gt_row gt_right">0.0010</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">48.2</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>A couple of the weather variables are among the most influential in predicting <code>n_bikes</code>. Here are all the weather coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>poisson_coefs <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">"temperature|precip|max_gust|snow"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="djkojfythf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#djkojfythf) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#djkojfythf) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#djkojfythf) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#djkojfythf) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#djkojfythf) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#djkojfythf) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#djkojfythf) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#djkojfythf) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#djkojfythf) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#djkojfythf) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#djkojfythf) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#djkojfythf) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#djkojfythf) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#djkojfythf) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#djkojfythf) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#djkojfythf) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#djkojfythf) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#djkojfythf) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#djkojfythf) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#djkojfythf) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#djkojfythf) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#djkojfythf) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#djkojfythf) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#djkojfythf) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#djkojfythf) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#djkojfythf) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#djkojfythf) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#djkojfythf) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#djkojfythf) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#djkojfythf) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#djkojfythf) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#djkojfythf) .gt_left {
  text-align: left;
}

:where(#djkojfythf) .gt_center {
  text-align: center;
}

:where(#djkojfythf) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#djkojfythf) .gt_font_normal {
  font-weight: normal;
}

:where(#djkojfythf) .gt_font_bold {
  font-weight: bold;
}

:where(#djkojfythf) .gt_font_italic {
  font-style: italic;
}

:where(#djkojfythf) .gt_super {
  font-size: 65%;
}

:where(#djkojfythf) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#djkojfythf) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#djkojfythf) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#djkojfythf) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#djkojfythf) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#djkojfythf) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">total_precipitation</td>
<td class="gt_row gt_right">-0.03840</td>
<td class="gt_row gt_right">-0.0380</td>
<td class="gt_row gt_right">-84.6</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">mean_temperature</td>
<td class="gt_row gt_right">0.03650</td>
<td class="gt_row gt_right">0.0360</td>
<td class="gt_row gt_right">53.3</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">snow_on_ground</td>
<td class="gt_row gt_right">-0.05360</td>
<td class="gt_row gt_right">-0.0540</td>
<td class="gt_row gt_right">-28.9</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">speed_max_gust</td>
<td class="gt_row gt_right">-0.00735</td>
<td class="gt_row gt_right">-0.0074</td>
<td class="gt_row gt_right">-19.6</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Since this is a Poisson model, the link function (non-linear relationship between the outcome and the predictors) is the logarithm:</p>
<p><span class="math display">\[
\begin{align}
\log{n}_{\text{bikes}} &amp;= \beta_0 + \beta_1 x_1 + \dots + \beta_p x_p \\
n_{\text{bikes}} &amp;= \text{exp}(\beta_0 + \beta_1 x_1 + \dots + \beta_p x_p) \\
&amp;= \text{exp}(\beta_0) \text{exp}(\beta_1 x_1) \dots \text{exp}(\beta_p x_p) \\
\end{align}
\]</span></p>
<p>So the coefficients are interpreted as: for every one unit increase in <span class="math inline">\(x_i\)</span>, the expected value of <span class="math inline">\(n_{\text{bikes}}\)</span> changes by multiplicative factor of <span class="math inline">\(\text{exp}(\beta_i)\)</span>, holding all other predictors constant. Here are some plain-language interpretations of the weather coefficients:</p>
<ul>
<li>For every 5°C increase in daily average temperature (<code>mean_temperature</code>), the expected value of <code>n_bikes</code> increases by 120%.</li>
<li>For every 10mm increase in daily rain (<code>total_precipitation</code>), the expected value of <code>n_bikes</code> decreases by 68%.</li>
<li>For every 10km/h increase in maximum wind speed (<code>speed_max_gust</code>), the expected value of <code>n_bikes</code> decreases by 93%.</li>
<li>For every 5cm of snow (<code>snow_on_ground</code>), the expected value of <code>n_bikes</code> decreases by 77%.</li>
</ul>
<p>A more thorough and formal analysis of these types of relationships should involve exploration of marginal effects (with a package like <code>marginaleffects</code> for example), but I’ll move on to other models.</p>
</section>
</section>
<section id="tree-based-methods" class="level3">
<h3 class="anchored" data-anchor-id="tree-based-methods">Tree-based methods</h3>
<p>For tree-based methods, I’ll use similar pre-processing as with GLM, except I won’t use a spline term (trees partition the feature space to capture non-linearity):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>trees_recipe <span class="ot">&lt;-</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14 <span class="sc">+</span> mean_temperature <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>           total_precipitation <span class="sc">+</span> speed_max_gust <span class="sc">+</span> snow_on_ground,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> bike_train) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(count_date, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"dow"</span>, <span class="st">"doy"</span>, <span class="st">"year"</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">ordinal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_holiday</span>(count_date, <span class="at">holidays =</span> canada_holidays) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(speed_max_gust) <span class="sc">%&gt;%</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate_at</span>(<span class="fu">c</span>(total_precipitation, snow_on_ground),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fn =</span> <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost requires dummy variables</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>trees_recipe_dummy <span class="ot">&lt;-</span> trees_recipe <span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll try a decision tree, a random forest, and an XGBoost model, each with hyperparameters indicated for tuning:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>decision_spec <span class="ot">&lt;-</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decision_tree</span>(<span class="at">cost_complexity =</span> <span class="fu">tune</span>(), <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(<span class="at">mtry =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Setting the `importance` parameter now lets me use `vip` later</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">importance =</span> <span class="st">"permutation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>xgb_spec <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>(),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth =</span> <span class="fu">tune</span>(), <span class="at">learn_rate =</span> <span class="fu">tune</span>()</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>trees_wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">trees_recipe =</span> trees_recipe,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trees_recipe =</span> trees_recipe,</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trees_recipe_dummy =</span> trees_recipe_dummy),</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">rf =</span> rf_spec, <span class="at">decision =</span> decision_spec, <span class="at">xgb =</span> xgb_spec),</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross =</span> <span class="cn">FALSE</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As a first pass, I’ll let <code>tune_grid()</code> choose 10 parameter combinations automatically for each model (<code>grid = 10</code>):</p>
<div class="cell" data-hash="index_cache/html/trees-wf-set-res_184e9b515b3bd69d3258cf1f1bb9f070">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">225</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>trees_wf_set_res <span class="ot">&lt;-</span> <span class="fu">workflow_map</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  trees_wf_set,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tune_grid"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="dv">10</span>, <span class="at">resamples =</span> bike_resamples, <span class="at">metrics =</span> bike_metrics,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>98.83 sec elapsed</code></pre>
</div>
</div>
<p>Visualize the performance of the 30 workflows, ranked by MASE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't need to use my custom function defined previously because I'm</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  not using functionally different recipes for each model</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trees_wf_set_res, <span class="at">rank_metric =</span> <span class="st">"mase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As I would have expected, the decision tree models generally perform worse than random forest models (which consist of multiple decision trees). The boosted tree models (which also consist of multiple decision trees, but differ in how they are built and combined) slightly outperform random forests, which is also expected.</p>
<p>For the three different tree-based model types, I’ll extract the best-performing workflows (by MASE) and fit to the full training set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>decision_workflow <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(trees_wf_set_res, <span class="st">"trees_recipe_decision"</span>),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(trees_wf_set_res, <span class="st">"trees_recipe_decision"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mase"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>rf_workflow <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(trees_wf_set_res, <span class="st">"trees_recipe_rf"</span>),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(trees_wf_set_res, <span class="st">"trees_recipe_rf"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mase"</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>xgb_workflow <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(trees_wf_set_res, <span class="st">"trees_recipe_dummy_xgb"</span>),</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(trees_wf_set_res, <span class="st">"trees_recipe_dummy_xgb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mase"</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>decision_fit <span class="ot">&lt;-</span> decision_workflow <span class="sc">%&gt;%</span> <span class="fu">fit</span>(bike_train)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>rf_fit <span class="ot">&lt;-</span> rf_workflow <span class="sc">%&gt;%</span> <span class="fu">fit</span>(bike_train)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>xgb_fit <span class="ot">&lt;-</span> xgb_workflow <span class="sc">%&gt;%</span> <span class="fu">fit</span>(bike_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-interpretation-1" class="level4">
<h4 class="anchored" data-anchor-id="model-interpretation-1">Model interpretation</h4>
<p>Decision trees are the easiest of the three to interpret, but this decision tree is quite complicated. It has 44 leaf nodes (i.e.&nbsp;terminal nodes) with a depth of 6. The visualization (done with the <code>rpart.plot</code> package) is messy and hidden below:</p>
<details>
<summary>
Decision tree plot
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_fit_engine</span>(decision_fit) <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Using some options to try and make the tree more readable</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fallen.leaves =</span> <span class="cn">FALSE</span>, <span class="at">roundint =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tweak =</span> <span class="dv">5</span>, <span class="at">type =</span> <span class="dv">0</span>, <span class="at">faclen =</span> <span class="dv">10</span>, <span class="at">clip.facs =</span> <span class="cn">TRUE</span>, <span class="at">compress =</span> <span class="cn">FALSE</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</details>
<p>The nodes at the top of the tree are a good indicator of feature importance. Here, that was <code>n_bikes_lag_14</code>, followed by <code>mean_temperature</code> and <code>total_precipitation</code>.</p>
<p>To quantify the contribution of each feature in a tree-based model, we can calculate variable importance with the <code>vip</code> package. Plot the top 5 variables for all 3 models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">extract_fit_engine</span>(decision_fit) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>(<span class="at">num_features =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Decision tree"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">extract_fit_engine</span>(rf_fit) <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>(<span class="at">num_features =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Random forest"</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">extract_fit_engine</span>(xgb_fit) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>(<span class="at">num_features =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"XGBoost"</span>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see that <code>n_bikes_lag_14</code>, <code>mean_temperature</code>, and <code>site_name</code> are important with all three models. Measures of time within (<code>count_date_doy</code>) and across (<code>count_date_year</code>) years are also important.</p>
</section>
<section id="xgboost-tuning" class="level4">
<h4 class="anchored" data-anchor-id="xgboost-tuning">XGBoost tuning</h4>
<p>So far, I’ve only considered 10 candidate sets of hyperparameters for tuning each tree-based model. Let’s try 100 with XGBoost:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of predictors so I can set max number of predictors in `mtry()`</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>bike_train_baked <span class="ot">&lt;-</span> <span class="fu">prep</span>(trees_recipe_dummy) <span class="sc">%&gt;%</span> <span class="fu">bake</span>(bike_train)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># `grid_latin_hypercube()` is a space-filling parameter grid design that will</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  efficiently cover the parameter space for me</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>xgb_grid <span class="ot">&lt;-</span> <span class="fu">grid_latin_hypercube</span>(</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize</span>(<span class="fu">mtry</span>(), <span class="fu">select</span>(bike_train_baked, <span class="sc">-</span>n_bikes)),</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trees</span>(), <span class="fu">min_n</span>(), <span class="fu">tree_depth</span>(), <span class="fu">learn_rate</span>(),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">100</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>xgb_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 5
    mtry trees min_n tree_depth learn_rate
   &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;int&gt;      &lt;dbl&gt;
 1    14   300    20          8   4.27e- 4
 2    30  1560     5         12   2.17e- 5
 3    22  1723    30          2   1.37e- 2
 4     2   268    21          2   6.42e-10
 5     7   780    15         12   1.09e- 5
 6    24   642    24          2   7.51e- 5
 7     3  1066    36          3   8.06e- 9
 8    13   725     4          6   1.94e- 2
 9    18   574    40          9   5.55e- 7
10    27  1988    38         13   7.08e- 9
# … with 90 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>We have just one model and one preprocessor now, so put it into a single <code>workflow</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>xgb_workflow_2 <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(trees_recipe_dummy) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(xgb_spec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And tune:</p>
<div class="cell" data-hash="index_cache/html/bike-xgb-tune_48451c06cefa7d67a36808cc64187eb3">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2081</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>xgb_tune <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  xgb_workflow_2, <span class="at">resamples =</span> bike_resamples,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> xgb_grid, <span class="at">metrics =</span> bike_metrics</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>475.8 sec elapsed</code></pre>
</div>
</div>
<p>Here are the metrics for the different candidate models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(xgb_tune)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finalize the workflow with the best hyperparameters and fit the full training set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>xgb_workflow_2 <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  xgb_workflow_2, <span class="fu">select_best</span>(xgb_tune, <span class="at">metric =</span> <span class="st">"mase"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>xgb_fit_2 <span class="ot">&lt;-</span> xgb_workflow_2 <span class="sc">%&gt;%</span> <span class="fu">fit</span>(bike_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="support-vector-machines" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machines">Support vector machines</h3>
<p>Lastly, I will try some support vector machine regressions with linear, polynomial and radial basis function (RBF) kernels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New recipe for the SVMs which require a `step_normalize()`</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>svm_recipe <span class="ot">&lt;-</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    n_bikes <span class="sc">~</span> count_date <span class="sc">+</span> site_name <span class="sc">+</span> n_bikes_lag_14 <span class="sc">+</span> mean_temperature <span class="sc">+</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      total_precipitation <span class="sc">+</span> speed_max_gust <span class="sc">+</span> snow_on_ground,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> bike_train, </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(count_date, <span class="at">new_role =</span> <span class="st">"date_variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(count_date, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"dow"</span>, <span class="st">"doy"</span>, <span class="st">"year"</span>),</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">ordinal =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_holiday</span>(count_date, <span class="at">holidays =</span> canada_holidays) <span class="sc">%&gt;%</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(speed_max_gust) <span class="sc">%&gt;%</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate_at</span>(<span class="fu">c</span>(total_precipitation, snow_on_ground),</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fn =</span> <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>())</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>svm_linear_spec <span class="ot">&lt;-</span> <span class="fu">svm_linear</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">margin =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>svm_poly_spec <span class="ot">&lt;-</span> <span class="fu">svm_poly</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">margin =</span> <span class="fu">tune</span>(),</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scale_factor =</span> <span class="fu">tune</span>(), <span class="at">degree =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>svm_rbf_spec <span class="ot">&lt;-</span>  <span class="fu">svm_rbf</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">rbf_sigma =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>svm_wf_set <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(svm_recipe),</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(<span class="at">linear =</span> svm_linear_spec, <span class="at">poly =</span> svm_poly_spec,</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">rbf =</span> svm_rbf_spec)</span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/svm-wf-set-res_5c20a53c45b56c1fad1996121bbbfecb">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4217</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>svm_wf_set_res <span class="ot">&lt;-</span> <span class="fu">workflow_map</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  svm_wf_set,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tune_grid"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> <span class="dv">10</span>, <span class="at">resamples =</span> bike_resamples, <span class="at">metrics =</span> bike_metrics</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(svm_wf_set_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Those are some pretty interesting (and smooth) trends. The best model is one of the <code>svm_rbf</code> candidates (though the next 10 are the <code>svm_linear</code> models). Finalize the workflows and fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>svm_linear_wf_res <span class="ot">&lt;-</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(svm_wf_set_res, <span class="st">"recipe_linear"</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>svm_linear_wf <span class="ot">&lt;-</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extract_workflow</span>(svm_wf_set, <span class="st">"recipe_linear"</span>),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(svm_linear_wf_res, <span class="st">"mase"</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>svm_linear_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(svm_linear_wf, bike_train)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>svm_poly_wf_res <span class="ot">&lt;-</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(svm_wf_set_res, <span class="st">"recipe_poly"</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>svm_poly_wf <span class="ot">&lt;-</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extract_workflow</span>(svm_wf_set, <span class="st">"recipe_poly"</span>),</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(svm_poly_wf_res, <span class="st">"mase"</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>svm_poly_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(svm_poly_wf, bike_train)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>svm_rbf_wf_res <span class="ot">&lt;-</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(svm_wf_set_res, <span class="st">"recipe_rbf"</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>svm_rbf_wf <span class="ot">&lt;-</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extract_workflow</span>(svm_wf_set, <span class="st">"recipe_rbf"</span>),</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_best</span>(svm_rbf_wf_res, <span class="st">"mase"</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>svm_rbf_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(svm_rbf_wf, bike_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="choosing-a-final-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="choosing-a-final-model">Choosing a final model</h2>
<p>I’ll choose a model by the best cross-validated MASE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(glm_wf_set_res, <span class="at">rank_metric =</span> <span class="st">"mase"</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only include the full pre-processing recipe</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(wflow_id, <span class="st">"date_weather"</span>)),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(trees_wf_set_res, <span class="at">rank_metric =</span> <span class="st">"mase"</span>, <span class="at">select_best =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(svm_wf_set_res, <span class="at">rank_metric =</span> <span class="st">"mase"</span>, <span class="at">select_best =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_best</span>(xgb_tune, <span class="at">metric =</span> <span class="st">"mase"</span>, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"boost_tree_2"</span>)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"mase"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model, <span class="at">mase =</span> mean, std_err) <span class="sc">%&gt;%</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mase) <span class="sc">%&gt;%</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="fu">c</span>(mase, std_err), <span class="at">decimals =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="wbxhmqklhu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#wbxhmqklhu) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#wbxhmqklhu) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#wbxhmqklhu) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#wbxhmqklhu) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#wbxhmqklhu) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#wbxhmqklhu) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#wbxhmqklhu) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#wbxhmqklhu) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#wbxhmqklhu) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#wbxhmqklhu) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#wbxhmqklhu) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#wbxhmqklhu) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#wbxhmqklhu) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wbxhmqklhu) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#wbxhmqklhu) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#wbxhmqklhu) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wbxhmqklhu) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#wbxhmqklhu) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wbxhmqklhu) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#wbxhmqklhu) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wbxhmqklhu) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wbxhmqklhu) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wbxhmqklhu) .gt_left {
  text-align: left;
}

:where(#wbxhmqklhu) .gt_center {
  text-align: center;
}

:where(#wbxhmqklhu) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#wbxhmqklhu) .gt_font_normal {
  font-weight: normal;
}

:where(#wbxhmqklhu) .gt_font_bold {
  font-weight: bold;
}

:where(#wbxhmqklhu) .gt_font_italic {
  font-style: italic;
}

:where(#wbxhmqklhu) .gt_super {
  font-size: 65%;
}

:where(#wbxhmqklhu) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#wbxhmqklhu) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#wbxhmqklhu) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#wbxhmqklhu) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#wbxhmqklhu) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#wbxhmqklhu) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std_err</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">boost_tree_2</td>
<td class="gt_row gt_right">0.4913</td>
<td class="gt_row gt_right">0.0503</td></tr>
    <tr><td class="gt_row gt_left">boost_tree</td>
<td class="gt_row gt_right">0.4933</td>
<td class="gt_row gt_right">0.0545</td></tr>
    <tr><td class="gt_row gt_left">rand_forest</td>
<td class="gt_row gt_right">0.5099</td>
<td class="gt_row gt_right">0.0566</td></tr>
    <tr><td class="gt_row gt_left">svm_rbf</td>
<td class="gt_row gt_right">0.5420</td>
<td class="gt_row gt_right">0.0440</td></tr>
    <tr><td class="gt_row gt_left">poisson_reg</td>
<td class="gt_row gt_right">0.5471</td>
<td class="gt_row gt_right">0.0563</td></tr>
    <tr><td class="gt_row gt_left">decision_tree</td>
<td class="gt_row gt_right">0.5481</td>
<td class="gt_row gt_right">0.0500</td></tr>
    <tr><td class="gt_row gt_left">svm_linear</td>
<td class="gt_row gt_right">0.5608</td>
<td class="gt_row gt_right">0.0478</td></tr>
    <tr><td class="gt_row gt_left">linear_reg</td>
<td class="gt_row gt_right">0.5775</td>
<td class="gt_row gt_right">0.0754</td></tr>
    <tr><td class="gt_row gt_left">svm_poly</td>
<td class="gt_row gt_right">0.6253</td>
<td class="gt_row gt_right">0.0410</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>XGBoost takes the top two spots, with <code>boost_tree_2</code> (the more thorough tuning) being the slight winner. Perform a <code>last_fit()</code> and get the performance on the held-out test set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>xgb_final_fit <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  xgb_workflow_2, <span class="at">split =</span> bike_split, <span class="at">metrics =</span> bike_metrics</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(xgb_final_fit) <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="mdfisbbvvs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#mdfisbbvvs) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#mdfisbbvvs) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#mdfisbbvvs) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#mdfisbbvvs) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#mdfisbbvvs) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#mdfisbbvvs) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#mdfisbbvvs) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#mdfisbbvvs) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#mdfisbbvvs) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#mdfisbbvvs) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#mdfisbbvvs) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#mdfisbbvvs) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#mdfisbbvvs) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#mdfisbbvvs) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#mdfisbbvvs) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#mdfisbbvvs) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#mdfisbbvvs) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#mdfisbbvvs) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#mdfisbbvvs) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#mdfisbbvvs) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#mdfisbbvvs) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#mdfisbbvvs) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#mdfisbbvvs) .gt_left {
  text-align: left;
}

:where(#mdfisbbvvs) .gt_center {
  text-align: center;
}

:where(#mdfisbbvvs) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#mdfisbbvvs) .gt_font_normal {
  font-weight: normal;
}

:where(#mdfisbbvvs) .gt_font_bold {
  font-weight: bold;
}

:where(#mdfisbbvvs) .gt_font_italic {
  font-style: italic;
}

:where(#mdfisbbvvs) .gt_super {
  font-size: 65%;
}

:where(#mdfisbbvvs) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#mdfisbbvvs) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#mdfisbbvvs) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#mdfisbbvvs) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#mdfisbbvvs) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#mdfisbbvvs) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.metric</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.estimator</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.config</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">rmse</td>
<td class="gt_row gt_left">standard</td>
<td class="gt_row gt_right">44.2385659</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td></tr>
    <tr><td class="gt_row gt_left">rsq</td>
<td class="gt_row gt_left">standard</td>
<td class="gt_row gt_right">0.5415386</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td></tr>
    <tr><td class="gt_row gt_left">mase</td>
<td class="gt_row gt_left">standard</td>
<td class="gt_row gt_right">0.7406183</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td></tr>
    <tr><td class="gt_row gt_left">poisson_log_loss</td>
<td class="gt_row gt_left">standard</td>
<td class="gt_row gt_right">NaN</td>
<td class="gt_row gt_left">Preprocessor1_Model1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>There’s a bit of a drop-off in performance from the training metrics. Let’s dig into the predictions.</p>
<section id="exploring-the-predictions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="exploring-the-predictions">Exploring the predictions</h3>
<p>Plot the relationship between actual <code>n_bikes</code> and predicted:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>xgb_final_preds <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train =</span> <span class="fu">augment</span>(<span class="fu">extract_workflow</span>(xgb_final_fit), bike_train),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">augment</span>(<span class="fu">extract_workflow</span>(xgb_final_fit), bike_test),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"data_set"</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data_set =</span> <span class="fu">fct_inorder</span>(data_set))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>xgb_final_preds <span class="sc">%&gt;%</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n_bikes, <span class="at">y =</span> .pred)) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>emerald) <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> data_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>And here are the predictions overlaid on the data (vertical line delineates training and testing sets):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> xgb_final_preds <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count_date)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_bikes, <span class="at">color =</span> site_name), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(bike_test<span class="sc">$</span>count_date), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site_name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>()</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Truncate the dates to look closer at the testing set performance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2021-07-01"</span>, <span class="st">"2022-05-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This looks okay to my eye, though it does look to be overfitting the training set. It’s a shame to not have more data to test a full year – most of the test set covers winter and spring.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>To investigate the model performance further, I’ll plot the biggest outliers in the training and testing set (and ±1 week on either side):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>worst_preds <span class="ot">&lt;-</span> xgb_final_preds <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abs_error =</span> <span class="fu">abs</span>(n_bikes <span class="sc">-</span> .pred)) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_set, site_name) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(abs_error, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data_set, site_name, count_date, n_bikes, .pred, abs_error)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>site_colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(td_colors<span class="sc">$</span>pastel6[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="fu">unique</span>(worst_preds<span class="sc">$</span>site_name))</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>worst_preds <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data_set, site_name, count_date) <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">worst_date =</span> count_date,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">count_date =</span> <span class="fu">map</span>(count_date, <span class="sc">~</span> <span class="fu">seq.Date</span>(.x <span class="sc">-</span> <span class="dv">7</span>, .x <span class="sc">+</span> <span class="dv">7</span>, <span class="at">by =</span> <span class="st">"day"</span>))</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(count_date) <span class="sc">%&gt;%</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(xgb_final_preds,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"data_set"</span>, <span class="st">"site_name"</span>, <span class="st">"count_date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_bikes)) <span class="sc">%&gt;%</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site_name =</span> <span class="fu">fct_inorder</span>(site_name)) <span class="sc">%&gt;%</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>site_name) <span class="sc">%&gt;%</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> count_date)) <span class="sc">+</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_bikes, <span class="at">color =</span> site_name)) <span class="sc">+</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> worst_date), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> data_set, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>      dunnr<span class="sc">::</span><span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_colors) <span class="sc">+</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(.<span class="sc">$</span>worst_date)) <span class="sc">+</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">subtitle =</span> .<span class="sc">$</span>site_name[[<span class="dv">1</span>]])</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Relative to the noise in the data, that doesn’t look too bad. The Vernon St site has a series of <code>n_bikes</code> = 0 in a row that I’m guessing aren’t real (see aside). It was probably an issue with the counter, or maybe some construction on the street halting traffic for that period.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The Vernon St site has 6 dates with <code>n_bikes = 0</code> all in a row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site_name <span class="sc">==</span> <span class="st">"Vernon St"</span>, n_bikes <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(count_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-11-13" "2021-11-14" "2021-11-15" "2021-11-16" "2021-11-17"
[6] "2021-11-18"</code></pre>
</div>
</div>
</div></div><p>I also think some of the poor predictions can be explained by missing data. For instance, there are some poor predictions around 2021-11-23, where the model is over-estimating <code>n_bikes</code> at a few sites. Check out the weather around that day:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>bike_ridership <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count_date <span class="sc">&gt;</span> <span class="st">"2021-11-20"</span>, count_date <span class="sc">&lt;</span> <span class="st">"2021-11-26"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(count_date, mean_temperature, total_precipitation,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>           speed_max_gust, snow_on_ground) <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="wpjfhbthuj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#wpjfhbthuj) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#wpjfhbthuj) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#wpjfhbthuj) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#wpjfhbthuj) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#wpjfhbthuj) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#wpjfhbthuj) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#wpjfhbthuj) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#wpjfhbthuj) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#wpjfhbthuj) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#wpjfhbthuj) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#wpjfhbthuj) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#wpjfhbthuj) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#wpjfhbthuj) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wpjfhbthuj) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#wpjfhbthuj) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#wpjfhbthuj) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wpjfhbthuj) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#wpjfhbthuj) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wpjfhbthuj) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#wpjfhbthuj) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wpjfhbthuj) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#wpjfhbthuj) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#wpjfhbthuj) .gt_left {
  text-align: left;
}

:where(#wpjfhbthuj) .gt_center {
  text-align: center;
}

:where(#wpjfhbthuj) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#wpjfhbthuj) .gt_font_normal {
  font-weight: normal;
}

:where(#wpjfhbthuj) .gt_font_bold {
  font-weight: bold;
}

:where(#wpjfhbthuj) .gt_font_italic {
  font-style: italic;
}

:where(#wpjfhbthuj) .gt_super {
  font-size: 65%;
}

:where(#wpjfhbthuj) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#wpjfhbthuj) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#wpjfhbthuj) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#wpjfhbthuj) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#wpjfhbthuj) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#wpjfhbthuj) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">count_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_temperature</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">total_precipitation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">speed_max_gust</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">snow_on_ground</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">2021-11-21</td>
<td class="gt_row gt_right">3.2</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_left">2021-11-22</td>
<td class="gt_row gt_right">11.1</td>
<td class="gt_row gt_right">42.2</td>
<td class="gt_row gt_right">57</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_left">2021-11-23</td>
<td class="gt_row gt_right">6.1</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">41</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">2021-11-24</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">43</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left">2021-11-25</td>
<td class="gt_row gt_right">3.7</td>
<td class="gt_row gt_right">NA</td>
<td class="gt_row gt_right">43</td>
<td class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This happens to be around the time of <a href="https://globalnews.ca/news/8395034/ns-storm-closures-2021/">a huge rain and wind storm in Nova Scotia</a> that knocked out power for a lot of people. This is seen in the <code>total_precipitation</code> on 2021-11-22, but the next day is missing data so, in my pre-processing, it was imputed as 0, which is definitely a poor approximation of the truth. If I impute a large amount of rain (let’s say 15mm) for that date, here is how the predictions change:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(xgb_final_fit),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  xgb_final_preds <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(count_date <span class="sc">==</span> <span class="st">"2021-11-23"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">.pred_old =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total_precipitation =</span> <span class="dv">15</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(site_name, n_bikes, .pred_old, <span class="at">.pred_new =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ssqigteqqk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#ssqigteqqk) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#ssqigteqqk) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#ssqigteqqk) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#ssqigteqqk) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#ssqigteqqk) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#ssqigteqqk) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#ssqigteqqk) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#ssqigteqqk) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#ssqigteqqk) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#ssqigteqqk) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#ssqigteqqk) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#ssqigteqqk) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#ssqigteqqk) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ssqigteqqk) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#ssqigteqqk) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#ssqigteqqk) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ssqigteqqk) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#ssqigteqqk) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ssqigteqqk) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#ssqigteqqk) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ssqigteqqk) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ssqigteqqk) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ssqigteqqk) .gt_left {
  text-align: left;
}

:where(#ssqigteqqk) .gt_center {
  text-align: center;
}

:where(#ssqigteqqk) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#ssqigteqqk) .gt_font_normal {
  font-weight: normal;
}

:where(#ssqigteqqk) .gt_font_bold {
  font-weight: bold;
}

:where(#ssqigteqqk) .gt_font_italic {
  font-style: italic;
}

:where(#ssqigteqqk) .gt_super {
  font-size: 65%;
}

:where(#ssqigteqqk) .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

:where(#ssqigteqqk) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#ssqigteqqk) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#ssqigteqqk) .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

:where(#ssqigteqqk) .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

:where(#ssqigteqqk) .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">site_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n_bikes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.pred_old</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.pred_new</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Dartmouth Harbourfront Greenway</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">122.19430</td>
<td class="gt_row gt_right">40.232090</td></tr>
    <tr><td class="gt_row gt_left">Hollis St</td>
<td class="gt_row gt_right">19</td>
<td class="gt_row gt_right">79.22559</td>
<td class="gt_row gt_right">6.992786</td></tr>
    <tr><td class="gt_row gt_left">South Park St</td>
<td class="gt_row gt_right">59</td>
<td class="gt_row gt_right">320.20889</td>
<td class="gt_row gt_right">165.825897</td></tr>
    <tr><td class="gt_row gt_left">Vernon St</td>
<td class="gt_row gt_right">133</td>
<td class="gt_row gt_right">165.12285</td>
<td class="gt_row gt_right">77.777298</td></tr>
    <tr><td class="gt_row gt_left">Windsor St</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">91.21191</td>
<td class="gt_row gt_right">12.152815</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>That is a much better prediction for a rainy and windy day.</p>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>In the end, the XGBoost model was able to best predict daily bike ridership.</p>
<p>Is this model useful to anyone? Maybe. Is it useful just sitting on my computer? Definitely not. So in <a href="../2022-05-19-predicting-bike-ridership-deploying-the-model/">my next post</a>, I’ll put this model into production.</p>
</section>



<div id="quarto-appendix" class="default"><section id="reproducibility" class="level2 appendix unlisted"><h2 class="quarto-appendix-heading">Reproducibility</h2><div class="quarto-appendix-contents">

<details>
<summary>
Session info
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> setting  value
 version  R version 4.2.1 (2022-06-23 ucrt)
 os       Windows 10 x64 (build 19044)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_Canada.utf8
 ctype    English_Canada.utf8
 tz       America/Curacao
 date     2022-10-27
 pandoc   2.18 @ C:/Program Files/RStudio/bin/quarto/bin/tools/ (via rmarkdown)</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["package"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ondiskversion"],"name":[2],"type":["chr"],"align":["left"]},{"label":["loadedversion"],"name":[3],"type":["chr"],"align":["left"]},{"label":["path"],"name":[4],"type":["chr"],"align":["left"]},{"label":["loadedpath"],"name":[5],"type":["chr"],"align":["left"]},{"label":["attached"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["is_base"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["date"],"name":[8],"type":["chr"],"align":["left"]},{"label":["source"],"name":[9],"type":["chr"],"align":["left"]},{"label":["md5ok"],"name":[10],"type":["lgl"],"align":["right"]},{"label":["library"],"name":[11],"type":["fct"],"align":["left"]}],"data":[{"1":"assertthat","2":"0.2.1","3":"0.2.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/assertthat","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/assertthat","6":"FALSE","7":"FALSE","8":"2019-03-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"assertthat"},{"1":"backports","2":"1.4.1","3":"1.4.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/backports","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/backports","6":"FALSE","7":"FALSE","8":"2021-12-13","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"backports"},{"1":"broom","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/broom","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/broom/1.0.0/c948329889c7b24a4201df3aef5058c2/broom","6":"TRUE","7":"FALSE","8":"2022-07-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"broom"},{"1":"cachem","2":"1.0.6","3":"1.0.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cachem","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cachem","6":"FALSE","7":"FALSE","8":"2021-08-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cachem"},{"1":"callr","2":"3.7.1","3":"3.7.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/callr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/callr/3.7.1/2fda237f24bc56508f31394beaa56877/callr","6":"FALSE","7":"FALSE","8":"2022-07-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"callr"},{"1":"cellranger","2":"1.1.0","3":"1.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cellranger","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cellranger","6":"FALSE","7":"FALSE","8":"2016-07-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cellranger"},{"1":"checkmate","2":"2.1.0","3":"2.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/checkmate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/checkmate","6":"FALSE","7":"FALSE","8":"2022-04-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"checkmate"},{"1":"class","2":"7.3.20","3":"7.3-20","4":"C:/Program Files/R/R-4.2.1/library/class","5":"C:/Program Files/R/R-4.2.1/library/class","6":"FALSE","7":"FALSE","8":"2022-01-16","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"class"},{"1":"cli","2":"3.3.0","3":"3.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/cli","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/cli","6":"FALSE","7":"FALSE","8":"2022-04-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"cli"},{"1":"codetools","2":"0.2.18","3":"0.2-18","4":"C:/Program Files/R/R-4.2.1/library/codetools","5":"C:/Program Files/R/R-4.2.1/library/codetools","6":"FALSE","7":"FALSE","8":"2020-11-04","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"codetools"},{"1":"colorspace","2":"2.0.3","3":"2.0-3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/colorspace","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/colorspace","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"colorspace"},{"1":"crayon","2":"1.5.1","3":"1.5.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/crayon","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/crayon/1.5.1/8dc45fd8a1ee067a92b85ef274e66d6a/crayon","6":"FALSE","7":"FALSE","8":"2022-03-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"crayon"},{"1":"data.table","2":"1.14.2","3":"1.14.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/data.table","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/data.table/1.14.2/36b67b5adf57b292923f5659f5f0c853/data.table","6":"FALSE","7":"FALSE","8":"2021-09-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"data.table"},{"1":"DBI","2":"1.1.3","3":"1.1.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DBI","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DBI","6":"FALSE","7":"FALSE","8":"2022-06-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"DBI"},{"1":"dbplyr","2":"2.2.1","3":"2.2.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dbplyr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dbplyr","6":"FALSE","7":"FALSE","8":"2022-06-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"dbplyr"},{"1":"devtools","2":"2.4.4","3":"2.4.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/devtools","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/devtools/2.4.4/d6ad91ae6533b84d227bb0b5262c111f/devtools","6":"FALSE","7":"FALSE","8":"2022-07-20","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"devtools"},{"1":"dials","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dials","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dials","6":"TRUE","7":"FALSE","8":"2022-06-14","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"dials"},{"1":"DiceDesign","2":"1.9","3":"1.9","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DiceDesign","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/DiceDesign","6":"FALSE","7":"FALSE","8":"2021-02-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"DiceDesign"},{"1":"digest","2":"0.6.29","3":"0.6.30","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/digest","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/digest","6":"FALSE","7":"FALSE","8":"2021-12-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"digest"},{"1":"distill","2":"1.4","3":"1.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/distill","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/distill/1.4/a63cb71f49496a5595819f836f06fdcb/distill","6":"FALSE","7":"FALSE","8":"2022-05-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"distill"},{"1":"doParallel","2":"1.0.17","3":"1.0.17","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/doParallel","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/doParallel","6":"TRUE","7":"FALSE","8":"2022-02-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"doParallel"},{"1":"downlit","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/downlit","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/downlit","6":"FALSE","7":"FALSE","8":"2022-07-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"downlit"},{"1":"dplyr","2":"1.0.9","3":"1.0.9","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/dplyr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/dplyr/1.0.9/f0bda1627a7f5d3f9a0b5add931596ac/dplyr","6":"TRUE","7":"FALSE","8":"2022-04-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"dplyr"},{"1":"dunnr","2":"0.2.6","3":"0.2.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dunnr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/dunnr","6":"TRUE","7":"FALSE","8":"2022-08-07","9":"Github (taylordunn/dunnr@e2a82136012b9edae43fc5f8e728492125366267)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"dunnr"},{"1":"ellipsis","2":"0.3.2","3":"0.3.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ellipsis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ellipsis","6":"FALSE","7":"FALSE","8":"2021-04-29","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ellipsis"},{"1":"evaluate","2":"0.15","3":"0.17","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/evaluate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/evaluate","6":"FALSE","7":"FALSE","8":"2022-02-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"evaluate"},{"1":"extrafont","2":"0.18","3":"0.18","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafont","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafont","6":"FALSE","7":"FALSE","8":"2022-04-12","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"extrafont"},{"1":"extrafontdb","2":"1.0","3":"1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafontdb","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/extrafontdb","6":"FALSE","7":"FALSE","8":"2012-06-11","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"extrafontdb"},{"1":"fansi","2":"1.0.3","3":"1.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fansi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fansi","6":"FALSE","7":"FALSE","8":"2022-03-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fansi"},{"1":"farver","2":"2.1.1","3":"2.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/farver","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/farver","6":"FALSE","7":"FALSE","8":"2022-07-06","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"farver"},{"1":"fastmap","2":"1.1.0","3":"1.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fastmap","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fastmap","6":"FALSE","7":"FALSE","8":"2021-01-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fastmap"},{"1":"forcats","2":"0.5.1","3":"0.5.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/forcats","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/forcats/0.5.1/81c3244cab67468aac4c60550832655d/forcats","6":"TRUE","7":"FALSE","8":"2021-01-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"forcats"},{"1":"foreach","2":"1.5.2","3":"1.5.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/foreach","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/foreach","6":"TRUE","7":"FALSE","8":"2022-02-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"foreach"},{"1":"fs","2":"1.5.2","3":"1.5.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fs","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/fs","6":"FALSE","7":"FALSE","8":"2021-12-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"fs"},{"1":"furrr","2":"0.3.0","3":"0.3.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/furrr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/furrr/0.3.0/c7cf394610e3aaf086fa4b66c382016e/furrr","6":"FALSE","7":"FALSE","8":"2022-05-04","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"furrr"},{"1":"future","2":"1.27.0","3":"1.27.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/future","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/future/1.27.0/f6811da7bee83f2cef50ee3d21c5c794/future","6":"FALSE","7":"FALSE","8":"2022-07-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"future"},{"1":"future.apply","2":"1.9.0","3":"1.9.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/future.apply","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/future.apply/1.9.0/8ec2bd333ccd4df6bf70e68dded6c364/future.apply","6":"FALSE","7":"FALSE","8":"2022-04-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"future.apply"},{"1":"gargle","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/gargle","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gargle/1.2.0/9d234e6a87a6f8181792de6dc4a00e39/gargle","6":"FALSE","7":"FALSE","8":"2021-07-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gargle"},{"1":"generics","2":"0.1.3","3":"0.1.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/generics","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/generics","6":"FALSE","7":"FALSE","8":"2022-07-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"generics"},{"1":"ggplot2","2":"3.3.6","3":"3.3.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggplot2","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggplot2","6":"TRUE","7":"FALSE","8":"2022-05-03","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ggplot2"},{"1":"ggrepel","2":"0.9.1","3":"0.9.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggrepel","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ggrepel","6":"FALSE","7":"FALSE","8":"2021-01-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ggrepel"},{"1":"globals","2":"0.15.1","3":"0.15.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/globals","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/globals/0.15.1/9449b1dfaf8609db72556cfbe228285d/globals","6":"FALSE","7":"FALSE","8":"2022-06-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"globals"},{"1":"glue","2":"1.6.2","3":"1.6.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/glue","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/glue","6":"FALSE","7":"FALSE","8":"2022-02-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"glue"},{"1":"googledrive","2":"2.0.0","3":"2.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/googledrive","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/googledrive","6":"FALSE","7":"FALSE","8":"2021-07-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"googledrive"},{"1":"googlesheets4","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/googlesheets4","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/googlesheets4/1.0.0/9a6564184dc4a81daea4f1d7ce357c6a/googlesheets4","6":"FALSE","7":"FALSE","8":"2021-07-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"googlesheets4"},{"1":"gower","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/gower","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/gower","6":"FALSE","7":"FALSE","8":"2022-02-03","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"gower"},{"1":"GPfit","2":"1.0.8","3":"1.0-8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/GPfit","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/GPfit","6":"FALSE","7":"FALSE","8":"2019-02-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"GPfit"},{"1":"gridExtra","2":"2.3","3":"2.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/gridExtra","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/gridExtra","6":"FALSE","7":"FALSE","8":"2017-09-09","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"gridExtra"},{"1":"gt","2":"0.6.0","3":"0.6.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/gt","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gt/0.6.0/842059d3f71b14e812500b23eeea765e/gt","6":"TRUE","7":"FALSE","8":"2022-05-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gt"},{"1":"gtable","2":"0.3.0","3":"0.3.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/gtable","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/gtable/0.3.0/ac5c6baf7822ce8732b343f14c072c4d/gtable","6":"FALSE","7":"FALSE","8":"2019-03-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"gtable"},{"1":"hardhat","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/hardhat","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/hardhat","6":"FALSE","7":"FALSE","8":"2022-06-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"hardhat"},{"1":"haven","2":"2.5.0","3":"2.5.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/haven","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/haven/2.5.0/e3058e4ac77f4fa686f68a1838d5b715/haven","6":"FALSE","7":"FALSE","8":"2022-04-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"haven"},{"1":"hms","2":"1.1.1","3":"1.1.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/hms","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/hms/1.1.1/5b8a2dd0fdbe2ab4f6081e6c7be6dfca/hms","6":"FALSE","7":"FALSE","8":"2021-09-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"hms"},{"1":"htmltools","2":"0.5.2","3":"0.5.3","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/htmltools","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmltools","6":"FALSE","7":"FALSE","8":"2021-08-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"htmltools"},{"1":"htmlwidgets","2":"1.5.4","3":"1.5.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmlwidgets","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/htmlwidgets","6":"FALSE","7":"FALSE","8":"2021-09-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"htmlwidgets"},{"1":"httpuv","2":"1.6.5","3":"1.6.5","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/httpuv","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/httpuv/1.6.5/97fe71f0a4a1c9890e6c2128afa04bc0/httpuv","6":"FALSE","7":"FALSE","8":"2022-01-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"httpuv"},{"1":"httr","2":"1.4.3","3":"1.4.3","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/httr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/httr/1.4.3/88d1b310583777edf01ccd1216fb0b2b/httr","6":"FALSE","7":"FALSE","8":"2022-05-04","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"httr"},{"1":"infer","2":"1.0.2","3":"1.0.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/infer","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/infer/1.0.2/ec3a41e963bc24f53ff06f3137742ed7/infer","6":"TRUE","7":"FALSE","8":"2022-06-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"infer"},{"1":"ipred","2":"0.9.13","3":"0.9-13","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ipred","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ipred","6":"FALSE","7":"FALSE","8":"2022-06-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ipred"},{"1":"iterators","2":"1.0.14","3":"1.0.14","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/iterators","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/iterators","6":"TRUE","7":"FALSE","8":"2022-02-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"iterators"},{"1":"jsonlite","2":"1.8.0","3":"1.8.3","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/jsonlite","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/jsonlite","6":"FALSE","7":"FALSE","8":"2022-02-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"jsonlite"},{"1":"kernlab","2":"0.9.31","3":"0.9-31","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/kernlab","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/kernlab","6":"FALSE","7":"FALSE","8":"2022-06-09","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"kernlab"},{"1":"knitr","2":"1.39","3":"1.40","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/knitr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/knitr","6":"FALSE","7":"FALSE","8":"2022-04-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"knitr"},{"1":"labeling","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/labeling","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/labeling","6":"FALSE","7":"FALSE","8":"2020-10-20","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"labeling"},{"1":"later","2":"1.3.0","3":"1.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/later","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/later","6":"FALSE","7":"FALSE","8":"2021-08-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"later"},{"1":"lattice","2":"0.20.45","3":"0.20-45","4":"C:/Program Files/R/R-4.2.1/library/lattice","5":"C:/Program Files/R/R-4.2.1/library/lattice","6":"FALSE","7":"FALSE","8":"2021-09-22","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"lattice"},{"1":"lava","2":"1.6.10","3":"1.6.10","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lava","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lava","6":"FALSE","7":"FALSE","8":"2021-09-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"lava"},{"1":"lhs","2":"1.1.5","3":"1.1.5","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lhs","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lhs","6":"FALSE","7":"FALSE","8":"2022-03-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"lhs"},{"1":"lifecycle","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/lifecycle","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/lifecycle/1.0.1/a6b6d352e3ed897373ab19d8395c98d0/lifecycle","6":"FALSE","7":"FALSE","8":"2021-09-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"lifecycle"},{"1":"listenv","2":"0.8.0","3":"0.8.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/listenv","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/listenv","6":"FALSE","7":"FALSE","8":"2019-12-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"listenv"},{"1":"lubridate","2":"1.8.0","3":"1.8.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lubridate","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/lubridate","6":"FALSE","7":"FALSE","8":"2021-10-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"lubridate"},{"1":"magrittr","2":"2.0.3","3":"2.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/magrittr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/magrittr","6":"FALSE","7":"FALSE","8":"2022-03-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"magrittr"},{"1":"MASS","2":"7.3.57","3":"7.3-57","4":"C:/Program Files/R/R-4.2.1/library/MASS","5":"C:/Program Files/R/R-4.2.1/library/MASS","6":"FALSE","7":"FALSE","8":"2022-04-22","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"MASS"},{"1":"Matrix","2":"1.4.1","3":"1.4-1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/Matrix","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/Matrix/1.4-1/699c47c606293bdfbc9fd78a93c9c8fe/Matrix","6":"FALSE","7":"FALSE","8":"2022-03-23","9":"CRAN (R 4.2.1)","10":"NA","11":"NA","_rn_":"Matrix"},{"1":"memoise","2":"2.0.1","3":"2.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/memoise","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/memoise","6":"FALSE","7":"FALSE","8":"2021-11-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"memoise"},{"1":"mgcv","2":"1.8.40","3":"1.8-40","4":"C:/Program Files/R/R-4.2.1/library/mgcv","5":"C:/Program Files/R/R-4.2.1/library/mgcv","6":"TRUE","7":"FALSE","8":"2022-03-29","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"mgcv"},{"1":"mime","2":"0.12","3":"0.12","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/mime","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/mime","6":"FALSE","7":"FALSE","8":"2021-09-28","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"mime"},{"1":"miniUI","2":"0.1.1.1","3":"0.1.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/miniUI","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/miniUI","6":"FALSE","7":"FALSE","8":"2018-05-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"miniUI"},{"1":"modeldata","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/modeldata","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/modeldata/1.0.0/bd22a86efc049816752f3d9346757a52/modeldata","6":"TRUE","7":"FALSE","8":"2022-07-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"modeldata"},{"1":"modelr","2":"0.1.8","3":"0.1.8","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/modelr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/modelr/0.1.8/9fd59716311ee82cba83dc2826fc5577/modelr","6":"FALSE","7":"FALSE","8":"2020-05-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"modelr"},{"1":"munsell","2":"0.5.0","3":"0.5.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/munsell","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/munsell","6":"FALSE","7":"FALSE","8":"2018-06-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"munsell"},{"1":"nlme","2":"3.1.157","3":"3.1-157","4":"C:/Program Files/R/R-4.2.1/library/nlme","5":"C:/Program Files/R/R-4.2.1/library/nlme","6":"TRUE","7":"FALSE","8":"2022-03-25","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"nlme"},{"1":"nnet","2":"7.3.17","3":"7.3-17","4":"C:/Program Files/R/R-4.2.1/library/nnet","5":"C:/Program Files/R/R-4.2.1/library/nnet","6":"FALSE","7":"FALSE","8":"2022-01-16","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"nnet"},{"1":"parallelly","2":"1.32.1","3":"1.32.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/parallelly","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/parallelly","6":"FALSE","7":"FALSE","8":"2022-07-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"parallelly"},{"1":"parsnip","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/parsnip","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/parsnip/1.0.0/94f8e3edfed8738b7afc7a6f053b31bb/parsnip","6":"TRUE","7":"FALSE","8":"2022-06-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"parsnip"},{"1":"patchwork","2":"1.1.1","3":"1.1.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/patchwork","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/patchwork/1.1.1/c446b30cb33ec125ff02588b60660ccb/patchwork","6":"TRUE","7":"FALSE","8":"2020-12-17","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"patchwork"},{"1":"pillar","2":"1.8.0","3":"1.8.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/pillar","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/pillar/1.8.0/f95cf85794546c4ac2b9a6ca42e671ff/pillar","6":"FALSE","7":"FALSE","8":"2022-07-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"pillar"},{"1":"pkgbuild","2":"1.3.1","3":"1.3.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgbuild","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgbuild","6":"FALSE","7":"FALSE","8":"2021-12-20","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgbuild"},{"1":"pkgconfig","2":"2.0.3","3":"2.0.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgconfig","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgconfig","6":"FALSE","7":"FALSE","8":"2019-09-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgconfig"},{"1":"pkgload","2":"1.3.0","3":"1.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgload","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/pkgload","6":"FALSE","7":"FALSE","8":"2022-06-27","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"pkgload"},{"1":"poissonreg","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/poissonreg","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/poissonreg/1.0.0/c1e0a24fb01e18cd31300acb56489aad/poissonreg","6":"TRUE","7":"FALSE","8":"2022-06-15","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"poissonreg"},{"1":"prettyunits","2":"1.1.1","3":"1.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prettyunits","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prettyunits","6":"FALSE","7":"FALSE","8":"2020-01-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"prettyunits"},{"1":"processx","2":"3.7.0","3":"3.7.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/processx","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/processx","6":"FALSE","7":"FALSE","8":"2022-07-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"processx"},{"1":"prodlim","2":"2019.11.13","3":"2019.11.13","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prodlim","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/prodlim","6":"FALSE","7":"FALSE","8":"2019-11-17","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"prodlim"},{"1":"profvis","2":"0.3.7","3":"0.3.7","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/profvis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/profvis","6":"FALSE","7":"FALSE","8":"2020-11-02","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"profvis"},{"1":"promises","2":"1.2.0.1","3":"1.2.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/promises","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/promises","6":"FALSE","7":"FALSE","8":"2021-02-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"promises"},{"1":"ps","2":"1.7.1","3":"1.7.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ps","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ps","6":"FALSE","7":"FALSE","8":"2022-06-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ps"},{"1":"purrr","2":"0.3.4","3":"0.3.4","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/purrr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/purrr/0.3.4/97def703420c8ab10d8f0e6c72101e02/purrr","6":"TRUE","7":"FALSE","8":"2020-04-17","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"purrr"},{"1":"R6","2":"2.5.1","3":"2.5.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/R6","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/R6","6":"FALSE","7":"FALSE","8":"2021-08-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"R6"},{"1":"ragg","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/ragg","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/ragg/1.2.2/14932bb6f2739c771ca4ceaba6b4248e/ragg","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"ragg"},{"1":"ranger","2":"0.14.1","3":"0.14.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ranger","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/ranger","6":"FALSE","7":"FALSE","8":"2022-06-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"ranger"},{"1":"Rcpp","2":"1.0.9","3":"1.0.9","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rcpp","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rcpp","6":"FALSE","7":"FALSE","8":"2022-07-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"Rcpp"},{"1":"readr","2":"2.1.2","3":"2.1.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/readr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/readr/2.1.2/9c59de1357dc209868b5feb5c9f0fe2f/readr","6":"TRUE","7":"FALSE","8":"2022-01-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"readr"},{"1":"readxl","2":"1.4.0","3":"1.4.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/readxl","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/readxl/1.4.0/170c35f745563bb307e963bde0197e4f/readxl","6":"FALSE","7":"FALSE","8":"2022-03-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"readxl"},{"1":"recipes","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/recipes","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/recipes/1.0.1/6ea4fdbc49ae227bf37eea030da5a995/recipes","6":"TRUE","7":"FALSE","8":"2022-07-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"recipes"},{"1":"remotes","2":"2.4.2","3":"2.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/remotes","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/remotes","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"remotes"},{"1":"renv","2":"0.15.5","3":"0.16.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/renv","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/renv","6":"FALSE","7":"FALSE","8":"2022-05-26","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"renv"},{"1":"reprex","2":"2.0.1","3":"2.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/reprex","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/reprex/2.0.1/911d101becedc0fde495bd910984bdc8/reprex","6":"FALSE","7":"FALSE","8":"2021-08-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"reprex"},{"1":"rlang","2":"1.0.4","3":"1.0.6","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/rlang","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rlang","6":"FALSE","7":"FALSE","8":"2022-07-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rlang"},{"1":"rmarkdown","2":"2.14","3":"2.17","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/rmarkdown","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rmarkdown","6":"FALSE","7":"FALSE","8":"2022-04-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rmarkdown"},{"1":"rpart","2":"4.1.16","3":"4.1.16","4":"C:/Program Files/R/R-4.2.1/library/rpart","5":"C:/Program Files/R/R-4.2.1/library/rpart","6":"FALSE","7":"FALSE","8":"2022-01-24","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"rpart"},{"1":"rpart.plot","2":"3.1.1","3":"3.1.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rpart.plot","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rpart.plot","6":"FALSE","7":"FALSE","8":"2022-05-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rpart.plot"},{"1":"rsample","2":"1.1.0","3":"1.1.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rsample","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rsample","6":"TRUE","7":"FALSE","8":"2022-08-08","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rsample"},{"1":"rstudioapi","2":"0.13","3":"0.14","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/rstudioapi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/rstudioapi","6":"FALSE","7":"FALSE","8":"2020-11-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"rstudioapi"},{"1":"Rttf2pt1","2":"1.3.8","3":"1.3.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rttf2pt1","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/Rttf2pt1","6":"FALSE","7":"FALSE","8":"2020-01-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"Rttf2pt1"},{"1":"rvest","2":"1.0.2","3":"1.0.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/rvest","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/rvest/1.0.2/bb099886deffecd6f9b298b7d4492943/rvest","6":"FALSE","7":"FALSE","8":"2021-10-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"rvest"},{"1":"sass","2":"0.4.2","3":"0.4.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sass","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sass","6":"FALSE","7":"FALSE","8":"2022-07-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"sass"},{"1":"scales","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/scales","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/scales/1.2.0/6e8750cdd13477aa440d453da93d5cac/scales","6":"TRUE","7":"FALSE","8":"2022-04-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"scales"},{"1":"sessioninfo","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sessioninfo","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/sessioninfo","6":"FALSE","7":"FALSE","8":"2021-12-06","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"sessioninfo"},{"1":"shiny","2":"1.7.2","3":"1.7.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/shiny","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/shiny","6":"FALSE","7":"FALSE","8":"2022-07-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"shiny"},{"1":"slider","2":"0.2.2","3":"0.2.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/slider","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/slider","6":"FALSE","7":"FALSE","8":"2021-07-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"slider"},{"1":"stringi","2":"1.7.8","3":"1.7.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringi","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringi","6":"FALSE","7":"FALSE","8":"2022-07-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"stringi"},{"1":"stringr","2":"1.4.0","3":"1.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/stringr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/stringr","6":"TRUE","7":"FALSE","8":"2019-02-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"stringr"},{"1":"survival","2":"3.3.1","3":"3.3-1","4":"C:/Program Files/R/R-4.2.1/library/survival","5":"C:/Program Files/R/R-4.2.1/library/survival","6":"FALSE","7":"FALSE","8":"2022-03-03","9":"CRAN (R 4.2.1)","10":"NA","11":"C:/Program Files/R/R-4.2.1/library","_rn_":"survival"},{"1":"systemfonts","2":"1.0.4","3":"1.0.4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/systemfonts","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/systemfonts","6":"FALSE","7":"FALSE","8":"2022-02-11","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"systemfonts"},{"1":"textshaping","2":"0.3.6","3":"0.3.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/textshaping","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/textshaping","6":"FALSE","7":"FALSE","8":"2021-10-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"textshaping"},{"1":"tibble","2":"3.1.8","3":"3.1.8","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tibble","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tibble","6":"TRUE","7":"FALSE","8":"2022-07-22","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tibble"},{"1":"tictoc","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/tictoc","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tictoc/1.0.1/5acb66b0266ad1f0ebf7ffe1aa36ff4c/tictoc","6":"TRUE","7":"FALSE","8":"2021-04-19","9":"CRAN (R 4.2.0)","10":"TRUE","11":"NA","_rn_":"tictoc"},{"1":"tidymodels","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidymodels","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidymodels","6":"TRUE","7":"FALSE","8":"2022-07-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tidymodels"},{"1":"tidyr","2":"1.2.0","3":"1.2.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/tidyr","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tidyr/1.2.0/d8b95b7fee945d7da6888cf7eb71a49c/tidyr","6":"TRUE","7":"FALSE","8":"2022-02-01","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"tidyr"},{"1":"tidyselect","2":"1.1.2","3":"1.1.2","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/tidyselect","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tidyselect/1.1.2/17f6da8cfd7002760a859915ce7eef8f/tidyselect","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"tidyselect"},{"1":"tidyverse","2":"1.3.2","3":"1.3.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidyverse","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tidyverse","6":"TRUE","7":"FALSE","8":"2022-07-18","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tidyverse"},{"1":"timeDate","2":"4021.104","3":"4021.104","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/timeDate","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/timeDate/4021.104/f20ec0cf362646ccfb53fc23194d8ce9/timeDate","6":"TRUE","7":"FALSE","8":"2022-07-19","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"timeDate"},{"1":"tune","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/tune","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/tune/1.0.0/a521246dbbf19272fc113ff00afac270/tune","6":"TRUE","7":"FALSE","8":"2022-07-07","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"tune"},{"1":"tzdb","2":"0.3.0","3":"0.3.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tzdb","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/tzdb","6":"FALSE","7":"FALSE","8":"2022-03-28","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"tzdb"},{"1":"urlchecker","2":"1.0.1","3":"1.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/urlchecker","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/urlchecker","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"urlchecker"},{"1":"usethis","2":"2.1.6","3":"2.1.6","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/usethis","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/usethis","6":"FALSE","7":"FALSE","8":"2022-05-25","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"usethis"},{"1":"utf8","2":"1.2.2","3":"1.2.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/utf8","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/utf8","6":"FALSE","7":"FALSE","8":"2021-07-24","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"utf8"},{"1":"vctrs","2":"0.4.1","3":"0.4.1","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/vctrs","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/vctrs/0.4.1/8b54f22e2a58c4f275479c92ce041a57/vctrs","6":"FALSE","7":"FALSE","8":"2022-04-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"vctrs"},{"1":"vip","2":"0.3.2","3":"0.3.2","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/vip","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/vip","6":"TRUE","7":"FALSE","8":"2020-12-17","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"vip"},{"1":"viridisLite","2":"0.4.0","3":"0.4.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/viridisLite","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/viridisLite/0.4.0/55e157e2aa88161bdb0754218470d204/viridisLite","6":"FALSE","7":"FALSE","8":"2021-04-13","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"viridisLite"},{"1":"warp","2":"0.2.0","3":"0.2.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/warp","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/warp","6":"FALSE","7":"FALSE","8":"2020-10-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"warp"},{"1":"withr","2":"2.5.0","3":"2.5.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/withr","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/withr","6":"FALSE","7":"FALSE","8":"2022-03-03","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"withr"},{"1":"workflows","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/workflows","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/workflows/1.0.0/6e7dd3c9704c00f607ae19e5f5211531/workflows","6":"TRUE","7":"FALSE","8":"2022-07-05","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"workflows"},{"1":"workflowsets","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/workflowsets","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/workflowsets","6":"TRUE","7":"FALSE","8":"2022-07-12","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"workflowsets"},{"1":"xfun","2":"0.31","3":"0.34","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/xfun","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xfun","6":"FALSE","7":"FALSE","8":"2022-05-10","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xfun"},{"1":"xgboost","2":"1.6.0.1","3":"1.6.0.1","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xgboost","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xgboost","6":"FALSE","7":"FALSE","8":"2022-04-16","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xgboost"},{"1":"xml2","2":"1.3.3","3":"1.3.3","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xml2","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xml2","6":"FALSE","7":"FALSE","8":"2021-11-30","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xml2"},{"1":"xtable","2":"1.8.4","3":"1.8-4","4":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xtable","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/xtable","6":"FALSE","7":"FALSE","8":"2019-04-21","9":"CRAN (R 4.2.1)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"xtable"},{"1":"yaml","2":"2.3.5","3":"2.3.6","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/yaml","5":"C:/Users/tdunn/AppData/Local/R/win-library/4.2/yaml","6":"FALSE","7":"FALSE","8":"2022-02-21","9":"CRAN (R 4.2.0)","10":"TRUE","11":"C:/Users/tdunn/AppData/Local/R/win-library/4.2","_rn_":"yaml"},{"1":"yardstick","2":"1.0.0","3":"1.0.0","4":"C:/Users/tdunn/AppData/Local/Temp/RtmpUjcces/renv-library-3dd41c4956ef/yardstick","5":"C:/Users/tdunn/AppData/Local/renv/cache/v5/R-4.2/x86_64-w64-mingw32/yardstick/1.0.0/c244cb8e43c5e53504b81eb159fbbde6/yardstick","6":"TRUE","7":"FALSE","8":"2022-06-06","9":"CRAN (R 4.2.1)","10":"TRUE","11":"NA","_rn_":"yardstick"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</details>
<details>
<summary>
Git repository
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Local:    main C:/Users/tdunn/Documents/tdunn-quarto
Remote:   main @ origin (https://github.com/taylordunn/tdunn-quarto.git)
Head:     [4eb5bf2] 2022-10-26: Added font import to style sheet</code></pre>
</div>
</div>
</details>
<p><a href="https://github.com/taylordunn/tdunn-quarto/tree/main/posts/2022-04-29-predicting-bike-ridership-developing-a-model">Source code</a>, <a href="https://github.com/taylordunn/tdunn-quarto/tree/main/posts/2022-04-29-predicting-bike-ridership-developing-a-model/renv.lock">R environment</a></p>



</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Hyndman2006" class="csl-entry" role="doc-biblioentry">
Hyndman, Rob J, and Anne B Koehler. 2006. <span>“Another Look at Measures of Forecast Accuracy.”</span> <em>International Journal of Forecasting</em> 22 (4): 679–88.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Since <code>initial_time_split()</code> doesn’t take <code>strata</code> argument, this would require defining a custom split function with <code>rsample::make_splits()</code>. This functionality might be available in future versions of <code>rsample</code> (see <a href="https://github.com/tidymodels/rsample/issues/207">this issue</a>).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Check out <a href="https://fromthebottomoftheheap.net/2014/05/09/modelling-seasonal-data-with-gam/">this blog post by Gavin Simpson</a> for a great walkthrough of modeling seasonal data with GAMs.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Using the <code>select_best = TRUE</code> argument means only the best model in each workflow is returned. In this case, that means the workflows with the tunable spline feature of <code>count_date_doy</code> will only have one entry.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>You could make the argument that the improvement is so minor that it is worth choosing the simpler linear regression model instead.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>This is my reminder to myself to come back in fall 2022 to see how the model performs on a full summer season.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{dunn2022,
  author = {Taylor Dunn},
  title = {Predicting Bike Ridership: Developing a Model},
  date = {2022-04-29},
  url = {https://tdunn.ca/posts/2022-04-29-predicting-bike-ridership-developing-a-model},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-dunn2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Taylor Dunn. 2022. <span>“Predicting Bike Ridership: Developing a
Model.”</span> April 29, 2022. <a href="https://tdunn.ca/posts/2022-04-29-predicting-bike-ridership-developing-a-model">https://tdunn.ca/posts/2022-04-29-predicting-bike-ridership-developing-a-model</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>